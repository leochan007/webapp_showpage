(this["webpackJsonp@loopring-web/webapp"]=this["webpackJsonp@loopring-web/webapp"]||[]).push([[0],{1582:function(e,t,a){"use strict";a.r(t);var n=a(51),c=a(143),r=a.n(c),o=a(2),i=a(13),s=a(124),u=a(92),l=a(25),d=a(5),b=a(1609),p=a(3),m=a.n(p),f=a(9),v=a(12),j=a(1),O=a.n(j),h=a(72),k={accAddress:"",readyState:d.a.UN_CONNECT,accountId:-1,apiKey:"",eddsaKey:"",publicKey:{},level:"",nonce:void 0,keyNonce:void 0,connectName:d.l.unknown,_chainId:1,status:"PENDING",errorMessage:null},x=Object(h.c)({name:"account",initialState:k,reducers:{updateAccountStatus:function(e,t){e.status=d.L.PENDING},changeShowModel:function(e,t){var a=t.payload._userOnModel;e._userOnModel=a},nextAccountStatus:function(e,t){if(t.error)e.status=d.L.ERROR,e.errorMessage=t.error;else{var a=t.payload,n=a.accAddress,c=a.readyState,r=a.accountId,o=a.wrongChain,i=a.level,s=a.apiKey,u=a.eddsaKey,l=a._chainId,b=a.nonce,p=a.connectName;void 0!==n&&(e.accAddress=n),void 0!==o&&(e.wrongChain=o),c&&(e.readyState=c),void 0!==r&&(e.accountId=r),void 0!==i&&(e.level=i),void 0!==s&&(e.apiKey=s),void 0!==u&&(e.eddsaKey=u),void 0!==p&&(e.connectName=p),void 0!==l&&(e._chainId=l),void 0!==b&&(e.nonce=b),e.status=d.L.DONE}},cleanAccountStatus:function(e,t){e.status=d.L.PENDING},statusUnset:function(e){e.status=d.L.UNSET}}}),g=x,w=x.actions,A=w.updateAccountStatus,y=w.changeShowModel,S=w.cleanAccountStatus,I=w.nextAccountStatus,N=w.statusUnset,C=["status","errorMessage"];function T(){var e=Object(n.c)((function(e){return e.account})),t=e.status,a=e.errorMessage,c=Object(l.a)(e,C),r=Object(n.b)(),o=O.a.useCallback((function(e){r(S(e))}),[r]),i=O.a.useCallback((function(e){r(A(e))}),[r]),s=O.a.useMemo((function(){return c._userOnModel}),[c]),u=O.a.useCallback((function(e){r(y({_userOnModel:e}))}),[r]);return{account:c,resetAccount:o,shouldShow:s,setShouldShow:u,updateAccount:i,statusUnset:O.a.useCallback((function(){r(N(void 0))}),[r]),status:t,errorMessage:a}}var M=a(11),E=a(30),P=a(137),D=a(477),_=a(860),R=a.n(_),L=a(590),U=a.n(L),B=a(861),F=a(444),K=a(862),W=Object(h.b)("global/updateVersion"),H={ammMap:void 0,__timer__:-1,status:"PENDING",errorMessage:null},V=Object(h.c)({name:"ammMap",initialState:H,reducers:{getAmmMap:function(e,t){e.status=d.L.PENDING},getAmmMapStatus:function(e,t){t.error&&(e.status=d.L.ERROR,e.errorMessage=t.error);var a=t.payload,n=a.ammMap,c=a.__timer__;n&&(e.ammMap=n),c&&(e.__timer__=c),e.status=d.L.DONE},updateRealTimeAmmMap:function(e,t){e.status=d.L.PENDING},statusUnset:function(e){e.status=d.L.UNSET}}}),J=V.actions,G=J.getAmmMap,Y=J.getAmmMapStatus,z=J.statusUnset,q=J.updateRealTimeAmmMap,Q=function(){var e=Object(n.c)((function(e){return e.amm.ammMap})),t=Object(n.b)();return Object(o.a)(Object(o.a)({},e),{},{statusUnset:O.a.useCallback((function(){return t(z(void 0))}),[t]),getAmmMap:O.a.useCallback((function(){return t(G(void 0))}),[t])})},X=Object(h.c)({name:"ammActivityMap",initialState:{ammActivityMap:{},status:"PENDING",errorMessage:null},reducers:{getAmmActivityMap:function(e,t){e.status=d.L.PENDING},getAmmActivityMapStatus:function(e,t){t.error&&(e.status=d.L.ERROR,e.errorMessage=t.error),e.ammActivityMap=Object(o.a)({},t.payload.ammActivityMap),e.status=d.L.DONE},statusUnset:function(e){e.status=d.L.UNSET}}}),Z=X.actions,$=Z.getAmmActivityMap,ee=Z.getAmmActivityMapStatus,te=Z.statusUnset;function ae(){var e=Object(n.c)((function(e){return e.amm.ammActivityMap})),t=Object(n.b)();return Object(o.a)(Object(o.a)({},e),{},{statusUnset:O.a.useCallback((function(){return t(te(void 0))}),[t]),getAmmActivityMap:O.a.useCallback((function(){return t($(void 0))}),[t])})}var ne=a(36),ce=a(14),re=a(19);var oe=function e(){Object(ce.a)(this,e)};oe.userAPI=void 0,oe.exchangeAPI=void 0,oe.ammpoolAPI=void 0,oe.walletAPI=void 0,oe.wsAPI=void 0,oe.InitApi=function(e){oe.userAPI=new re.k({chainId:e}),oe.exchangeAPI=new re.f({chainId:e}),oe.ammpoolAPI=new re.c({chainId:e}),oe.walletAPI=new re.m({chainId:e}),oe.wsAPI=new re.n({chainId:e})};var ie=m.a.mark(le),se=m.a.mark(de),ue=function(){var e=Object(f.a)(m.a.mark((function e(){var t,a;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!oe.ammpoolAPI){e.next=8;break}return e.next=3,oe.ammpoolAPI.getAmmPoolActivityRules();case 3:return t=e.sent,a=t.groupByRuleTypeAndStatus,e.abrupt("return",{data:a});case 8:return e.abrupt("return",{data:void 0});case 9:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();function le(){var e,t;return m.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,Object(ne.b)(ue);case 3:return e=a.sent,t=e.data,a.next=7,Object(ne.d)(ee({ammActivityMap:t}));case 7:a.next=13;break;case 9:return a.prev=9,a.t0=a.catch(0),a.next=13,Object(ne.d)(ee(a.t0));case 13:case"end":return a.stop()}}),ie,null,[[0,9]])}function de(){return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(ne.a)([Object(ne.f)($,le)]);case 2:case"end":return e.stop()}}),se)}var be=a(7),pe=m.a.mark(he),me=m.a.mark(ke),fe=m.a.mark(xe),ve=m.a.mark(ge),je=function(e){var t=e.ammPoolState,a=e.keyPair,n=Cn.getState().tokenMap.idIndex,c=a.match(/(\w+)-(\w+)/i),r=Object(be.a)(c,3),i=r[1],s=r[2],u=Cn.getState().system,l=u.forex,d=u.faitPrices;if(n&&i&&s&&d&&l){var b={amountDollar:parseFloat(t.liquidityUSD),amountYuan:parseFloat(t.liquidityUSD)/(l||6.5),totalLPToken:Tn("LP-"+a,t.lpLiquidity),totalA:Tn(i,t.liquidity[0]),totalB:Tn(s,t.liquidity[1]),rewardValue:t.rewards[0]?Tn(n[t.rewards[0].tokenId],t.rewards[0].volume):void 0,rewardToken:t.rewards[0]?n[t.rewards[0].tokenId]:void 0,rewardValue2:t.rewards[1]?Tn(n[t.rewards[1].tokenId],t.rewards[1].volume):void 0,rewardToken2:t.rewards[1]?n[t.rewards[1].tokenId]:void 0},p=Mn(i,t.fees[0]),m=Mn(s,t.fees[1]),f=d[i]&&d[s]?Object(re.J)(p||0).times(d[i].price).plus(Object(re.J)(m||0).times(d[s].price)):void 0,v=f?f.times(l):void 0;return Object(o.a)(Object(o.a)({},b),{},{feeA:null===p||void 0===p?void 0:p.toNumber(),feeB:null===m||void 0===m?void 0:m.toNumber(),feeDollar:f?f.toNumber():void 0,feeYuan:v?v.toNumber():void 0,tradeFloat:{change:void 0,timeUnit:"24h"},APY:1*parseInt(t.apyBips)/100})}},Oe=function(){var e=Object(f.a)(m.a.mark((function e(t){var a,n,c,r,i,s,u,l,d;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.ammpools,oe.ammpoolAPI){e.next=3;break}return e.abrupt("return",void 0);case 3:return c={},e.next=6,null===(a=oe.ammpoolAPI)||void 0===a?void 0:a.getAmmPoolStats();case 6:return r=e.sent,i=r.ammPoolStats,(s=Cn.getState().amm.ammMap.__timer__)&&-1!==s&&clearInterval(s),s=setInterval(Object(f.a)(m.a.mark((function e(){var t;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(oe.ammpoolAPI){e.next=2;break}return e.abrupt("return",void 0);case 2:return e.next=4,oe.ammpoolAPI.getAmmPoolStats();case 4:t=e.sent.ammPoolStats,Cn.dispatch(q({ammPoolStats:t}));case 6:case"end":return e.stop()}}),e)}))),9e5),u=Cn.getState(),l=u.tokenMap,l.coinMap,d=l.idIndex,Reflect.ownKeys(n).forEach(function(){var e=Object(f.a)(m.a.mark((function e(t){var a,r,s,u;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(a=n[t]).market===t&&a.tokens.pooled&&d&&(r=d[a.tokens.pooled[0]],s=d[a.tokens.pooled[1]],u=Object(o.a)(Object(o.a)({coinA:r,coinB:s,isNew:!(Date.now()-Number(a.createdAt)>2592e5),isActivity:7===a.status,address:a.address},je({ammPoolState:i[t],keyPair:"".concat(r,"-").concat(s)})),{},{__rawConfig__:a}),c[a.market]=u);case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),e.abrupt("return",{ammMap:c,__timer__:s});case 13:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();function he(e){var t,a,n,c,r;return m.a.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return t=e.payload,o.prev=1,a=t.ammpools,o.next=5,Object(ne.b)(Oe,{ammpools:a});case 5:return n=o.sent,c=n.ammMap,r=n.__timer__,o.next=10,Object(ne.d)(Y({ammMap:c,__timer__:r}));case 10:o.next=16;break;case 12:return o.prev=12,o.t0=o.catch(1),o.next=16,Object(ne.d)(Y(o.t0));case 16:case"end":return o.stop()}}),pe,null,[[1,12]])}function ke(e){var t,a,n;return m.a.wrap((function(c){for(;;)switch(c.prev=c.next){case 0:return t=e.payload,c.prev=1,a=t.ammPoolStats,n=Cn.getState().amm.ammMap.ammMap,a&&Reflect.ownKeys(a).map((function(e){var t=e.replace("AMM-","");return n[e]=Object(o.a)(Object(o.a)({},n[e]),je({ammPoolState:a[e],keyPair:t})),n})),c.next=7,Object(ne.d)(Y({ammMap:n}));case 7:c.next=13;break;case 9:return c.prev=9,c.t0=c.catch(1),c.next=13,Object(ne.d)(Y(c.t0));case 13:case"end":return c.stop()}}),me,null,[[1,9]])}function xe(){return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(ne.a)([Object(ne.f)(G,he)]);case 2:case"end":return e.stop()}}),fe)}function ge(){return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(ne.a)([Object(ne.f)(q,ke)]);case 2:case"end":return e.stop()}}),ve)}var we=[Object(ne.c)(xe),Object(ne.c)(ge)],Ae=Object(P.b)({ammMap:V.reducer,ammActivityMap:X.reducer}),ye=[Object(ne.c)(de)].concat(Object(E.a)(we)),Se={coinMap:{},totalCoinMap:{},addressIndex:void 0,tokenMap:void 0,marketMap:void 0,idIndex:void 0,status:"PENDING",errorMessage:null},Ie=Object(h.c)({name:"tokenMap",initialState:Se,reducers:{getTokenMap:function(e,t){e.status=d.L.PENDING},getTokenMapStatus:function(e,t){t.error&&(e.status=d.L.ERROR,e.errorMessage=t.error);var a=t.payload,n=a.tokenMap,c=a.totalCoinMap,r=a.marketMap,o=a.addressIndex,i=a.idIndex,s=a.coinMap,u=a.marketArray,l=a.marketCoins;n&&(e.tokenMap=n),r&&(e.marketMap=r),o&&(e.addressIndex=o),i&&(e.idIndex=i),s&&(e.coinMap=s),c&&(e.totalCoinMap=c),u&&(e.marketArray=u),l&&(e.marketCoins=l),e.status=d.L.DONE},statusUnset:function(e){e.status=d.L.UNSET}}}),Ne=Ie.actions,Ce=Ne.getTokenMap,Te=Ne.getTokenMapStatus,Me=Ne.statusUnset;function Ee(){var e=Object(n.c)((function(e){return e.tokenMap})),t=Object(n.b)();return Object(o.a)(Object(o.a)({},e),{},{statusUnset:O.a.useCallback((function(){return t(Me(void 0))}),[t]),getTokenMap:O.a.useCallback((function(e){return t(Ce(e))}),[t])})}var Pe=a(1723);function De(e){if(e){var t=Pe.a.getAddress(e.address);return"https://exchange.loopring.io/assets/images/ethereum/assets/".concat(t,"/logo.png")}return""}var _e=m.a.mark(Ue),Re=m.a.mark(Be),Le=function(){var e=Object(f.a)(m.a.mark((function e(t){var a,n,c,r,i,s,u,l,d;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.tokensMap,n=t.pairs,c=t.marketArr,r=t.tokenArr,i={},s={},u=a,l={},d={},Reflect.ownKeys(a).forEach((function(e){var t,c,r={icon:(t=e,c=a,De(c[t])),name:e,simpleName:e,description:"",company:""};e.startsWith("LP-")||(i[e]=r),s[e]=r,n[e]&&n[e].tokenList&&(a[e].tradePairs=n[e].tokenList),l=Object(o.a)(Object(o.a)({},l),{},Object(v.a)({},a[e].address,e)),d=Object(o.a)(Object(o.a)({},d),{},Object(v.a)({},a[e].tokenId,e))})),e.abrupt("return",{data:{coinMap:i,totalCoinMap:s,addressIndex:l,idIndex:d,tokenMap:u,marketArray:c,marketCoins:r}});case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();function Ue(e){var t,a,n,c,r,i,s,u;return m.a.wrap((function(l){for(;;)switch(l.prev=l.next){case 0:return t=e.payload,l.prev=1,a=t.tokensMap,n=t.marketMap,c=t.pairs,r=t.marketArr,i=t.tokenArr,l.next=5,Object(ne.b)(Le,{tokensMap:a,pairs:c,marketArr:r,tokenArr:i});case 5:return s=l.sent,u=s.data,l.next=9,Object(ne.d)(Te(Object(o.a)(Object(o.a)({},u),{},{marketMap:n})));case 9:l.next=15;break;case 11:return l.prev=11,l.t0=l.catch(1),l.next=15,Object(ne.d)(Te(l.t0));case 15:case"end":return l.stop()}}),_e,null,[[1,11]])}function Be(){return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(ne.a)([Object(ne.f)(Ce,Ue)]);case 2:case"end":return e.stop()}}),Re)}var Fe=[Object(ne.c)(Be)],Ke=Object(h.c)({name:"tickerMap",initialState:{tickerMap:{},status:"PENDING",errorMessage:null},reducers:{getTicker:function(e,t){e.status=d.L.PENDING},getTickers:function(e,t){e.status=d.L.PENDING},getTickerStatus:function(e,t){t.error&&(e.status=d.L.ERROR,e.errorMessage=t.error),e.tickerMap=t.payload.tickerMap,e.status=d.L.DONE},statusUnset:function(e){e.status=d.L.UNSET}}}),We=Ke.actions,He=We.getTicker,Ve=We.getTickers,Je=We.getTickerStatus,Ge=We.statusUnset,Ye=m.a.mark(Xe),ze=m.a.mark(Ze),qe=m.a.mark($e),Qe=function(){var e=Object(f.a)(m.a.mark((function e(t){var a,n;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(oe.exchangeAPI){e.next=2;break}return e.abrupt("return",void 0);case 2:return e.next=4,oe.exchangeAPI.getMixTicker({market:t.join(",")});case 4:return a=e.sent,n=nc({tickerMap:a.tickMap}),e.abrupt("return",{data:n});case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();function Xe(e){var t,a,n,c,r;return m.a.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:if(t=e.payload,o.prev=1,a=t.tickerKey,n=t.tickerKeys,!(a||n&&n.length)){o.next=12;break}return o.next=6,Object(ne.b)(Qe,a?[a]:n);case 6:return c=o.sent,r=c.data,o.next=10,Object(ne.d)(Je({tickerMap:r}));case 10:o.next=13;break;case 12:throw new d.o(d.u.NO_TOKEN_KEY_LIST);case 13:o.next=19;break;case 15:return o.prev=15,o.t0=o.catch(1),o.next=19,Object(ne.d)(Je(o.t0));case 19:case"end":return o.stop()}}),Ye,null,[[1,15]])}function Ze(){return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(ne.a)([Object(ne.f)(He,Xe)]);case 2:case"end":return e.stop()}}),ze)}function $e(){return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(ne.a)([Object(ne.f)(Ve,Xe)]);case 2:case"end":return e.stop()}}),qe)}var et,tt,at=[Object(ne.c)(Ze),Object(ne.c)($e)];!function(e){e.DEV="DEV",e.UAT="UAT",e.PROD="PROD"}(et||(et={})),function(e){e.NONETWORK="unknown"}(tt||(tt={}));var nt={env:et.PROD,chainId:"unknown",baseURL:"",socketURL:"",etherscanUrl:"",faitPrices:void 0,gasPrice:void 0,forex:void 0,__timer__:-1,status:"PENDING",errorMessage:null,exchangeInfo:void 0,topics:[]},ct=Object(h.c)({name:"system",initialState:nt,reducers:{updateSystem:function(e,t){e.chainId=t.payload.chainId,e.status=d.L.PENDING},updateRealTimeObj:function(e,t){var a=t.payload,n=a.forex,c=a.faitPrices,r=a.gasPrice;n&&(e.forex=n),c&&(e.faitPrices=c),r&&(e.gasPrice=r)},getSystemStatus:function(e,t){t.error&&(e.status=d.L.ERROR,e.errorMessage=t.error);var a=t.payload,n=a.env,c=a.baseURL,r=a.socketURL,o=a.faitPrices,i=a.gasPrice,s=a.forex,u=a.exchangeInfo,l=a.__timer__,b=a.etherscanUrl;n&&(e.env=n),r&&(e.socketURL=r),c&&(e.baseURL=c),o&&(e.faitPrices=o),i&&(e.gasPrice=i),s&&(e.forex=s),u&&(e.exchangeInfo=u),b&&(e.etherscanUrl=b),l&&(e.__timer__=l),e.status=d.L.DONE},statusUnset:function(e){e.status=d.L.UNSET}}}),rt=ct.actions,ot=rt.updateSystem,it=(rt.setTopics,rt.getSystemStatus),st=(rt.statusUnset,rt.updateRealTimeObj),ut={walletLayer1:void 0,status:"DONE",errorMessage:null},lt=Object(h.c)({name:"walletLayer1",initialState:ut,reducers:{updateWalletLayer1:function(e,t){e.status=d.L.PENDING},reset:function(e,t){e.walletLayer1=void 0,e.status=d.L.UNSET},getWalletLayer1Status:function(e,t){t.error&&(e.status=d.L.ERROR,e.errorMessage=t.error),e.walletLayer1=Object(o.a)({},t.payload.walletLayer1),e.status=d.L.DONE},statusUnset:function(e){e.status=d.L.UNSET}}}),dt=lt.actions,bt=dt.updateWalletLayer1,pt=dt.getWalletLayer1Status,mt=dt.statusUnset,ft=dt.reset;function vt(){var e=Object(n.c)((function(e){return e.walletLayer1})),t=Object(n.b)();return Object(o.a)(Object(o.a)({},e),{},{resetLayer1:O.a.useCallback((function(){t(ft(void 0))}),[t]),statusUnset:O.a.useCallback((function(){return t(mt(void 0))}),[t]),updateWalletLayer1:O.a.useCallback((function(){return t(bt(void 0))}),[t])})}var jt,Ot,ht=a(1700),kt=a(15),xt=a(1747),gt=new xt.a,wt=function(e){var t=nc({tickerMap:e});gt.next({tickerMap:t})},At=function(){return gt.asObservable()},yt=new xt.a,St=function(e){return yt.next({ammPoolMap:e})};!function(e){e.pingpong="pingpong",e.account="account",e.order="order",e.orderbook="orderbook",e.trade="trade",e.ticker="ticker",e.candlestick="candlestick",e.ammpool="ammpool"}(Ot||(Ot={}));var It=function(){function e(t){var a=this;Object(ce.a)(this,e),this._socketCallbackMap=void 0,this._loopringSocket=void 0,this.__wsTimer__={timer:-1,count:0},this._baseUrl=void 0,this.socketSendMessage=function(){var e=Object(f.a)(m.a.mark((function e(t){var n,c,r,o,i;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.socket,c=t.apiKey,e.prev=1,!n||!Reflect.ownKeys(n).length){e.next=15;break}if(a.clearInitTimer(!0),a.resetSocketEvents(),r=a.makeMessageArray({socket:n}),o=r.topics,a.isConnectSocket()){e.next=11;break}return e.next=9,a.socketConnect({topics:o,apiKey:c});case 9:e.next=12;break;case 11:null===(i=a._loopringSocket)||void 0===i||i.send(a.makeTopics(o));case 12:return e.abrupt("return",!0);case 15:return a.isConnectSocket()||a.socketClose(),e.abrupt("return",!1);case 17:e.next=22;break;case 19:throw e.prev=19,e.t0=e.catch(1),new d.o(d.u.SOCKET_ERROR);case 22:case"end":return e.stop()}}),e,null,[[1,19]])})));return function(t){return e.apply(this,arguments)}}(),this.socketClose=Object(f.a)(m.a.mark((function e(){var t;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=a._loopringSocket,e.abrupt("return",new Promise((function(e){t?(t.onclose=function(t){e("Socket is closed, ".concat(t.reason))},t.close()):Promise.resolve("no websocket")})));case 2:case"end":return e.stop()}}),e)}))),this.removeSocketEvents=function(e){a._socketCallbackMap&&a._socketCallbackMap[e]&&delete a._socketCallbackMap[e]},this.makeMessageArray=function(e){var t=e.socket,n=[],c=[];return Reflect.ownKeys(t).forEach((function(e){switch(e){case Ot.ticker:(c=t[Ot.ticker].map((function(e){return Object(re.E)(e)})))&&c.length&&(a.addSocketEvents(Ot.ticker),n=[].concat(Object(E.a)(n),Object(E.a)(c)));break;case Ot.account:t[Ot.account]&&(c=[Object(re.v)()]),c&&c.length&&(a.addSocketEvents(Ot.account),n=[].concat(Object(E.a)(n),Object(E.a)(c)));break;case Ot.order:(c=t[Ot.order].map((function(e){return Object(re.B)(e)})))&&c.length&&(a.addSocketEvents(Ot.order),n=[].concat(Object(E.a)(n),Object(E.a)(c)));break;case Ot.orderbook:(c=t[Ot.orderbook].map((function(e){return Object(re.C)(e,0)})))&&c.length&&(a.addSocketEvents(Ot.orderbook),n=[].concat(Object(E.a)(n),Object(E.a)(c)));break;case Ot.trade:(c=t[Ot.trade].map((function(e){return Object(re.F)(e)})))&&c.length&&(a.addSocketEvents(Ot.trade),n=[].concat(Object(E.a)(n),Object(E.a)(c)));break;case Ot.candlestick:(c=t[Ot.candlestick].map((function(e){return Object(re.y)(e)})))&&c.length&&(a.addSocketEvents(Ot.candlestick),n=[].concat(Object(E.a)(n),Object(E.a)(c)));break;case Ot.ammpool:(c=t[Ot.ammpool].map((function(e){return Object(re.w)(e)})))&&c.length&&(a.addSocketEvents(Ot.ammpool),n=[].concat(Object(E.a)(n),Object(E.a)(c)))}})),{topics:n}},this.isConnectSocket=function(){return!(!a._loopringSocket||!a._loopringSocket.send)},this.makeTopics=function(e,t){var a={op:"sub",unsubscribeAll:"true",topics:e};return t&&(a.apiKey=t),JSON.stringify(a)},this.addSocketEvents=function(t,n){a._socketCallbackMap=Object(o.a)(Object(o.a)({},a._socketCallbackMap),{},Object(v.a)({},t,{fn:e.SocketEventMap[t],deps:n||[]}))},this.socketConnect=function(){var e=Object(f.a)(m.a.mark((function e(t){var n,c,r,o,i;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.topics,c=t.apiKey,e.prev=1,r=a,!oe.wsAPI||!n){e.next=13;break}return e.next=6,oe.wsAPI.getWsKey();case 6:o=e.sent,i=o.wsKey,a._loopringSocket=new WebSocket("".concat(a._baseUrl,"?wsApiKey=").concat(i)),a._loopringSocket.onopen=function(){console.warn("Socket>>Socket","WebSocket is open now."),r._loopringSocket&&r._loopringSocket.readyState===WebSocket.OPEN&&r._loopringSocket.send(r.makeTopics(n))},a._loopringSocket.onmessage=function(e){var t=e.data;if("ping"===t&&r._socketCallbackMap){var a,n,c;null===(a=r._socketCallbackMap)||void 0===a||null===(n=a.pingpong)||void 0===n||(c=n.fn).call.apply(c,[r,t].concat(Object(E.a)(r._socketCallbackMap.pingpong.deps)))}else{var o=JSON.parse(t),i=(o.topics,o.topic);if(i&&i.topic&&r._socketCallbackMap){var s,u,l=o.topic.topic,d=o.data;null===(s=r._socketCallbackMap[l.topic])||void 0===s||(u=s.fn).call.apply(u,[r,d].concat(Object(E.a)(r._socketCallbackMap[l.topic].deps)))}}return!1},a._loopringSocket.onclose=function(){var e=Object(f.a)(m.a.mark((function e(t){return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r._loopringSocket&&(r._loopringSocket=void 0),console.log("Socket>>Socket","Socket is closed. Reconnect will be attempted in 1 second.",t.reason),r.clearInitTimer(),r.__wsTimer__.count<5&&(r.__wsTimer__.timer=setTimeout((function(){r.socketConnect.call(r,{topics:n,apiKey:c})}),1e3*r.__wsTimer__.count));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),a._loopringSocket.onerror=function(e){console.error("Socket>>Socket","Socket encountered error:","Closing socket",e)};case 13:e.next=19;break;case 15:e.prev=15,e.t0=e.catch(1),console.error("Socket>>Socket","connect error, not from reconnect"),a._loopringSocket&&a._loopringSocket.close();case 19:case"end":return e.stop()}}),e,null,[[1,15]])})));return function(t){return e.apply(this,arguments)}}(),this.clearInitTimer=function(e){a.__wsTimer__&&(-1!==a.__wsTimer__.timer&&clearTimeout(a.__wsTimer__.timer),a.__wsTimer__.timer=-1,a.__wsTimer__.count++),e&&(a.__wsTimer__={timer:-1,count:0})},this.resetSocketEvents=function(){a._socketCallbackMap=void 0,a.addSocketEvents(Ot.pingpong,[a])},this._baseUrl=t}return Object(kt.a)(e,[{key:"loopringSocket",get:function(){return this._loopringSocket}},{key:"socketCallbackMap",get:function(){return this._socketCallbackMap}}]),e}();It.SocketEventMap=(jt={},Object(v.a)(jt,Ot.account,(function(e){})),Object(v.a)(jt,Ot.order,(function(e){})),Object(v.a)(jt,Ot.orderbook,(function(e){})),Object(v.a)(jt,Ot.trade,(function(e){})),Object(v.a)(jt,Ot.ticker,(function(e){var t=Object(be.a)(e,11),a=t[0],n=t[1],c=t[2],r=t[3],o=t[4],i=t[5],s=t[6],u=t[7],l=t[8],d=t[9],b=t[10],p=a.match(/(\w+)-(\w+)/i),m=Object(be.a)(p,3),f=m[1],j=m[2],O=c,h=r,k=void 0===o||0===Number(o)?void 0:Object(re.J)(u).minus(o).div(o);wt(Object(v.a)({},a,{symbol:a,base:f,quote:j,base_token_volume:O,quote_token_volume:h,timestamp:Number(n),change:k,base_fee_amt:void 0,quote_fee_amt:void 0,open:o,high:i,low:s,close:u,count:l,bid:d,ask:b}))})),Object(v.a)(jt,Ot.candlestick,(function(e){})),Object(v.a)(jt,Ot.candlestick,(function(e){})),Object(v.a)(jt,Ot.ammpool,(function(e){var t=Object(be.a)(e,5),a=t[0],n=t[1],c=t[2],r=Object(be.a)(t[3],2),o=r[0],i=r[1],s=t[4];St({poolName:a,poolAddress:n,pooled:c,lp:{tokenId:o,volume:i},risky:s})})),Object(v.a)(jt,Ot.pingpong,(function(e,t){"ping"===e&&t.loopringSocket.send("pong")})),jt);var Nt=m.a.mark(Et),Ct=m.a.mark(Pt),Tt=m.a.mark((function e(t){var a,n,c,r,o,i,s,u,l,d,b,p;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(ne.b)(Object(f.a)(m.a.mark((function e(){var t;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,null===(t=oe.exchangeAPI)||void 0===t?void 0:t.getTokens();case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)}))));case 2:return a=e.sent,n=a.tokenSymbolMap,e.next=6,Object(ne.b)(Object(f.a)(m.a.mark((function e(){var t;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,null===(t=oe.ammpoolAPI)||void 0===t?void 0:t.getAmmPoolConf();case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)}))));case 6:return c=e.sent,r=c.ammpools,e.next=10,Object(ne.b)(Object(f.a)(m.a.mark((function e(){var t;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",null===(t=oe.exchangeAPI)||void 0===t?void 0:t.getMixMarkets());case 1:case"end":return e.stop()}}),e)}))));case 10:return o=e.sent,i=o.pairs,s=o.marketArr,u=o.tokenArr,l=o.markets,Cn.dispatch(Ce({tokensMap:n,marketMap:l,pairs:i,marketArr:s,tokenArr:u})),e.next=18,Object(ne.e)("tokenMap/getTokenMapStatus");case 18:return Cn.dispatch(G({ammpools:r})),Cn.dispatch($({ammpools:r})),Cn.getState().tokenMap.status,e.next=23,Object(ht.a)(10);case 23:d=Cn.getState(),b=d.account,p=d.walletLayer1,b.accAddress&&void 0===p.walletLayer1&&Cn.dispatch(bt(void 0)),Cn.dispatch(N(void 0));case 26:case"end":return e.stop()}}),e)})),Mt=function(){var e=Object(f.a)(m.a.mark((function e(t){var a,n,c,r,o,i,s,u,l,b,p;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a="localhost"===window.location.hostname?et.DEV:re.e.GOERLI===t?et.UAT:et.PROD,(t=re.e.GOERLI===t?re.e.GOERLI:re.e.MAINNET===t?re.e.MAINNET:tt.NONETWORK)!==tt.NONETWORK){e.next=6;break}throw new d.o(d.u.NO_NETWORK_ERROR);case 6:if(oe.InitApi(t),!oe.exchangeAPI){e.next=30;break}return e.next=10,oe.exchangeAPI.getExchangeInfo();case 10:return n=e.sent,c=n.exchangeInfo,e.next=14,oe.exchangeAPI.getFiatPrice({legal:"USD"});case 14:return r=e.sent.fiatPrices,e.next=17,oe.exchangeAPI.getFiatPrice({legal:"CNY"});case 17:return o=e.sent.fiatPrices,e.next=20,oe.exchangeAPI.getGasPrice();case 20:return e.t0=e.sent.gasPrice,i=e.t0/1e9,s=re.e.MAINNET===t?"https://".concat("api.loopring.network"):"https:/".concat("uat2.loopring.io"),u=re.e.MAINNET===t?"wss://ws.".concat("api.loopring.network","/v3/ws"):"wss://ws.".concat("uat2.loopring.io","/v3/ws"),l=re.e.MAINNET===t?"https://etherscan.io/address/":"https://goerli.etherscan.io/address/",window.loopringSocket=new It(u),b=o.USDT.price,p=function(e){return e&&-1!==e&&clearInterval(e),setInterval(Object(f.a)(m.a.mark((function e(){var t,a,n,c;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!oe.exchangeAPI){e.next=11;break}return e.next=3,oe.exchangeAPI.getFiatPrice({legal:"CNY"});case 3:return a=e.sent.fiatPrices,e.next=6,oe.exchangeAPI.getGasPrice();case 6:e.t0=e.sent.gasPrice,n=e.t0/1e9,c=null===(t=a.USDT)||void 0===t?void 0:t.price,Cn.dispatch(q(void 0)),Cn.dispatch(st({faitPrices:a,gasPrice:n,forex:c}));case 11:case"end":return e.stop()}}),e)}))),3e5)}(p=Cn.getState().system.__timer__),e.abrupt("return",{chainId:t,etherscanUrl:l,env:a,baseURL:s,socketURL:u,faitPrices:r,gasPrice:i,forex:b,exchangeInfo:c,__timer__:p});case 30:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();function Et(e){var t,a,n,c,r,o,i,s,u,l,d;return m.a.wrap((function(b){for(;;)switch(b.prev=b.next){case 0:return t=e.payload,b.prev=1,a=t.chainId,b.next=5,Object(ne.b)(Mt,a);case 5:return n=b.sent,c=n.env,r=n.baseURL,o=n.faitPrices,i=n.gasPrice,s=n.forex,u=n.exchangeInfo,l=n.etherscanUrl,d=n.__timer__,b.next=16,Object(ne.d)(it({env:c,baseURL:r,faitPrices:o,gasPrice:i,forex:s,exchangeInfo:u,etherscanUrl:l,__timer__:d}));case 16:return b.next=18,Object(ne.b)(Tt,a);case 18:b.next=24;break;case 20:return b.prev=20,b.t0=b.catch(1),b.next=24,Object(ne.d)(it(b.t0));case 24:case"end":return b.stop()}}),Nt,null,[[1,20]])}function Pt(){return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(ne.a)([Object(ne.f)(ot,Et)]);case 2:case"end":return e.stop()}}),Ct)}var Dt=[Object(ne.c)(Pt)],_t=m.a.mark(Ut),Rt=m.a.mark(Bt),Lt=function(){var e=Object(f.a)(m.a.mark((function e(){var t,a,n,c,r,i,s,u,l;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=Cn.getState().account.accAddress,a=Cn.getState().tokenMap,n=a.tokenMap,!((c=a.marketCoins)&&n&&oe.exchangeAPI)){e.next=14;break}return e.next=5,oe.exchangeAPI.getEthBalances({owner:t});case 5:return r=e.sent,i=r.ethBalance,e.next=9,oe.exchangeAPI.getTokenBalances({owner:t,token:c.join()},n);case 9:return s=e.sent,(u=s.tokenBalances).ETH=i,u&&(l=Reflect.ownKeys(u).reduce((function(e,t){return Object(o.a)(Object(o.a)({},e),{},Object(v.a)({},t,{belong:t,count:Object(re.t)(n,t,u[t])}))}),{})),e.abrupt("return",{walletLayer1:l});case 14:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();function Ut(){var e,t;return m.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,Object(ne.b)(Lt);case 3:return e=a.sent,t=e.walletLayer1,a.next=7,Object(ne.d)(pt({walletLayer1:t}));case 7:a.next=13;break;case 9:return a.prev=9,a.t0=a.catch(0),a.next=13,Object(ne.d)(pt(a.t0));case 13:case"end":return a.stop()}}),_t,null,[[0,9]])}function Bt(){return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(ne.a)([Object(ne.f)(bt,Ut)]);case 2:case"end":return e.stop()}}),Rt)}var Ft=[Object(ne.c)(Bt)],Kt={walletLayer2:void 0,status:"DONE",errorMessage:null},Wt=Object(h.c)({name:"walletLayer2",initialState:Kt,reducers:{updateWalletLayer2:function(e,t){e.status=d.L.PENDING},reset:function(e,t){e.walletLayer2=void 0,e.status=d.L.UNSET},getWalletLayer2Status:function(e,t){t.error&&(e.status=d.L.ERROR,e.errorMessage=t.error),e.walletLayer2=Object(o.a)({},t.payload.walletLayer2),e.status=d.L.DONE},statusUnset:function(e){e.status=d.L.UNSET}}}),Ht=Wt.actions,Vt=Ht.updateWalletLayer2,Jt=Ht.getWalletLayer2Status,Gt=Ht.statusUnset,Yt=Ht.reset,zt=m.a.mark(Xt),qt=m.a.mark(Zt),Qt=function(){var e=Object(f.a)(m.a.mark((function e(){var t,a,n,c,r,i,s,u;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=Cn.getState().account,a=t.accountId,n=t.apiKey,c=Cn.getState().tokenMap,c.tokenMap,r=c.idIndex,c.marketCoins,!(n&&a&&oe.userAPI)){e.next=8;break}return e.next=5,oe.userAPI.getUserBalances({accountId:a,tokens:""},n);case 5:s=e.sent,(u=s.userBalances)&&(i=Reflect.ownKeys(u).reduce((function(e,t){return Object(o.a)(Object(o.a)({},e),{},Object(v.a)({},r[t],u[Number(t)]))}),{}));case 8:return e.abrupt("return",{walletLayer2:i});case 9:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();function Xt(){var e,t;return m.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,Object(ne.b)(Qt);case 3:return e=a.sent,t=e.walletLayer2,a.next=7,Object(ne.d)(Jt({walletLayer2:t}));case 7:a.next=13;break;case 9:return a.prev=9,a.t0=a.catch(0),a.next=13,Object(ne.d)(Jt(a.t0));case 13:case"end":return a.stop()}}),zt,null,[[0,9]])}function Zt(){return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(ne.a)([Object(ne.f)(Vt,Xt)]);case 2:case"end":return e.stop()}}),qt)}var $t=[Object(ne.c)(Zt)],ea={userRewardsMap:void 0,status:"PENDING",errorMessage:null,__timer__:-1},ta=Object(h.c)({name:"userRewardsMap",initialState:ea,reducers:{getUserRewards:function(e,t){e.status=d.L.PENDING},getUserRewardsStatus:function(e,t){t.error&&(e.status=d.L.ERROR,e.errorMessage=t.error),e.userRewardsMap=Object(o.a)(Object(o.a)({},e.userRewardsMap),t.payload.userRewardsMap),t.payload.__timer__&&(e.__timer__=t.payload.__timer__),e.status=d.L.DONE},statusUnset:function(e){e.status=d.L.UNSET}}}),aa=ta.actions,na=aa.getUserRewards,ca=aa.getUserRewardsStatus,ra=aa.statusUnset,oa=m.a.mark(ua),ia=m.a.mark(la),sa=function(){var e=Object(f.a)(m.a.mark((function e(t){var a,n;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=Cn.getState().account.accountId,n=Cn.getState().userRewardsMap.__timer__,!oe.ammpoolAPI||!a){e.next=7;break}return n=function(e){return e&&-1!==e&&clearInterval(e),setTimeout(Object(f.a)(m.a.mark((function e(){return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:Cn.dispatch(na(void 0));case 1:case"end":return e.stop()}}),e)}))),12e5)}(n),e.abrupt("return",oe.ammpoolAPI.getAmmPoolUserRewards({owner:a}).then((function(e){return{data:e.ammUserRewardMap,__timer__:n}})));case 7:if(n&&-1!==n&&clearInterval(n),!a){e.next=12;break}return e.abrupt("return",Promise.reject({data:void 0,__timer__:-1}));case 12:return e.abrupt("return",Promise.resolve({data:void 0,__timer__:-1}));case 13:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();function ua(e){var t,a,n;return m.a.wrap((function(c){for(;;)switch(c.prev=c.next){case 0:return e.payload,c.prev=1,c.next=4,Object(ne.b)(sa);case 4:return t=c.sent,a=t.data,n=t.__timer__,c.next=9,Object(ne.d)(ca({userRewardsMap:a,__timer__:n}));case 9:c.next=15;break;case 11:return c.prev=11,c.t0=c.catch(1),c.next=15,Object(ne.d)(ca(c.t0));case 15:case"end":return c.stop()}}),oa,null,[[1,11]])}function la(){return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(ne.a)([Object(ne.f)(na,ua)]);case 2:case"end":return e.stop()}}),ia)}var da=[Object(ne.c)(la)],ba=Object(h.c)({name:"socket",initialState:{socket:{},status:"PENDING",errorMessage:null},reducers:{socketEnd:function(e,t){e.socket={},e.status=d.L.PENDING},sendSocketTopic:function(e,t){e.socket=t.payload.socket},getSocketStatus:function(e,t){t.error&&(e.status=d.L.ERROR,e.errorMessage=t.error),e.status=d.L.DONE},statusUnset:function(e){e.status=d.L.UNSET}}}),pa=ba.actions,ma=pa.getSocketStatus,fa=pa.sendSocketTopic,va=pa.socketEnd,ja=(pa.statusUnset,m.a.mark(xa)),Oa=m.a.mark(ga),ha=m.a.mark(wa),ka=m.a.mark(Aa);function xa(){return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!window.loopringSocket){e.next=4;break}return e.next=4,Object(ne.b)(window.loopringSocket.socketClose);case 4:return e.next=6,Object(ne.d)(ma(void 0));case 6:e.next=12;break;case 8:return e.prev=8,e.t0=e.catch(0),e.next=12,Object(ne.d)(ma(e.t0));case 12:case"end":return e.stop()}}),ja,null,[[0,8]])}function ga(e){var t,a,n;return m.a.wrap((function(c){for(;;)switch(c.prev=c.next){case 0:if(t=e.payload,c.prev=1,a=Cn.getState().account.apiKey,n=t.socket,!window.loopringSocket){c.next=7;break}return c.next=7,Object(ne.b)(window.loopringSocket.socketSendMessage,{socket:n,apiKey:a});case 7:return c.next=9,Object(ne.d)(ma(void 0));case 9:c.next=15;break;case 11:return c.prev=11,c.t0=c.catch(1),c.next=15,Object(ne.d)(ma(c.t0));case 15:case"end":return c.stop()}}),Oa,null,[[1,11]])}function wa(){return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(ne.a)([Object(ne.f)(va,xa)]);case 2:case"end":return e.stop()}}),ha)}function Aa(){return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(ne.a)([Object(ne.f)(fa,ga)]);case 2:case"end":return e.stop()}}),ka)}var ya=[Object(ne.c)(wa),Object(ne.c)(Aa)],Sa=a(68),Ia=m.a.mark(Ma),Na=m.a.mark(Ea),Ca=m.a.mark(Pa),Ta=m.a.mark(Da);function Ma(e){var t,a;return m.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return t=e.payload,n.prev=1,a=t,n.next=5,Object(ne.d)(I(Object(o.a)({},a)));case 5:n.next=11;break;case 7:return n.prev=7,n.t0=n.catch(1),n.next=11,Object(ne.d)(I(n.t0));case 11:case"end":return n.stop()}}),Ia,null,[[1,7]])}function Ea(e){var t,a;return m.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(t=e.payload,n.prev=1,a={accAddress:"",readyState:d.a.UN_CONNECT,accountId:-1,apiKey:"",eddsaKey:"",publicKey:{},level:"",nonce:-1},!t||!t.shouldUpdateProvider){n.next=7;break}return n.next=6,Object(ne.b)(Object(f.a)(m.a.mark((function e(){return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Sa.a.clear();case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)}))));case 6:a=Object(o.a)(Object(o.a)({},a),{},{connectName:d.l.unknown});case 7:return n.next=9,Object(ne.d)(I(Object(o.a)({},a)));case 9:n.next=15;break;case 11:return n.prev=11,n.t0=n.catch(1),n.next=15,Object(ne.d)(I(n.t0));case 15:case"end":return n.stop()}}),Na,null,[[1,11]])}function Pa(){return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(ne.a)([Object(ne.f)(A,Ma)]);case 2:case"end":return e.stop()}}),Ca)}function Da(){return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(ne.a)([Object(ne.f)(S,Ea)]);case 2:case"end":return e.stop()}}),Ta)}var _a=[Object(ne.c)(Pa),Object(ne.c)(Da)],Ra=m.a.mark(La);function La(){return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(ne.a)([].concat(Object(E.a)(Fe),Object(E.a)(Ft),Object(E.a)($t),Object(E.a)(Dt),Object(E.a)(ye),Object(E.a)(at),Object(E.a)(da),Object(E.a)(ya),Object(E.a)(_a)));case 2:case"end":return e.stop()}}),Ra)}var Ua=La;function Ba(){var e=Object(n.c)((function(e){return e.tickerMap})),t=Object(n.b)();return Object(o.a)(Object(o.a)({},e),{},{statusUnset:O.a.useCallback((function(){return t(Ge(void 0))}),[t]),updateTickers:O.a.useCallback((function(e){return t(Ve({tickerKeys:e}))}),[t]),updateTicker:O.a.useCallback((function(e){return t(He({tickerKey:e}))}),[t])})}function Fa(){var e=Object(n.c)((function(e){return e.system})),t=Object(n.b)();return Object(o.a)(Object(o.a)({},e),{},{statusUnset:O.a.useCallback((function(){return t(z(void 0))}),[t]),updateSystem:O.a.useCallback((function(e){return t(ot(e))}),[t])})}var Ka,Wa,Ha,Va,Ja,Ga=function(e){},Ya=function(e){},za=a(88),qa=a.n(za);!function(e){e.dark="dark",e.light="light"}(Ka||(Ka={})),function(e){e.en="en_US",e.cn="zh_CN"}(Wa||(Wa={})),function(e){e[e.NORMAL=0]="NORMAL",e[e.ERROR=1]="ERROR",e[e.UNKNOWN=2]="UNKNOWN"}(Ha||(Ha={})),function(e){e[e.UNKNOWN=0]="UNKNOWN",e[e.LOADING=1]="LOADING",e[e.WALLET=2]="WALLET"}(Va||(Va={})),function(e){e[e.NoError=0]="NoError",e[e.DataNotReady=1]="DataNotReady",e[e.GetAccError=2]="GetAccError",e[e.GenEddsaKeyError=3]="GenEddsaKeyError",e[e.UpdateAccoutError=4]="UpdateAccoutError",e[e.ApproveFailed=5]="ApproveFailed",e[e.DepositFailed=6]="DepositFailed"}(Ja||(Ja={}));var Qa=1e3,Xa=3e3;function Za(){var e=Object(n.c)((function(e){return e.walletLayer2})),t=Object(n.b)();return Object(o.a)(Object(o.a)({},e),{},{resetLayer2:O.a.useCallback((function(){t(Yt(void 0))}),[t]),statusUnset:O.a.useCallback((function(){return t(Gt(void 0))}),[t]),updateWalletLayer2:O.a.useCallback((function(){return t(Vt(void 0))}),[t]),delayAndUpdateWalletLayer2:O.a.useCallback(Object(f.a)(m.a.mark((function e(){return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:Ga("try to delayAndUpdateWalletLayer2!"+(new Date).getTime()),qa.a.delay((function(){return t(Vt(void 0)),Ga("try to delayAndUpdateWalletLayer2 updated!"+(new Date).getTime()),Promise.resolve()}),2500);case 2:case"end":return e.stop()}}),e)}))),[t])})}function $a(){var e=Object(n.c)((function(e){return e.socket})),t=Object(n.b)();return Object(o.a)(Object(o.a)({},e),{},{statusUnset:O.a.useCallback((function(){return t(z(void 0))}),[t]),sendSocketTopic:O.a.useCallback((function(e){return t(fa({socket:e}))}),[t]),socketEnd:O.a.useCallback((function(){return t(va(void 0))}),[t])})}function en(){var e=Object(n.c)((function(e){return e.userRewardsMap})),t=Object(n.b)();return Object(o.a)(Object(o.a)({},e),{},{statusUnset:O.a.useCallback((function(){return t(ra(void 0))}),[t]),getUserRewards:O.a.useCallback((function(){return t(na(void 0))}),[t])})}var tn=Object(h.c)({name:"confirmation",initialState:{confirmed:!1},reducers:{confirm:function(e,t){e.confirmed=!0}}}),an=tn.actions.confirm,nn=Object(h.c)({name:"favoriteMarket",initialState:[],reducers:{clearAll:function(e,t){e.length=0},removeMarket:function(e,t){var a=t.payload;if(a&&e.includes(a)){var n=e.findIndex((function(e){return e===a}));e.splice(n,1)}},addMarket:function(e,t){var a=t.payload;a&&-1===e.findIndex((function(e){return e===a}))&&e.push(a)},addMarkets:function(e,t){var a=t.payload;a.length&&a.forEach((function(t){t&&-1===e.findIndex((function(e){return e===t}))&&e.push(t)}))}}}),cn=nn.actions,rn=cn.clearAll,on=cn.removeMarket,sn=cn.addMarket,un=cn.addMarkets,ln={depositHash:void 0,withdrawHash:[]},dn=Object(h.c)({name:"onchainHashInfo",initialState:ln,reducers:{clearAll:function(e,t){ln},clearDepositHash:function(e,t){e.depositHash=void 0},updateDepositHash:function(e,t){e.depositHash=t.payload}}}),bn=dn.actions,pn=(bn.clearAll,bn.clearDepositHash,bn.updateDepositHash,Object(P.b)({favoriteMarket:nn.reducer,onchainHashInfo:dn.reducer,confirmation:tn.reducer})),mn=a(431),fn=Object(B.a)(),vn=9e5;Ga("---store DEFAULT_TIMEOUT:",vn);var jn={key:"account",storage:R.a,timeout:vn},On={key:"settings",storage:U.a},hn={key:"localStore",storage:U.a},kn=Object(D.a)(jn,g.reducer),xn=Object(D.a)(On,M.Pb.reducer),gn=Object(D.a)(hn,pn),wn=Object(P.b)({account:kn,socket:ba.reducer,settings:xn,system:ct.reducer,modals:M.Fb.reducer,userRewardsMap:ta.reducer,amm:Ae,tokenMap:Ie.reducer,walletLayer2:Wt.reducer,walletLayer1:lt.reducer,tickerMap:Ke.reducer,localStore:gn}),An=Object(h.a)({reducer:wn,middleware:[].concat(Object(E.a)(Object(h.d)({thunk:!1,serializableCheck:!1})),[fn]),devTools:!1,enhancers:[K.reduxBatch]});An.dispatch(W()),An.dispatch(Object(M.Hb)(An.getState().settings.language)),An.dispatch(Object(M.Gb)(F.a)),fn.run(Ua,An.dispatch);var yn,Sn,In,Nn=Object(mn.a)(An),Cn=An,Tn=function(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Cn.getState().tokenMap.tokenMap,n=Mn(e,t,a);return n?n.toNumber():void 0},Mn=function(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Cn.getState().tokenMap.tokenMap;if(a&&a[e]&&"undefined"!==typeof t)try{return Object(re.J)(t).div("1e"+a[e].decimals)}catch(n){throw n}},En=function(e){var t=e.pair,a=e._ammCalcData,n=(e.ammType,e.tokenMap,e.coinMap),c=e.walletMap,r=e.ammMap,o=e.tickerData,i=e.ammPoolsBalance;if(a.coinInfoMap=n,o&&(a.AtoB=Number(o.close)),isNaN(a.AtoB)&&i){var s=Mn(t.coinAInfo.simpleName,i.pooled[0].volume),u=Mn(t.coinBInfo.simpleName,i.pooled[1].volume);a.AtoB=u&&s&&parseFloat(u.div(s).toFixed(7,0))}if(t.coinAInfo){var l,d;a.myCoinA={belong:t.coinAInfo.simpleName,balance:c?null===(l=c[t.coinAInfo.simpleName])||void 0===l?void 0:l.count:0},a.myCoinB={belong:t.coinBInfo.simpleName,balance:c?null===(d=c[t.coinBInfo.simpleName])||void 0===d?void 0:d.count:0};var b="".concat(t.coinAInfo.simpleName,"-").concat(t.coinBInfo.simpleName),p=0,m=0;if(c){var f,v=c?null===(f=c["LP-"+b])||void 0===f?void 0:f.count:0,j=r["AMM-"+b],O=j.totalLPToken,h=j.totalA,k=j.totalB;h&&O&&k&&(p=h/O*v,m=k/O*v),a.lpCoin=v}a.lpCoinA={belong:t.coinAInfo.simpleName,balance:p},a.lpCoinB={belong:t.coinBInfo.simpleName,balance:m}}return a};function Pn(){return Dn.apply(this,arguments)}function Dn(){return(Dn=Object(f.a)(m.a.mark((function e(){var t,a,n,c,r,o;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=Cn.getState().account,a=Cn.getState().system.exchangeInfo,Bn.sendSign(),!a||!oe.userAPI||void 0===t.nonce){e.next=20;break}return e.prev=4,e.next=7,Object(re.u)(Sa.a.usedWeb3,t.accAddress,a.exchangeAddress,t.nonce-1,t.connectName);case 7:return n=e.sent,c=Object(re.K)(Object(re.J)(n.keyPair.secretKey)),e.next=11,oe.userAPI.getUserApiKey({accountId:t.accountId},c);case 11:r=e.sent,o=r.apiKey,Ga("After connect >>,unlockAccount: step2 apiKey",o),Bn.sendAccountSigned(o,n),e.next=20;break;case 17:e.prev=17,e.t0=e.catch(4),Bn.sendErrorUnlock();case 20:case"end":return e.stop()}}),e,null,[[4,17]])})))).apply(this,arguments)}!function(e){e.ErrorNetwork="ErrorNetwork",e.LockAccount="LockAccount",e.NoAccount="NoAccount",e.DepositingAccount="DepositingAccount",e.ErrorApproveToken="ErrorApproveToken",e.ErrorDepositSign="ErrorDepositSign",e.ProcessDeposit="ProcessDeposit",e.SignAccount="SignAccount",e.ErrorSign="ErrorSign",e.ProcessSign="ProcessSign",e.ProcessAccountCheck="ProcessAccountCheck",e.AccountUnlocked="AccountUnlocked"}(yn||(yn={})),function(e){e.FailedConnect="FailedConnect"}(Sn||(Sn={})),function(e){e.waiting="waiting",e.nextStep="nextStep"}(In||(In={}));var _n,Rn,Ln=void 0,Un=new xt.a,Bn={sendSign:function(){var e=Object(f.a)(m.a.mark((function e(){return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:Un.next({status:yn.ProcessSign,data:void 0});case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),sendErrorUnlock:function(){Un.next({status:yn.ErrorSign,data:void 0})},sendUpdateAccStatusAndReset:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;if(Cn.dispatch(A({accountId:t,readyState:e,apiKey:"",eddsaKey:"",publicKey:"",nonce:void 0})),e===d.a.ERROR_NETWORK)Un.next({status:yn.ErrorNetwork,data:void 0});else{var a=Cn.getState().account.accAddress;Bn.sendCheckAccount(a)}},sendAccountLock:function(e){var t=e?{readyState:d.a.LOCKED,accountId:e.accountId,nonce:e.nonce,level:e.tags}:{readyState:d.a.LOCKED,apiKey:"",eddsaKey:"",publicKey:"",nonce:void 0};Cn.dispatch(A(t)),Un.next({status:yn.LockAccount,data:void 0})},sendActiveAccountDeposit:function(){},sendAccountSigned:function(e,t){var a=e&&t?{apiKey:e,eddsaKey:t,publicKey:{x:re.K(re.J(t.keyPair.publicKeyX)),y:re.K(re.J(t.keyPair.publicKeyY))},readyState:d.a.ACTIVATED}:{readyState:d.a.ACTIVATED};Cn.dispatch(A(a)),Un.next({status:yn.AccountUnlocked,data:void 0})},sendNoAccount:function(){Cn.dispatch(A({readyState:d.a.NO_ACCOUNT})),Un.next({status:yn.NoAccount,data:void 0})},sendNeedUpdateAccount:function(){var e=Object(f.a)(m.a.mark((function e(t){return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:Ga("sendNeedUpdateAccount accInfo:",t),Cn.dispatch(A({readyState:d.a.DEPOSITING})),Un.next({status:yn.SignAccount,data:t});case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),sendCheckAcc:function(){var e=Object(f.a)(m.a.mark((function e(){var t,a,n;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(Ln,!Cn){e.next=18;break}if(t=Cn.getState().account,!oe.exchangeAPI){e.next=18;break}return e.next=6,oe.exchangeAPI.getAccount({owner:t.accAddress});case 6:if(a=e.sent,void 0!==(n=a.accInfo)){e.next=12;break}Bn.sendNoAccount(),e.next=18;break;case 12:if(!t.accountId){e.next=16;break}t.publicKey.x&&t.publicKey.y?(Ga("-------need unlockAccount!"),Pn()):(Ga("-------need update account!"),Bn.sendNeedUpdateAccount(n)),e.next=18;break;case 16:throw Ga("unexpected accInfo:",n),Error("unexpected accinfo:"+n);case 18:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),sendCheckAccount:function(){var e=Object(f.a)(m.a.mark((function e(t){var a,n;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(Ln,Ga("After connect >>,checkAccount: step3 processAccountCheck",t),Cn.dispatch(A({accAddress:t,readyState:d.a.UN_CONNECT})),Un.next({status:yn.ProcessAccountCheck,data:void 0}),!oe.exchangeAPI){e.next=20;break}return e.next=7,oe.exchangeAPI.getAccount({owner:t});case 7:if(a=e.sent,n=a.accInfo,Ga("After connect >>,checkAccount: step3",n),void 0!==n){e.next=14;break}Bn.sendNoAccount(),e.next=20;break;case 14:if(!n.accountId){e.next=18;break}n.publicKey.x&&n.publicKey.y?Bn.sendAccountLock(n):(Ga("-------need update account!"),Bn.sendNeedUpdateAccount(n)),e.next=20;break;case 18:throw Ga("unexpected accInfo:",n),Error("unexpected accinfo:"+n);case 20:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),onSocket:function(){return Un.asObservable()}},Fn=function(e,t){var a,n,c,r=Cn.getState().account.readyState,o=e[r]?e[r]:[],i=Object(be.a)(o,2);if(a=i[0],n=i[1],Ga("accountStaticCallBack:",r),"function"===typeof a)return n=[].concat(Object(E.a)(null!==(c=n)&&void 0!==c?c:[]),Object(E.a)(null!==t&&void 0!==t?t:[])),a.apply(undefined,n)},Kn=(_n={},Object(v.a)(_n,d.cb.UN_CONNECT,[function(){return"labelConnectWallet"}]),Object(v.a)(_n,d.cb.ERROR_NETWORK,[function(){return"labelWrongNetwork"}]),Object(v.a)(_n,d.cb.NO_ACCOUNT,[function(){return"depositTitleAndActive"}]),Object(v.a)(_n,d.cb.DEFAULT,[function(){return"depositTitleAndActive"}]),Object(v.a)(_n,d.cb.ACTIVATED,[function(){}]),Object(v.a)(_n,d.cb.LOCKED,[function(){return"labelUnLockLayer2"}]),_n),Wn=(Rn={},Object(v.a)(Rn,d.cb.ERROR_NETWORK,[function(){Ga("get error network!")}]),Object(v.a)(Rn,d.cb.UN_CONNECT,[function(){Ga("UN_CONNECT!"),Cn.dispatch(y({_userOnModel:!0})),Cn.dispatch(Object(M.Jb)({isShow:!0,step:M.zb.Provider}))}]),Object(v.a)(Rn,d.cb.NO_ACCOUNT,[function(){Ga("NO_ACCOUNT! sendCheckAcc"),Cn.dispatch(y({_userOnModel:!0})),Bn.sendCheckAcc()}]),Object(v.a)(Rn,d.cb.DEPOSITING,[function(){Ga("DEPOSITING! sendCheckAcc"),Cn.dispatch(y({_userOnModel:!0})),Bn.sendCheckAcc()}]),Object(v.a)(Rn,d.cb.LOCKED,[function(){Cn.dispatch(y({_userOnModel:!0})),Cn.dispatch(Object(M.Ib)({isShow:!0,step:M.a.HadAccount}))}]),Rn),Hn=function(e){void 0!==typeof e.customSlippage&&Cn.dispatch(Object(M.Ob)(e.customSlippage))};function Vn(e){if(!e||!(e instanceof Object)||"function"==typeof e)return e||void 0;var t=new(0,e.constructor);for(var a in e)e.hasOwnProperty(a)&&(t[a]=Vn(e[a]));return t}function Jn(e){return Gn.apply(this,arguments)}function Gn(){return(Gn=Object(f.a)(m.a.mark((function e(t){var a;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(document.execCommand&&(a=document.createElement("textarea"),document.body.appendChild(a),a.value=t,a.select(),document.execCommand("copy"),document.body.removeChild(a)),!navigator.clipboard){e.next=4;break}return e.next=4,navigator.clipboard.writeText(t);case 4:if(!window.clipboardData){e.next=8;break}return window.clipboardData.setData("Text",t),console.log("clipboardData:",t),e.abrupt("return",!0);case 8:return e.abrupt("return",!1);case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var Yn=a(116),zn=a.n(Yn),qn=function(e){var t=Cn.getState().tokenMap.tokenMap;if(t&&t[e])return t[e]};function Qn(e,t){var a=qn(t);if(a)return void 0===e||null===e||""===e.trim()?0:re.J(e).div("1e"+a.decimals).toFixed(a.precision,0)}var Xn=function(e,t){var a=e.ammActivityMap,n=e.type,c=e.ammPoolActivityStatus,r=Cn.getState().tokenMap,o=r.coinMap,i=r.tokenMap,s=r.idIndex,u={};return a&&a[n]&&c.forEach((function(e){a[n][e]&&a[n][e].reduce((function(a,n){if(o&&n.awardRules[0]&&s&&i){var c,r=s[n.awardRules[0].tokenId],u=Qn(n.awardRules[0].volume,r),l={rewardToken:o[r],totalRewards:Number(u),myRewards:e===re.a.InProgress&&t&&t[n.market]?Tn(r,null===(c=t[n.market])||void 0===c?void 0:c.currentRewards[0].volume):0,duration:{from:new Date(null===n||void 0===n?void 0:n.rangeFrom),to:new Date(null===n||void 0===n?void 0:n.rangeTo)},isPass:re.a.EndOfGame===e};a[n.market]?a[n.market].push(l):a[n.market]=[l]}return a}),u)})),Zn(u)},Zn=function(e,t){var a=Cn.getState().tokenMap.coinMap,n=Cn.getState().amm.ammMap.ammMap;try{return e&&a?Reflect.ownKeys(e).reduce((function(t,c){var r=n[c];if(r&&r.coinA&&a&&e[c]){var i=e[c].map((function(e){return Object(o.a)(Object(o.a)({},Vn(r)),{},{coinAInfo:a[r.coinA],coinBInfo:a[r.coinB],activity:e})}));t=[].concat(Object(E.a)(t),Object(E.a)(i))}return t}),[]):[]}catch(c){return console.log(c),[]}},$n=function(e){var t,a,n,c,r,o,i,s,u,l,d,b,p,m,f=e.coinA,v=e.coinB,j=e.ammUserReward,O=e.idIndex,h=e.faitPrices,k=e.forex,x=e.walletMap,g=e.snapShotData;if(j&&(t=j.currentRewards[0]?O[j.currentRewards[0].tokenId]:void 0,a=j.currentRewards[1]?O[j.currentRewards[1].tokenId]:void 0,n=j?Mn(f,j.feeRewards[0]):Object(re.J)(0),c=j?Mn(v,j.feeRewards[1]):Object(re.J)(0),n=n||Object(re.J)(0),c=c||Object(re.J)(0),o=(r=n.times(h[f]?h[f].price:0).plus(c.times(h[v]?h[v].price:0))).times(k),i=t?Mn(t,j.currentRewards[0].volume):Object(re.J)(0),s=a?Mn(a,j.currentRewards[1].volume):Object(re.J)(0),i=i||Object(re.J)(0),s=s||Object(re.J)(0),l=(u=i.times(t?h[t].price:1).plus(s.times(a?h[a].price:1))).times(k)),x&&x["LP-"+f+"-"+v]&&g){var w=new zn.a(x["LP-"+f+"-"+v].count).div(g.ammPoolsBalance.lp.volume);d=w.times(Mn(f,g.ammPoolsBalance.pooled[0].volume)||1),b=w.times(Mn(v,g.ammPoolsBalance.pooled[1].volume)||1),m=(p=d.times(h[f].price).plus(b.times(h[v].price))).times(k)}return{feeA:n?n.toNumber():void 0,feeB:c?c.toNumber():void 0,reward:i?i.toNumber():void 0,rewardToken:t?M.Db[t]:void 0,reward2:s?s.toNumber():void 0,rewardToken2:a?M.Db[a]:void 0,rewardDollar:u?u.toNumber():void 0,rewardYuan:l?l.toNumber():void 0,feeDollar:r?r.toNumber():void 0,feeYuan:o?o.toNumber():void 0,ammDetail:{coinAInfo:M.Db[f],coinBInfo:M.Db[v]},balanceA:d?d.toNumber():void 0,balanceB:b?b.toNumber():void 0,balanceDollar:p?p.toNumber():void 0,balanceYuan:m?m.toNumber():void 0}},ec=function(e,t,a,n){var c=Cn.getState().tokenMap,r=c.coinMap,o=c.idIndex,i=c.tokenMap,s=Cn.getState().system,u=s.faitPrices,l=s.forex,d=e.match(/(\w+)-(\w+)/i),b=Object(be.a)(d,3),p=b[1],m=b[2];if(a&&a["AMM-"+e]&&n&&n.ammPoolsBalance){var f=a["AMM-"+e];if(r&&i&&o&&l&&u)return $n({coinA:p,coinB:m,ammUserReward:f,idIndex:o,faitPrices:u,forex:l,walletMap:t,snapShotData:n})}return{feeA:void 0,feeB:void 0,feeDollar:void 0,feeYuan:void 0,reward:void 0,rewardToken:void 0,balanceA:void 0,balanceB:void 0,balanceYuan:void 0,balanceDollar:void 0}},tc=function(e){var t=e.market,a=e.ammDetail,n=e.walletMap,c=e.ammUserRewardMap;if(n&&a)return function(e,t,a,n){var c,r,i,s,u=Cn.getState().tokenMap,l=u.coinMap,d=u.idIndex,b=u.tokenMap,p=Cn.getState().system,m=p.faitPrices,f=p.forex,v=e.match(/(\w+)-(\w+)/i),j=Object(be.a)(v,3),O=j[1],h=j[2],k={};if(t&&t["LP-"+O+"-"+h]&&f){var x=new zn.a(t["LP-"+O+"-"+h].count).div(n.totalLPToken);c=x.times(Mn(O,n.totalA?n.totalA:0)||1),r=x.times(Mn(h,n.totalB?n.totalB:0)||1),s=(i=c.times(m[O]?m[O].price:0).plus(r.times(m[h]?m[h].price:0))).times(f),k={balanceA:c.toNumber(),balanceB:r.toNumber(),balanceYuan:s.toNumber(),balanceDollar:i.toNumber()}}if(a&&a["AMM-"+e]&&n&&f){var g,w,A,y,S,I,N,C,T,M,E=a["AMM-"+e];return l&&b&&d&&f&&m&&E&&(g=E.currentRewards[0]?d[E.currentRewards[0].tokenId]:void 0,w=E.currentRewards[1]?d[E.currentRewards[1].tokenId]:void 0,A=E?Mn(O,E.feeRewards[0]):Object(re.J)(0),y=E?Mn(h,E.feeRewards[1]):Object(re.J)(0),A=A||Object(re.J)(0),y=y||Object(re.J)(0),I=(S=A.times(m[O]?m[O].price:0).plus(y.times(m[h]?m[h].price:0))).times(f),N=g?Mn(g,E.currentRewards[0].volume):Object(re.J)(0),C=w?Mn(w,E.currentRewards[1].volume):Object(re.J)(0),N=N||Object(re.J)(0),C=C||Object(re.J)(0),M=(T=N.times(g?m[g].price:1).plus(C.times(w?m[w].price:1))).times(f),k=Object(o.a)(Object(o.a)({},k),{},{feeA:A?A.toNumber():void 0,feeB:y?y.toNumber():void 0,reward:N?N.toNumber():void 0,rewardToken:g?l[g]:void 0,reward2:C?C.toNumber():void 0,rewardToken2:w?l[w]:void 0,rewardDollar:T?T.toNumber():void 0,rewardYuan:M?M.toNumber():void 0,feeDollar:S?S.toNumber():void 0,feeYuan:I?I.toNumber():void 0,ammDetail:{coinAInfo:O?l[O]:void 0,coinBInfo:h?l[h]:void 0}})),k}return{feeA:void 0,feeB:void 0,feeDollar:void 0,feeYuan:void 0,reward:void 0,rewardToken:void 0,balanceA:void 0,balanceB:void 0,balanceYuan:void 0,balanceDollar:void 0}}(t,n,c,a)},ac=function(e){var t=Cn.getState().system,a=t.faitPrices,n=t.forex,c=isNaN(e.close)||isNaN(e.open)||e.open===e.close?d.w.none:e.close>e.open?d.w.increase:d.w.decrease,r={change:(e.close-e.open)/e.open,timeUnit:"24h",priceYuan:0,priceDollar:0,floatTag:c,reward:0,close:isNaN(e.close)?void 0:e.close,high:0===e.high?void 0:e.high,low:0===e.low?void 0:e.low};if(a&&n){var i=Qn(e.base_token_volume,e.base),s=Object(re.J)(e.close).times(a[e.quote]?a[e.quote].price:0),u=s.times(n),l=a[e.quote].price?a[e.quote].price:0;r=Object(o.a)(Object(o.a)({},r),{},{changeDollar:Object(re.J)(e.close-e.open).times(l).toNumber(),changeYuan:Object(re.J)(e.close-e.open).times(l).times(n).toNumber(),volume:i?Number(i):void 0,closeDollar:s.toNumber(),closeYuan:u.toNumber()})}return r},nc=function(e){var t=e.tickerMap,a=Cn.getState().system,n=a.faitPrices,c=a.forex;return Reflect.ownKeys(t).reduce((function(e,a){var r=t[a];if(r&&r.base&&c&&n&&(n[r.base]||n.USDT)){var o=Qn(r.base_token_volume,r.base),i=Object(re.J)(o||0).times(n[r.base]?n[r.base].price:n.USDT.price),s=null===i||void 0===i?void 0:i.times(c),u=r.change&&0!==r.change?100*r.change:void 0;e[a]={timeUnit:"24h",priceDollar:0===(null===i||void 0===i?void 0:i.toNumber())||null===i||void 0===i?void 0:i.toNumber(),priceYuan:0===(null===s||void 0===s?void 0:s.toNumber())||null===s||void 0===s?void 0:s.toNumber(),volume:o?Number(o):void 0,floatTag:r.close>r.open?"increase":"decrease",change:u,close:isNaN(r.close)?void 0:r.close,high:0===r.high?void 0:r.high,low:0===r.low?void 0:r.low,reward:0,rewardToken:"",__rawTicker__:r}}return e}),{})},cc=function(){var e,t=Cn.getState().walletLayer2.walletLayer2,a=Cn.getState().tokenMap.tokenMap;return t&&(e=Reflect.ownKeys(t).reduce((function(e,n){var c=t[n],r=c.total,i=c.locked,s=(c.pending.withdraw,re.J(r).minus(re.J(i)).toString());return Object(o.a)(Object(o.a)({},e),{},Object(v.a)({},n,{belong:n,count:re.t(a,n,s),detail:t[n]}))}),{})),{walletMap:e}},rc=function(e){if(oe.userAPI){var t=Cn.getState().account,a=t.accountId,n=t.apiKey;return oe.userAPI.getUserTrades({accountId:a,market:e},n).then((function(e){return e.userTrades}))}},oc=function(e,t){var a=[];return t.forEach((function(e){try{var t=re.x(e.market),n=t.base,c=t.quote;Cn.getState().system.forex,Cn.getState().settings.currency;if(Cn.getState().tokenMap.tokenMap){var r,o,i=e.side===re.i.Buy?n:c;a.push({side:e.side===re.i.Sell?d.V.Sell:d.V.Buy,amount:{from:{key:n,value:n?Tn(n,e.volume):void 0},to:{key:c,value:n?null===(r=Mn(n,e.volume))||void 0===r?void 0:r.times(e.price).toNumber():void 0}},price:{key:"",value:re.J(e.price).toNumber()},fee:{key:i||"--",value:i?null===(o=Mn(i,e.fee))||void 0===o?void 0:o.toNumber():void 0},time:parseInt(e.tradeTime.toString())})}}catch(s){console.log(s)}})),a},ic=function(){var e,t=Cn.getState().account,a=t.accountId,n=t.apiKey;return null===(e=oe.ammpoolAPI)||void 0===e?void 0:e.getUserAmmPoolTxs({accountId:a},n).then((function(e){return e.userAmmPoolTxs}))},sc=function(e,t){var a=[],n=Cn.getState().tokenMap,c=n.tokenMap,r=n.coinMap,o=n.idIndex;return t.forEach((function(t){try{var n=Cn.getState().system.forex;if(r&&c&&o&&(!e||c["LP-"+e].tokenId===t.lpToken.tokenId)){var i,s,u=o[t.lpToken.tokenId].match(/LP-(\w+)-(\w+)/i),l=Object(be.a)(u,3),d=l[1],b=l[2];a.push({type:t.txType===re.b.JOIN?M.i.add:M.i.remove,totalDollar:1e3,totalYuan:1e3/Number(n),amountA:Tn(d,null===(i=t.poolTokens[0])||void 0===i?void 0:i.actualAmount),amountB:Tn(d,null===(s=t.poolTokens[1])||void 0===s?void 0:s.actualAmount),time:Number(t.updatedAt),coinA:r[d],coinB:r[b],status:t.txStatus})}return a}catch(p){console.log(p)}})),a},uc=function(e){var t=e.coinKey,a=e.ammKey,n=e.ammMap;return new Promise((function(e,c){var r;oe.ammpoolAPI&&oe.exchangeAPI?Promise.all([oe.ammpoolAPI.getAmmPoolSnapshot({poolAddress:null===(r=n[a])||void 0===r?void 0:r.address}),oe.exchangeAPI.getMixTicker({market:t})]).then((function(t){var a=Object(be.a)(t,2),n=a[0].ammPoolSnapshot,c=a[1].tickMap;e({ammPoolsBalance:n,tickMap:c})})):c(new d.o(d.u.NO_SDK))}))},lc=a(1662),dc=a(0),bc=["t"],pc=Object(lc.a)("common")((function(e){var t=e.t,a=Object(l.a)(e,bc),c=Object(u.g)(),r=function(){var e=T(),t=T(),a=t.account,n=t.setShouldShow,c=t.status,r=Object(M.Qb)().setShowAccount,i=Object.assign(Vn(Wn),Object(v.a)({},d.cb.ACTIVATED,[function(){n(!0),r({isShow:!0,step:M.a.HadAccount})}])),s=O.a.useCallback(Object(f.a)(m.a.mark((function e(){return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:Ga("onWalletBtnConnect click: ".concat(a.readyState)),Fn(i,[]);case 2:case"end":return e.stop()}}),e)}))),[a,n,i]);O.a.useEffect((function(){d.mb[d.e.WalletConnect]=Object(o.a)(Object(o.a)({},d.mb[d.e.WalletConnect]),{},{accountState:e,handleClick:s})}));var u=O.a.useCallback((function(){d.mb[d.e.WalletConnect]=Object(o.a)(Object(o.a)({},d.mb[d.e.WalletConnect]),{},{accountState:e})}),[d.mb,e]);return O.a.useEffect((function(){c&&"UNSET"===c&&u()}),[c]),{headerToolBarData:d.mb,headerMenuData:d.kb,account:a}}(),i=r.headerToolBarData,s=r.headerMenuData,p=function(){var e=Object(n.c)((function(e){return e.localStore.confirmation})),t=Object(n.b)();return{confirmation:e,confirmWrapper:O.a.useCallback((function(){t(an(void 0))}),[t])}}(),j=p.confirmWrapper,h=p.confirmation;return Object(dc.jsxs)(dc.Fragment,{children:[Object(dc.jsx)(M.C,{children:Object(dc.jsx)(M.B,Object(o.a)(Object(o.a)({},a),{},{headerMenuData:s,headerToolBarData:i,selected:"/"===c.pathname?d.lb:c.pathname}))}),Object(dc.jsx)(b.a,{}),Object(dc.jsx)(M.n,{isShow:!(null===h||void 0===h?void 0:h.confirmed),content:t("labelAgreeLoopringTxt"),btnTxt:t("labelCookiesAgree"),clickToConfirm:function(){return j()}})]})})),mc=a(323),fc=a(1608),vc=a(1657),jc=a(1702),Oc=a(1731),hc=a(1740),kc=16;var xc,gc,wc=a(875),Ac=a(16),yc=Object(Ac.a)(vc.a)(xc||(xc=Object(i.a)(["\n  display: flex;\n  flex-direction: column;\n  width: 100%;\n  //height: 100%;\n  flex: 1;\n  background: var(--color-box);\n  border-radius: ","px;\n  // padding: ","px  0;\n  margin-bottom: ","px;\n  .title {\n    font-size: ","px;\n    //line-height: 19px;\n    margin-left: ","px;\n    margin-top: ","px;\n    // margin-bottom: ","px;\n  }\n\n  .tableWrapper {\n    display: flex;\n    margin-top: ","px;\n    flex: 1;\n    .rdg {\n      flex: 1;\n    }\n  }\n\n  .extraTradeClass {\n    .rdg-header-row {\n      background-color: inherit !important;\n    }\n  }\n"])),(function(e){return e.theme.unit}),(function(e){return 3*e.theme.unit}),(function(e){return 2*e.theme.unit}),(function(e){return 3*e.theme.unit}),(function(e){return 3*e.theme.unit}),(function(e){return 3*e.theme.unit}),(function(e){return 2*e.theme.unit}),(function(e){return 3*e.theme.unit})),Sc=Object(Ac.a)(fc.a)(gc||(gc=Object(i.a)(["\n \n  &{\n    background: var(--color-box);\n    border-radius: ","px;\n    .rdg{\n      .rdg-header-row {\n        border-radius: ","px ","px 0 0;\n      }\n    }\n  }\n  ","\n"])),(function(e){return e.theme.unit}),(function(e){return e.theme.unit}),(function(e){return e.theme.unit}),(function(e){var t=e.theme;return Object(M.hb)({pLeft:3*t.unit,pRight:3*t.unit})}));var Ic,Nc=Object(mc.a)(fc.a,{target:"e19jzbou2"})("& .MuiGrid-root:not(:last-of-type)>div{margin-right:",(function(e){return 2*e.theme.unit}),"px;}"),Cc=Object(mc.a)(vc.a,{target:"e19jzbou1"})("position:absolute;top:0.9rem;right:",(function(e){return 2*e.theme.unit}),"px;"),Tc=Object(mc.a)(vc.a,{target:"e19jzbou0"})({name:"2n1ryy",styles:"position:relative;padding:0.8rem 0.8rem 0 1rem"});!function(e){e.all="all",e.favourite="favourite",e.ranking="ranking"}(Ic||(Ic={}));var Mc=Object(lc.a)("common")((function(e){var t=O.a.useState([]),a=Object(be.a)(t,2),c=a[0],r=a[1],i=O.a.useState([]),s=Object(be.a)(i,2),l=s[0],b=s[1],p=O.a.useState("all"),h=Object(be.a)(p,2),k=h[0],x=h[1],g=O.a.useState([]),w=Object(be.a)(g,2),A=w[0],y=w[1],S=O.a.useState(""),I=Object(be.a)(S,2),N=I[0],C=I[1],T=O.a.useState([]),P=Object(be.a)(T,2),D=P[0],_=P[1],R=O.a.useState(0),L=Object(be.a)(R,2),U=L[0],B=L[1],F=function(){var e=Object(n.c)((function(e){return e.localStore.favoriteMarket})),t=Object(n.b)();return{favoriteMarket:e,clearAll:O.a.useCallback((function(){return t(rn(void 0))}),[t]),removeMarket:O.a.useCallback((function(e){return t(on(e))}),[t]),addMarket:O.a.useCallback((function(e){return t(sn(e))}),[t]),addMarkets:O.a.useCallback((function(e){return t(un(e))}),[t])}}(),K=F.favoriteMarket,W=F.removeMarket,H=F.addMarket,V=e.t,J=O.a.useCallback(Object(f.a)(m.a.mark((function e(){var t;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!oe.ammpoolAPI){e.next=5;break}return e.next=3,oe.ammpoolAPI.getAmmPoolActivityRules();case 3:(t=e.sent)&&t.groupByRuleType&&t.groupByRuleType.SWAP_VOLUME_RANKING&&t.groupByRuleType.SWAP_VOLUME_RANKING.length&&_(t.groupByRuleType.SWAP_VOLUME_RANKING);case 5:case"end":return e.stop()}}),e)}))),[]),G=O.a.useCallback(function(){var e=Object(f.a)(m.a.mark((function e(t){var a,n;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!oe.exchangeAPI){e.next=5;break}return e.next=3,oe.exchangeAPI.getMixCandlestick({market:t,interval:wc.TradingInterval.d1,limit:30});case 3:(a=e.sent)&&a.candlesticks&&a.candlesticks.length&&(n=a.candlesticks.map((function(e){return{timeStamp:e.timestamp,low:e.low,high:e.high,open:e.open,close:e.close,volume:e.baseVol,sign:e.close<e.open?-1:1}})),r((function(e){return[].concat(Object(E.a)(e),[{market:t,data:n}])})));case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[]),Y=function(){var e=Ba(),t=e.tickerMap,a=e.status,n=e.statusUnset,c=e.updateTickers,r=$a(),i=r.sendSocketTopic,s=r.socketEnd,u=O.a.useState([]),l=Object(be.a)(u,2),b=l[0],p=l[1],h=Cn.getState().tokenMap,k=h.marketArray,x=h.coinMap,g=O.a.useState([]),w=Object(be.a)(g,2),A=w[0],y=w[1],S=O.a.useState([]),I=Object(be.a)(S,2),N=I[0],C=I[1],T=O.a.useState([]),M=(Object(be.a)(T,2)[1],O.a.useState([0,2])),P=Object(be.a)(M,2),D=P[0],_=(P[1],O.a.useState(-1)),R=Object(be.a)(_,2),L=R[0],U=(R[1],O.a.useMemo((function(){return At()}),[])),B=O.a.useCallback((function(e,t){N.length&&(N[e].tradeFloat=t,C(N))}),[N]);O.a.useEffect((function(){var e=U.subscribe((function(e){var t=e.tickerMap;t&&Reflect.ownKeys(t).forEach((function(e){var a=b.findIndex((function(t){return t===e}));-1!==a&&B(a,t[e])}))}));return function(){return e.unsubscribe()}}),[U,b]);var F=Object(j.useCallback)(Object(f.a)(m.a.mark((function e(){var t,a;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!oe.exchangeAPI){e.next=14;break}return e.prev=1,e.next=4,oe.exchangeAPI.getRecommendedMarkets();case 4:return t=e.sent,a=t.recommended,p(a),e.abrupt("return",a||[]);case 10:e.prev=10,e.t0=e.catch(1),Ya(e.t0);case 13:return e.abrupt("return",[]);case 14:case"end":return e.stop()}}),e,null,[[1,10]])}))),[]);O.a.useEffect((function(){F()}),[F]),O.a.useEffect((function(){var e=Object(be.a)(D,2),t=e[0],a=e[1];return K(t,a),H(t*kc),function(){s()}}),[]),O.a.useEffect((function(){switch(a){case"ERROR":console.log("ERROR","get ticker error,ui"),n();break;case"PENDING":break;case"DONE":n(),W(t)}}),[a,n]);var K=O.a.useCallback((function(e,t){c(k||[])}),[k,kc]),W=O.a.useCallback(function(){var e=Object(f.a)(m.a.mark((function e(t){var a,n,c,r,i,s;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,F();case 2:if(a=e.sent,n=[],c=[],r=t&&Object.keys(t)?Reflect.ownKeys(t).reduce((function(e,r){var i=r.match(/(\w+)-(\w+)/i),s=Object(be.a)(i,3),u=s[1],l=s[2],d=Object(o.a)(Object(o.a)({},t[r]),{},{pair:{coinA:u,coinB:l}});return-1!==a.findIndex((function(e){return e===r}))&&n.push(Vn(d)),k&&-1!==k.findIndex((function(e){return e===r}))&&c.push(Vn(d)),e.push(d),e}),[]):[],y([].concat(Object(E.a)(A),Object(E.a)(r))),0===D[0]){for((n=n.filter((function(e){var t=e.pair,a=t.coinA,n=t.coinB;return x&&x[a]&&x[n]}))).length<4&&(i=c.filter((function(e){var t="".concat(e.pair.coinA,"-").concat(e.pair.coinB);return!a.includes(t)})),n=n.concat(i.slice(0,4-n.length)));n.length<4;)n.push(Vn(n[0]));s=n.reduce((function(e,t){if(x&&t){var a=t.pair,n=a.coinA,c=a.coinB,r={tradeFloat:t,coinAInfo:x[n],coinBInfo:x[c]};e.push(r)}return e}),[]),C(s)}case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[A,D]),H=O.a.useCallback(Object(za.debounce)((function(e){e!==L&&i(Object(v.a)({},re.o.ticker,k))}),2*d.jb.wait),[L]);return{tickList:A,recommendations:N}}(),z=Y.recommendations,q=Y.tickList,Q=O.a.useCallback((function(){var e=window.innerHeight;B(e-64-117-56-120-20)}),[]);O.a.useEffect((function(){return Q(),window.addEventListener("resize",Q),function(){window.removeEventListener("resize",Q)}}),[Q]),O.a.useEffect((function(){var e=z.map((function(e){return"".concat(e.coinAInfo.simpleName,"-").concat(e.coinBInfo.simpleName)}));e.length&&(G(e[0]),G(e[1]),G(e[2]),G(e[3]))}),[z,G]);var X=Object(j.useCallback)(Object(f.a)(m.a.mark((function e(){var t,a,n;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!oe.ammpoolAPI){e.next=6;break}return e.next=3,null===(t=oe.ammpoolAPI)||void 0===t?void 0:t.getAmmPoolBalances();case 3:a=e.sent,n=a.raw_data.map((function(e){return Object(o.a)(Object(o.a)({},e),{},{poolName:e.poolName.replace("AMM-","")})})),b(n);case 6:case"end":return e.stop()}}),e)}))),[]);O.a.useEffect((function(){X()}),[X]),O.a.useEffect((function(){J()}),[J]);var Z=Object(u.f)(),$=Object(j.useCallback)((function(){return l.length&&q&&q.length?q.filter((function(e){var t="".concat(e.pair.coinA,"-").concat(e.pair.coinB);return!l.find((function(e){return e.poolName===t}))||!l.find((function(e){return e.poolName===t})).risky})):[]}),[q,l]);Object(j.useEffect)((function(){var e=$();y(e)}),[$]);var ee=Object(j.useCallback)((function(e){var t=e.type,a=void 0===t?Ic.all:t,n=e.keyword,c=void 0===n?"":n,r=Object(za.cloneDeep)(q);a===Ic.favourite&&(r=r.filter((function(e){var t="".concat(e.pair.coinA,"-").concat(e.pair.coinB);return null===K||void 0===K?void 0:K.includes(t)}))),a===Ic.ranking&&(r=r.filter((function(e){var t="".concat(e.pair.coinA,"-").concat(e.pair.coinB);return D.find((function(e){return e.market===t}))}))),r=r.filter((function(e){var t=null===c||void 0===c?void 0:c.toLocaleLowerCase(),a=e.pair.coinA.toLowerCase(),n=e.pair.coinB.toLowerCase();return""===c||((null===a||void 0===a?void 0:a.includes(t))||(null===n||void 0===n?void 0:n.includes(t)))})),a!==Ic.all||c||(r=$()),y(r)}),[$,K,D,q]),te=Object(j.useCallback)((function(e){var t=e.pair,a=t.coinA,n=t.coinB,c="".concat(a,"-").concat(n);Z&&Z.push({pathname:"/trading/lite/".concat(c)})}),[Z]),ae=Object(j.useCallback)((function(e,t){x(t),ee({type:"favourite"===t?Ic.favourite:"tradeRanking"===t?Ic.ranking:Ic.all,keyword:N})}),[ee,N]),ne=O.a.useCallback((function(e){C(e);var t="favourite"===k?Ic.favourite:"tradeRanking"===k?Ic.ranking:Ic.all;ee({keyword:e,type:t})}),[ee,k]);return Object(dc.jsxs)(vc.a,{display:"flex",flexDirection:"column",flex:1,children:[Object(dc.jsx)(Nc,{container:!0,children:z.map((function(t,a){var n,r="".concat(t.coinAInfo.simpleName,"-").concat(t.coinBInfo.simpleName),i=null===(n=c.find((function(e){return e.market===r})))||void 0===n?void 0:n.data.sort((function(e,t){return e.timeStamp-t.timeStamp}));return Object(dc.jsx)(fc.a,{item:!0,xs:3,onClick:function(){Z&&Z.push({pathname:"/trading/lite/".concat(r)})},children:Object(dc.jsx)(M.F,Object(o.a)({},Object(o.a)(Object(o.a)({},t),{},{chartData:i||[]},e)))},a)}))}),Object(dc.jsx)(Sc,{container:!0,marginY:3,paddingBottom:2,flex:1,children:Object(dc.jsxs)(fc.a,{item:!0,xs:12,children:[Object(dc.jsxs)(Tc,{children:[Object(dc.jsxs)(jc.a,{value:k,onChange:ae,"aria-label":"disabled tabs example",children:[Object(dc.jsx)(Oc.a,{label:V("labelQuotePageFavourite"),value:"favourite"}),Object(dc.jsx)(Oc.a,{label:V("labelAll"),value:"all"}),Object(dc.jsx)(Oc.a,{label:V("labelQuotePageTradeRanking"),value:"tradeRanking"})]}),Object(dc.jsx)(Cc,{children:Object(dc.jsx)(M.E,{value:N,onChange:ne})})]}),Object(dc.jsx)(hc.a,{}),Object(dc.jsx)(M.W,Object(o.a)({onRowClick:function(e,t,a){return te(t)},rawData:A,favoriteMarket:K,addFavoriteMarket:H,removeFavoriteMarket:W,currentHeight:U},Object(o.a)({showLoading:q&&!q.length},e)))]})})]})})),Ec=a(80),Pc=a.n(Ec),Dc=a(1722);function _c(e,t){Object(Dc.a)(e,[t||{}])}var Rc=[{value:M.p.Trend,key:M.p.Trend,label:"label"+M.p.Trend},{value:M.p.Depth,key:M.p.Depth,label:"label"+M.p.Depth}];var Lc,Uc,Bc=["props","coinAInfo","coinBInfo","tradeFloat","marketArray","t"],Fc=function(e){e.props;var t=e.coinAInfo,a=e.coinBInfo,n=e.tradeFloat,c=e.marketArray,r=e.t,i=Object(l.a)(e,Bc),s=function(e,t,a,n,c){var r=Rc.map((function(e){var t=e.value,a=e.label,n=e.key;return{value:t,tlabel:c(a),key:n,JSX:Object(dc.jsx)(dc.Fragment,{children:c(a)})}})),o=Object(re.z)(n,null===t||void 0===t?void 0:t.name,null===a||void 0===a?void 0:a.name),i=o.market,s=o.amm,u=Object(j.useState)(M.p.Trend),l=Object(be.a)(u,2),b=l[0],p=l[1],v=Object(j.useState)(d.g.D1),O=Object(be.a)(v,2),h=O[0],k=O[1],x=Object(j.useState)(void 0),g=Object(be.a)(x,2),w=g[0],A=g[1],y=Object(j.useCallback)((function(e,t){A(void 0),p("Trend"===t?M.p.Trend:M.p.Depth)}),[A,p]),S=Object.keys(d.g).reduce((function(e,t){var a={value:d.g[t],key:d.g[t],label:"label"+d.g[t]};return e.push({value:a.value,tlabel:c(a.label?a.label:a.key),key:a.key,JSX:Object(dc.jsx)(dc.Fragment,{children:c(a.label?a.label:a.key)})}),e}),[]);return _c(Object(f.a)(m.a.mark((function e(){var t,a,n,c,r,o,u,l;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=!0,oe.exchangeAPI&&i&&s){e.next=3;break}return e.abrupt("return");case 3:if(b!==M.p.Trend){e.next=17;break}return a={market:s,interval:re.j.d1,limit:30},e.prev=5,e.next=8,oe.exchangeAPI.getCandlestick(a);case 8:n=e.sent,t&&(c=n.candlesticks.map((function(e){return{timeStamp:e.timestamp,low:e.low,high:e.high,open:e.open,close:e.close,volume:e.quoteVol,change:(e.close-e.open)/e.open,date:Pc()(e.timestamp).format("MMM DD")}})),A(c)),e.next=15;break;case 12:e.prev=12,e.t0=e.catch(5),Object(re.s)(e.t0,"ChartPanel getCandlestick");case 15:e.next=29;break;case 17:return r={market:i},e.prev=18,e.next=21,oe.exchangeAPI.getMixDepth(r);case 21:o=e.sent,u=o.depth,t&&(l={bidsPrices:u.bids_prices,bidsAmtTotals:u.bids_amtTotals,asksPrices:u.asks_prices,asksAmtTotals:u.asks_amtTotals},A(l)),e.next=29;break;case 26:e.prev=26,e.t1=e.catch(18),Object(re.s)(e.t1);case 29:return e.abrupt("return",(function(){t=!1}));case 30:case"end":return e.stop()}}),e,null,[[5,12],[18,26]])}))),[oe.exchangeAPI,s,i,b]),{chartUnit:h,chartType:b,tgItemJSXs:r,tgItemJSXsPriceChart:S,handleChange:y,originData:w,handleChartUnitChange:function(e,t){var a="1H"===t?d.g.H1:"1W"===t?d.g.W1:d.g.D1;k(a)}}}(0,t,a,c,r),u=s.chartType,b=s.tgItemJSXs,p=s.handleChange,v=s.originData,O=Object(M.Rb)().upColor,h=null===t||void 0===t?void 0:t.name,k=null===a||void 0===a?void 0:a.name;Ga("basicInfo baseToken:",h," quoteToken:",k);var x=v&&v.length?v.sort((function(e,t){return e.timeStamp-t.timeStamp})):[],g=v&&t&&v.asksAmtTotals?Object(o.a)(Object(o.a)({},v),{},{asksAmtTotals:v.asksAmtTotals.map((function(e){return Number(Qn(e,h))})),bidsAmtTotals:v.bidsAmtTotals.map((function(e){return Number(Qn(e,h))}))}):[];return Object(dc.jsxs)(dc.Fragment,{children:[Object(dc.jsx)(fc.a,{item:!0,children:Object(dc.jsxs)(vc.a,{display:"flex",flexDirection:"row",justifyContent:"space-between",children:[Object(dc.jsx)(M.pb,Object(o.a)({},Object(o.a)(Object(o.a)({coinAInfo:t,coinBInfo:a},i),{},{t:r,tradeFloat:n}))),Object(dc.jsx)(M.kb,Object(o.a)(Object(o.a)({exclusive:!0},Object(o.a)(Object(o.a)({},i),{},{t:r,tgItemJSXs:b,value:u})),{},{handleChange:p}))]})}),Object(dc.jsx)(fc.a,{item:!0,position:"relative",children:Object(dc.jsx)(vc.a,{minHeight:256,maxHeight:256,display:"block",style:{height:"100%",width:"100%"},children:Object(dc.jsx)(M.Y,{type:u,data:u===M.p.Trend?x:g,riseColor:O,extraInfo:k,handleMove:function(){},showXAxis:!0})})})]})},Kc=function(e){return{id:"simple-tab-".concat(e),"aria-controls":"simple-tabpanel-".concat(e)}},Wc=(Ac.a.div(Lc||(Lc=Object(i.a)(["\n            position: relative;\n            width: 100%;\n            margin-top: ","px;\n            background-color: var(--color-box);\n            box-shadow: var(--shadow);\n            border-radius: ","px;\n        "])),(function(e){return 4*e.theme.unit}),(function(e){return e.theme.unit})),Object(Ac.a)(jc.a)(Uc||(Uc=Object(i.a)(["\n    margin-left: ","px;\n"])),(function(e){return e.theme.unit}))),Hc=Object(lc.a)("common")((function(e){var t=e.tradeArray,a=e.myTradeArray,n=e.t,c=Object(j.useState)(1),r=Object(be.a)(c,2),i=r[0],s=r[1],u=Object(j.useState)(0),l=Object(be.a)(u,2),d=l[0],b=l[1],p=Object(j.useCallback)((function(){var e=window.innerHeight;b(e-64-117-56-120-20-100-50-15)}),[]);return Object(j.useEffect)((function(){return p(),window.addEventListener("resize",p),function(){window.removeEventListener("resize",p)}}),[p]),Object(dc.jsxs)(Sc,{item:!0,alignSelf:"stretch",xs:12,marginY:2,paddingBottom:2,flex:1,children:[Object(dc.jsxs)(Wc,{value:i,onChange:function(e,t){s(t)},"aria-label":"tabs switch",children:[Object(dc.jsx)(Oc.a,Object(o.a)({label:n("labelMyTrade")},Kc(0))),Object(dc.jsx)(Oc.a,Object(o.a)({label:n("labelRecent")},Kc(1)))]}),Object(dc.jsx)(hc.a,{}),Object(dc.jsx)(M.ob,{rawData:0===i?a:t,currentHeight:d})]})})),Vc=a(819);var Jc,Gc,Yc=["sell","buy","slippage"],zc=["sell","buy","slippage"],qc=function(){var e=Object(Vc.a)("common").t,t=Object(j.useState)(!1),a=Object(be.a)(t,2),n=a[0],c=a[1],r=Object(j.useState)(),i=Object(be.a)(r,2),s=i[0],b=i[1],p=d.jb.wait,h=Ee(),k=h.coinMap,x=h.tokenMap,g=h.marketArray,w=h.marketCoins,A=h.marketMap,y=Q().ammMap,S=T(),I=S.account,N=S.status,C=Za(),P=C.delayAndUpdateWalletLayer2,D=C.walletLayer2,_=C.status,R=O.a.useState(void 0),L=Object(be.a)(R,2),U=L[0],B=L[1],F=O.a.useState({}),K=Object(be.a)(F,2),W=K[0],H=K[1],V=O.a.useState([]),J=Object(be.a)(V,2),G=J[0],Y=J[1],z=O.a.useState([]),q=Object(be.a)(z,2),X=q[0],Z=q[1],$=O.a.useState(void 0),ee=Object(be.a)($,2),te=ee[0],ae=ee[1],ne=function(e){var t=Ee(),a=t.coinMap,n=t.tokenMap,c=t.marketArray,r=Object(u.h)("".concat(e,"/:market")),o=Object(j.useState)({coinAInfo:void 0,coinBInfo:void 0}),i=Object(be.a)(o,2),s=i[0],l=i[1],d=Object(j.useState)(""),b=Object(be.a)(d,2),p=b[0],m=b[1];return _c((function(){var e;if(a&&n&&c){var t=null===r||void 0===r||null===(e=r.params)||void 0===e?void 0:e.market,o="LRC",i="ETH",s="".concat(o,"-").concat(i);if(t){var u=t.match(/(\w+)-(\w+)/i);u&&u.length>=3&&a[u[1]]&&a[u[2]]&&(o=u[1],i=u[2]);var d=Object(re.z)(c,o,i).market;Ga("-------\x3e coinA:",o," coinB:",i," realMarket:",s=d)}var b=a[o],p=a[i];l({coinAInfo:b,coinBInfo:p}),m(s)}}),[a,n,c,r]),{market:p,pair:s,setPair:l}}("/trading/lite"),ce=ne.pair,ie=ne.setPair,se=ne.market;_c((function(){var e;se&&(Ze(se,void 0,void 0,void 0),null===(e=rc(se))||void 0===e||e.then((function(e){var t=oc(0,e);Z(t||[])})))}),[se]);var ue=O.a.useState(void 0),le=Object(be.a)(ue,2),de=le[0],pe=le[1],me=O.a.useState(void 0),fe=Object(be.a)(me,2),ve=fe[0],je=fe[1],Oe=Object(j.useState)(),he=Object(be.a)(Oe,2),ke=he[0],xe=he[1],ge=Object(j.useState)("0"),we=Object(be.a)(ge,2),Ae=we[0],ye=we[1],Se=Object(j.useState)("0"),Ie=Object(be.a)(Se,2),Ne=Ie[0],Ce=Ie[1],Te=Object(j.useState)(),Me=Object(be.a)(Te,2),Pe=(Me[0],Me[1]),De=Object(j.useState)(),_e=Object(be.a)(De,2),Re=_e[0],Le=_e[1],Ue=function(){var e=Object(j.useState)(M.nb.AVAILABLE),t=Object(be.a)(e,2),a=t[0],n=t[1],c=Object(j.useState)(!1),r=Object(be.a)(c,2),o=r[0],i=r[1],s=Object(j.useState)(!1),u=Object(be.a)(s,2),l=u[0],b=u[1],p=T().account;return Object(j.useEffect)((function(){p.readyState!==d.a.ACTIVATED?n(M.nb.AVAILABLE):n(o?M.nb.LOADING:l?M.nb.AVAILABLE:M.nb.DISABLED)}),[o,l,p.readyState]),{btnStatus:a,setIsSwapLoading:i,setIsValidAmt:b}}(),Be=Ue.btnStatus,Fe=Ue.setIsSwapLoading,Ke=Ue.setIsValidAmt;_c(Object(f.a)(m.a.mark((function e(){var t,a,n,c,r,i,s,u,l,b,p,f;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=null===U||void 0===U?void 0:U.sell.belong,a=null===U||void 0===U?void 0:U.buy.belong,oe.userAPI&&t&&a&&g&&I.readyState===d.a.ACTIVATED&&y&&se&&I.accountId&&I.apiKey){e.next=4;break}return e.abrupt("return");case 4:return n=Object(re.z)(g,t,a),c=n.amm,r=0,c&&y[c]&&(r=y[c].__rawConfig__.feeBips),i={accountId:null===I||void 0===I?void 0:I.accountId,market:se},e.next=10,oe.userAPI.getMinimumTokenAmt(i,I.apiKey);case 10:if(s=e.sent,u=s.amountMap,l=u[t],b=u[a],l&&b){e.next=16;break}return e.abrupt("return");case 16:p=b.userOrderInfo.takerRate,f=re.J(r).plus(re.J(p)).toString(),Pe(l.userOrderInfo.minAmount),Le(b.userOrderInfo.minAmount),Ga("---------------------------- amountMap:",u),Ga("totalFee:",f),Ga("takerRate:",p),Ce(f),ye(p.toString()),H(Object(o.a)(Object(o.a)({},W),{},{fee:f}));case 26:case"end":return e.stop()}}),e)}))),[null===U||void 0===U?void 0:U.sell.belong,null===U||void 0===U?void 0:U.buy.belong,g,y,I.readyState,I.apiKey,I.accountId]),O.a.useEffect((function(){if(_===d.L.UNSET){var e,t,a,n,c=cc().walletMap;H(Object(o.a)(Object(o.a)({},W),{},{walletMap:c})),B({sell:{belong:W.sellCoinInfoMap?null===(e=W.sellCoinInfoMap[W.coinSell])||void 0===e?void 0:e.simpleName:void 0,balance:c?null===(t=c[W.coinSell])||void 0===t?void 0:t.count:0},buy:{belong:W.sellCoinInfoMap?null===(a=W.sellCoinInfoMap[W.coinBuy])||void 0===a?void 0:a.simpleName:void 0,balance:c?null===(n=c[W.coinBuy])||void 0===n?void 0:n.count:0}})}}),[_]),O.a.useEffect((function(){var e=Fn(Kn);je(e)}),[N]);var We=Object(j.useCallback)(function(){var t=Object(f.a)(m.a.mark((function t(a){var n,r,i,s,u,p,f,v,j,O;return m.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=a.sell,r=a.buy,a.slippage,i=Object(l.a)(a,Yc),s=Cn.getState().system.exchangeInfo,Fe(!0),oe.userAPI&&x&&s&&ke&&I.readyState===d.a.ACTIVATED){t.next=8;break}return b(e("labelSwapFailed")),c(!0),Fe(!1),t.abrupt("return");case 8:return u=x[n.belong],p=x[r.belong],f={accountId:I.accountId,sellTokenId:u.tokenId},t.next=13,oe.userAPI.getNextStorageId(f,I.apiKey);case 13:return v=t.sent,t.prev=14,j={exchange:s.exchangeAddress,accountId:I.accountId,storageId:v.orderId,sellToken:{tokenId:u.tokenId,volume:ke.amountS},buyToken:{tokenId:p.tokenId,volume:ke.amountBOutSlip.minReceived},allOrNone:!1,validUntil:re.l,maxFeeBips:parseInt(Ne),fillAmountBOrS:!1,orderType:re.h.ClassAmm,eddsaSignature:""},Ga(j),t.next=19,oe.userAPI.submitOrder(j,I.eddsaKey.sk,I.apiKey);case 19:if(O=t.sent,Ga(O),!(null===O||void 0===O?void 0:O.hash)){t.next=26;break}b(e("labelSwapFailed")),Ya(null===O||void 0===O?void 0:O.errInfo),t.next=30;break;case 26:return b(e("labelSwapSuccess")),t.next=29,P();case 29:B(Object(o.a)(Object(o.a)({},U),{sell:Object(o.a)(Object(o.a)({},null===U||void 0===U?void 0:U.sell),{},{tradeValue:0}),buy:Object(o.a)(Object(o.a)({},null===U||void 0===U?void 0:U.buy),{},{tradeValue:0})}));case 30:c(!0),Fe(!1),t.next=41;break;case 34:t.prev=34,t.t0=t.catch(14),Fe(!1),Object(re.s)(t.t0),b(e("labelSwapFailed")),c(!0),Fe(!1);case 41:xe(void 0),i.__cache__&&Hn(i.__cache__);case 43:case"end":return t.stop()}}),t,null,[[14,34]])})));return function(e){return t.apply(this,arguments)}}(),[U,ke,x]),He=Object.assign(Vn(Wn),Object(v.a)({},d.cb.ACTIVATED,[We])),Ve=O.a.useCallback((function(e){var t=e.sell,a=e.buy,n=e.slippage,c=Object(l.a)(e,zc);Fn(He,[Object(o.a)({sell:t,buy:a,slippage:n},c)])}),[He]),Je=function(){var e=Object(f.a)(m.a.mark((function e(t,a){var n;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.tradeData,e.abrupt("return",new Promise((function(e){switch(a){case M.eb.SEll_CLICK:case M.eb.BUY_CLICK:break;case M.eb.SELL_SELECTED:Ze("".concat(n.sell.belong,"-").concat(n.buy.belong),"sell",n,de);break;case M.eb.BUY_SELECTED:Ze("".concat(n.sell.belong,"-").concat(n.buy.belong),"buy",n,de);break;case M.eb.EXCHANGE_CLICK:Ze("".concat(n.sell.belong,"-").concat(n.buy.belong),void 0,void 0,de)}e(void 0)})));case 2:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),Ge=Object(j.useState)(),Ye=Object(be.a)(Ge,2),ze=Ye[0],qe=Ye[1];Object(j.useEffect)((function(){var e=function(){var e=Object(f.a)(m.a.mark((function e(){var t,a;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(se&&oe.exchangeAPI){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,oe.exchangeAPI.getMixDepth({market:se});case 4:t=e.sent,a=t.depth,qe(a);case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();e();var t=setInterval((function(){e()}),1e4);return function(){t&&clearInterval(t)}}),[se]);var Qe=function(){var e=Object(f.a)(m.a.mark((function e(t,a,n){var c,r,i,s,u,l,d,b,p;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(g&&x&&A&&ze&&y&&W&&se){e.next=3;break}return c=Object(o.a)({},W),e.abrupt("return",{_tradeData:a,_tradeCalcData:c});case 3:return(i=(r="sell"===t)?a.sell.tradeValue:a.buy.tradeValue)?"0."===(i=i.toString().trim())&&(i="0"):i="0",s=a.sell.belong,u=a.buy.belong,void 0===(l=a.slippage)&&(l=.5),l=re.J(l).times(100).toString(),d=Object(v.a)({},"AMM-"+se,y["AMM-"+se].__rawConfig__),Ga(i),b=re.D(i,s,u,r,g,x,A,ze,d,n,Ae,l),xe(b),W.priceImpact=null===b||void 0===b?void 0:b.priceImpact,W.minimumReceived=null===b||void 0===b?void 0:b.amountBOutSlip.minReceivedVal,r?a.buy.tradeValue=(null===b||void 0===b?void 0:b.output)?parseFloat(null===b||void 0===b?void 0:b.output):0:a.sell.tradeValue=(null===b||void 0===b?void 0:b.output)?parseFloat(null===b||void 0===b?void 0:b.output):0,p=Object(o.a)({},W),e.abrupt("return",{_tradeData:a,_tradeCalcData:p});case 20:case"end":return e.stop()}}),e)})));return function(t,a,n){return e.apply(this,arguments)}}();_c((function(){var e=!!((null===ke||void 0===ke?void 0:ke.amountBOut)&&Re&&re.J(null===ke||void 0===ke?void 0:ke.amountBOut).gte(re.J(Re)));Ke(e),je(e||void 0===Re||void 0===U?void 0:"labelLimitMin, ".concat(Qn(Re,null===U||void 0===U?void 0:U.buy.belong)+" "+(null===U||void 0===U?void 0:U.buy.belong))),Ga("output:",ke," quoteMinAmt:",Re," validAmt:",e)}),[ke,Re,null===U||void 0===U?void 0:U.sell.belong]);var Xe=O.a.useCallback(za.debounce(function(){var e=Object(f.a)(m.a.mark((function e(t,a,n){var c,r,i;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Qe(t,a,n);case 2:c=e.sent,r=c._tradeData,i=c._tradeCalcData,B(r),H(Object(o.a)(Object(o.a)({},i),{},{fee:Ne}));case 7:case"end":return e.stop()}}),e)})));return function(t,a,n){return e.apply(this,arguments)}}(),2*p),[B,H,Qe,Ae]),Ze=function(e,t,a,n){if(W&&e==="".concat(W.coinSell,"-").concat(W.coinBuy)&&a&&t&&(!U||U[t].tradeValue!==a[t].tradeValue))Xe(t,a,n);else{var c,r,i={},s=void 0,u=function(e){var t=e.coinKey,a=e._tradeCalcData,n=e.tokenMap,c=e.coinMap;if(t){var r=t.match(/(\w+)-(\w+)/i),o=Object(be.a)(r,3),i=(o[0],o[1]),s=o[2];if(i&&c&&c[i]&&(a.coinSell=i),i!==s&&s&&-1!==n[i].tradePairs.findIndex((function(e){return e===s})))return a.coinBuy=s,a}return a.coinSell&&""!==a.coinSell?(a.coinBuy&&""!==a.coinBuy&&"undefined"!==a.coinBuy||(n&&n[a.coinSell].tradePairs?a.coinBuy=n[a.coinSell].tradePairs[0]:(a.coinSell="LRC",a.coinBuy="ETH")),a):(a.coinSell="LRC",a.coinBuy="ETH",a)}({coinKey:e,_tradeCalcData:{coinSell:null===ce||void 0===ce||null===(c=ce.coinAInfo)||void 0===c?void 0:c.simpleName,coinBuy:null===ce||void 0===ce||null===(r=ce.coinBInfo)||void 0===r?void 0:r.simpleName},tokenMap:x,coinMap:k}),l=Object(re.z)(g,u.coinSell,u.coinBuy),b=l.amm,p=l.market;Ga("_tradeCalcData:",u,se,p);var m=null!==p&&void 0!==p?p:se;if(m){var f=m.match(/(\w+)-(\w+)/i),j=Object(be.a)(f,3),O=j[1],h=j[2];if(H(Object(o.a)(Object(o.a)({},W),{},{fee:Ne},u)),k&&ie({coinAInfo:k[O],coinBInfo:k[h]}),D){var A,S=cc().walletMap;u.walletMap=S,null===(A=rc(se))||void 0===A||A.then((function(e){var t=oc(0,e);Z(t||[])}))}var I,N=[];if(g&&b&&se&&y)N=[null===(I=oe.exchangeAPI)||void 0===I?void 0:I.getMarketTrades({market:se}),uc({coinKey:se,ammKey:b,ammMap:y})],Promise.all(Object(E.a)(N)).then((function(e){var t=Object(be.a)(e,2),a=t[0].marketTrades,n=t[1],c=n.ammPoolsBalance,r=n.tickMap;if(pe(c),x){var l,b,p,m,f=function(e){var t,a,n=e.coinKey,c=(e.market,e.ammPoolsBalance),r=e.fee,i=e.tokenMap,s=e.tickerData,u=e._tradeCalcData,l=e.coinMap,b=e.marketCoins,p=n.match(/(\w+)-(\w+)/i),m=Object(be.a)(p,3),f=m[1];if(m[2],a=s.base===f?Number(s.close):0!==Number(s.close)?1/Number(s.close):0,isNaN(a)&&c){var j,O=Object(re.x)(n),h=O.base,k=O.quote,x=c.pooled[0],g=c.pooled[1];if(h&&k&&i[h].tokenId===x.tokenId)j=[[h,x.volume],[k,g.volume]];else{if(!h||!k||i[h].tokenId!==g.tokenId)throw new d.o(d.u.NO_SUPPORT_PAIR);j=[[k,g.volume],[h,x.volume]]}var w,A=j,y=Object(be.a)(A,2),S=y[0],I=y[1];S&&I&&(a=parseFloat(null===(w=Mn(I[0],I[1]))||void 0===w?void 0:w.div(Mn(S[0],S[1])||1).toFixed(7,0)))}return u.StoB=a,u.BtoS=0!==a&&void 0!==a?1/(1*a):0,u.sellCoinInfoMap=l&&(null===b||void 0===b?void 0:b.reduce((function(e,t){return Object(o.a)(Object(o.a)({},e),{},Object(v.a)({},t,l[t]))}),{})),u.buyCoinInfoMap=l&&i&&(null===(t=i[u.coinSell].tradePairs)||void 0===t?void 0:t.reduce((function(e,t){return Object(o.a)(Object(o.a)({},e),{},Object(v.a)({},t,l[t]))}),{})),u.fee=r,{_tradeCalcData:u}}({coinKey:"".concat(u.coinSell,"-").concat(u.coinBuy),market:se,ammPoolsBalance:c,tickerData:r[se]?r[se]:{},tokenMap:x,_tradeCalcData:u,coinMap:k,marketCoins:w,fee:Ne})._tradeCalcData;u=f,i=ac(r[se]?r[se]:{}),s=oc(0,a),H(u),ae(i),Y(s),B({sell:{belong:u.sellCoinInfoMap?null===(l=u.sellCoinInfoMap[u.coinSell])||void 0===l?void 0:l.simpleName:void 0,balance:u.walletMap?null===(b=u.walletMap[u.coinSell])||void 0===b?void 0:b.count:0},buy:{belong:u.sellCoinInfoMap?null===(p=u.sellCoinInfoMap[u.coinBuy])||void 0===p?void 0:p.simpleName:void 0,balance:u.walletMap?null===(m=u.walletMap[u.coinBuy])||void 0===m?void 0:m.count:0}})}})).catch((function(e){Ga(e)}))}}};return{swapToastOpen:n,setSwapToastOpen:c,swapAlertText:s,tradeCalcData:W,tradeFloat:te,tradeArray:G,myTradeArray:X,btnStatus:Be,tradeData:U,pair:ce,marketArray:g,onSwapClick:Ve,swapBtnI18nKey:ve,handleSwapPanelEvent:Je}},Qc=Object(Ac.a)(vc.a)(Jc||(Jc=Object(i.a)(["\n  @media only screen and (min-height: 780px ) and (min-width: 1024px) {\n    position: fixed;\n  }\n"]))),Xc=Object(lc.a)("common")((function(e){var t=Object.assign({},e),a=qc(),n=a.tradeCalcData,c=a.tradeData,r=a.tradeFloat,i=a.tradeArray,s=a.myTradeArray,u=a.marketArray,l=a.handleSwapPanelEvent,d=a.onSwapClick,b=a.pair,p=a.swapBtnI18nKey,m=a.btnStatus,f=a.swapToastOpen,v=a.setSwapToastOpen,j=a.swapAlertText;return Object(dc.jsxs)(dc.Fragment,{children:[Object(dc.jsx)(M.jb,{alertText:j,open:f,autoHideDuration:Xa,setOpen:v}),Object(dc.jsxs)(fc.a,{container:!0,marginRight:3,alignContent:"stretch",direction:"column",flexWrap:"nowrap",children:[Object(dc.jsx)(Fc,Object(o.a)({},Object(o.a)(Object(o.a)(Object(o.a)({},t),b),{},{marketArray:u,tradeFloat:r,tradeArray:i}))),Object(dc.jsx)(Hc,{tradeArray:i,myTradeArray:s})]}),Object(dc.jsx)(vc.a,{display:"flex",style:{minWidth:"var(--swap-box-width)"},children:Object(dc.jsx)(Qc,{children:Object(dc.jsx)(M.db,Object(o.a)({tradeData:c,tradeCalcData:n,onSwapClick:d,swapBtnI18nKey:p,swapBtnStatus:m},Object(o.a)({handleSwapPanelEvent:l},t)))})})]})})),Zc=a(1737),$c=function(e){e.children;return Object(dc.jsx)(O.a.Fragment,{children:null})};!function(e){e.Handler="handler",e.AccountId="account_id",e.Account="account",e.Apikey="apikey",e.Eddsakey="eddsakey",e.ActiveTime="active_time",e.AmmOrder="amm_order",e.HardwareAddresses="hardware_addresses",e.ConnectorName="connector_name",e.DepositHash="__loopring__.depositsHash",e.WalletConnect="walletconnect"}(Gc||(Gc={}));var er,tr=function(){function e(){Object(ce.a)(this,e)}return Object(kt.a)(e,null,[{key:"getLocalDepositHash",value:function(e){var t=window.localStorage.getItem(Gc.DepositHash);if(t&&(t=JSON.parse(t))&&e.accAddress&&t[e.accAddress])return t[e.accAddress]}},{key:"clearDepositHash",value:function(e,t){var a=window.localStorage.getItem(Gc.DepositHash);(a=a?JSON.parse(a):{})[e.accAddress]&&a[e.accAddress][t]&&delete a[e.accAddress][t]}},{key:"setLocalDepositHash",value:function(e,t,a){var n=window.localStorage.getItem(Gc.DepositHash);(n=n?JSON.parse(n):{})[e.accAddress]=Object(o.a)(Object(o.a)({},n[e.accAddress]),{},Object(v.a)({},t,a))}},{key:"clearWalletConnect",value:function(){Ga("try to clearWalletConnect...."),localStorage.removeItem(Gc.WalletConnect)}},{key:"setConnectorName",value:function(e){localStorage.setItem(Gc.ConnectorName,e)}},{key:"getConnectorName",value:function(){return localStorage.getItem(Gc.ConnectorName)}},{key:"clearConnectorName",value:function(){Ga("try to clearConnectorName"),localStorage.removeItem(Gc.ConnectorName)}},{key:"getHandler",value:function(){var e=sessionStorage.getItem(Gc.Handler);try{if(void 0!==e&&null!==e)return parseInt(e)}catch(t){}}},{key:"setHandler",value:function(e){sessionStorage.setItem(Gc.Handler,e)}},{key:"clearHandler",value:function(){sessionStorage.removeItem(Gc.Handler)}},{key:"checkTimeout",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=localStorage.getItem(Gc.ActiveTime),a=(new Date).getTime();if(null===t||e)localStorage.setItem(Gc.ActiveTime,a.toString());else{var n=new Date(parseInt(t));if(a-n.getTime()>6e5)return Ga("TIMEOUT! now:".concat(a," dateTimeStr:").concat(t," delta:").concat(a-n.getTime())),sessionStorage.clear(),localStorage.setItem(Gc.ActiveTime,a.toString()),!0}return!1}},{key:"getAccountId",value:function(){var e=sessionStorage.getItem(Gc.AccountId);try{if(e)return parseInt(e)}catch(t){}}},{key:"setAccountId",value:function(e){sessionStorage.setItem(Gc.AccountId,e.toString())}},{key:"getAccount",value:function(){return sessionStorage.getItem(Gc.Account)}},{key:"setAccount",value:function(e){sessionStorage.setItem(Gc.Account,e)}},{key:"getApikey",value:function(){return sessionStorage.getItem(Gc.Apikey)}},{key:"setApikey",value:function(e){sessionStorage.setItem(Gc.Apikey,e)}},{key:"getEddsakey",value:function(){return sessionStorage.getItem(Gc.Eddsakey)}},{key:"setEddsakey",value:function(e){sessionStorage.setItem(Gc.Eddsakey,e)}},{key:"getAmmOrder",value:function(){var e=localStorage.getItem(Gc.AmmOrder);return e||""}},{key:"setAmmOrder",value:function(e){localStorage.setItem(Gc.AmmOrder,e)}},{key:"clearAmmOrder",value:function(){localStorage.removeItem(Gc.AmmOrder)}},{key:"isHardwareAddress",value:function(e){var t=localStorage.getItem(Gc.HardwareAddresses);return!(!t||!t.includes(e.toLowerCase()))}},{key:"saveHardwareAddress",value:function(e){var t=localStorage.getItem(Gc.HardwareAddresses);if(t){if(!0!==t.includes(e.toLowerCase())){var a=t+","+e.toLowerCase();localStorage.setItem(Gc.HardwareAddresses,a)}}else localStorage.setItem(Gc.HardwareAddresses,e.toLowerCase())}}]),e}();!function(e){e.Click="click",e.Scroll="scroll",e.Mouseover="mouseover"}(er||(er={}));var ar=[er.Click,er.Scroll],nr=Object(za.debounce)((function(){tr.checkTimeout(!0)}),200),cr=function(e){var t=e.children;return Object(j.useEffect)((function(){return ar.forEach((function(e){document.addEventListener(e,nr)})),function(){ar.forEach((function(e){document.removeEventListener(e,nr)}))}}),[]),Object(dc.jsx)(O.a.Fragment,{children:t})},rr=a(195);var or=Object(lc.a)("common")((function(e){var t=e.t,a=O.a.useRef(null),n=O.a.useState(10),c=Object(be.a)(n,2),r=c[0],i=c[1],s=function(){var e=T().account,t=e.accountId,a=e.apiKey,n=Object(j.useState)([]),c=Object(be.a)(n,2),r=c[0],o=c[1],i=Object(j.useState)(!0),s=Object(be.a)(i,2),u=s[0],l=s[1],d=function(e){return""===e?M.qb.processing:"processed"===e?M.qb.processed:"processing"===e?M.qb.processing:"received"===e?M.qb.received:M.qb.failed},b=Object(j.useCallback)(Object(f.a)(m.a.mark((function e(){var n,c,r,i,s,u,b,p,f;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(oe&&oe.userAPI&&t&&a)){e.next=11;break}return e.next=3,Promise.all([oe.userAPI.getUserTranferList({accountId:t},a),oe.userAPI.getUserDepositHistory({accountId:t},a),oe.userAPI.getUserOnchainWithdrawalHistory({accountId:t},a)]);case 3:i=e.sent,s=null===(n=i[0].userTransfers)||void 0===n?void 0:n.map((function(e){return{side:M.sb.transfer,amount:{unit:e.symbol||"",value:Number(Tn(e.symbol,e.amount))},fee:{unit:e.feeTokenSymbol||"",value:Number(Mn(e.feeTokenSymbol,e.feeAmount||0))},memo:e.memo||"",time:e.timestamp,txnHash:e.hash,status:d(e.status)}})),u=null===(c=i[1].userDepositHistory)||void 0===c?void 0:c.map((function(e){return{side:M.sb.deposit,symbol:e.symbol,amount:{unit:e.symbol||"",value:Number(Tn(e.symbol,e.amount))},fee:{unit:"",value:0},memo:"",time:e.timestamp,txnHash:e.txHash,status:d(e.status)}})),b=null===(r=i[2].userOnchainWithdrawalHistory)||void 0===r?void 0:r.map((function(e){var t;return{side:M.sb.withdraw,amount:{unit:e.symbol||"",value:Number(Tn(e.symbol,e.amount))},fee:{unit:e.feeTokenSymbol||"",value:Number(null===(t=Tn(e.feeTokenSymbol,e.feeAmount||0))||void 0===t?void 0:t.toFixed(6))},memo:"",time:e.timestamp,txnHash:e.txHash,status:d(e.status)}})),p=[].concat(Object(E.a)(null!==s&&void 0!==s?s:[]),Object(E.a)(null!==u&&void 0!==u?u:[]),Object(E.a)(null!==b&&void 0!==b?b:[])),f=p.sort((function(e,t){return t.time-e.time})),o(f),l(!1);case 11:case"end":return e.stop()}}),e)}))),[t,a]);return _c((function(){b()}),[b]),{txs:r,isLoading:u}}(),u=s.txs,l=s.isLoading;return O.a.useEffect((function(){var e,t=null===a||void 0===a||null===(e=a.current)||void 0===e?void 0:e.offsetHeight;t&&i(Math.floor((t-120)/44)-2)}),[a,r]),Object(dc.jsxs)(yc,{ref:a,children:[Object(dc.jsx)("div",{className:"title",children:t("labelTxnPageTitle")}),Object(dc.jsx)("div",{className:"tableWrapper",children:Object(dc.jsx)(M.rb,Object(o.a)({},Object(o.a)({rawData:u,pagination:{pageSize:r},showFilter:!0,showLoading:l},e)))})]})})),ir=a(1610);var sr,ur,lr=["t"],dr=Object(Ac.a)(vc.a)(sr||(sr=Object(i.a)(["\n    height: 225px;\n\n    > div {\n        position: relative;\n        width: calc(50% - 6px);\n        height: 100%;\n        background: var(--color-box);\n        border-radius: ","px;\n        padding: ","px ","px;\n    }\n"])),(function(e){return e.theme.unit}),(function(e){return 2.5*e.theme.unit}),(function(e){return 3*e.theme.unit})),br=Object(Ac.a)(vc.a)(ur||(ur=Object(i.a)(["\n    position: absolute;\n    z-index: 10;\n    right: ","px;\n    bottom: ","px;\n"])),(function(e){return 3*e.theme.unit}),(function(e){return 2.5*e.theme.unit})),pr=[{value:"week",key:"1 W"},{value:"all",key:"ALL"}],mr=Object(lc.a)("common")((function(e){var t=e.t,a=Object(l.a)(e,lr),c=Object(j.useRef)(null),r=Object(j.useState)(10),i=Object(be.a)(r,2),s=i[0],b=i[1],p=Object(j.useState)("week"),v=Object(be.a)(p,2),h=v[0],k=v[1],x=function(){var e=O.a.useState([]),t=Object(be.a)(e,2),a=t[0],n=t[1],c=O.a.useState([]),r=Object(be.a)(c,2),o=r[0],i=r[1],s=T().account.accAddress,u=Cn.getState().walletLayer2.walletLayer2,l=Cn.getState().amm.ammMap.ammMap,b=Za().status,p=O.a.useCallback(Object(f.a)(m.a.mark((function e(){var t,a,c,r=arguments;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=r.length>0&&void 0!==r[0]?r[0]:7,e.next=3,null===(t=oe.walletAPI)||void 0===t?void 0:t.getUserAssets({wallet:s,assetType:re.d.DEX,limit:a});case 3:(c=e.sent)&&c.userAssets.length&&c.userAssets.length&&n(c.userAssets.map((function(e){return{timeStamp:Number(e.createdAt),close:Number(e.amount)}})));case 5:case"end":return e.stop()}}),e)}))),[s]);O.a.useEffect((function(){if("UNSET"===b){var e=cc(),t=e&&e.walletMap?Object.keys(e.walletMap):[],a=e&&e.walletMap?Object.values(e.walletMap):[],n=t.map((function(e,t){return{token:e,detail:a[t]}}));i(n)}}),[b]),O.a.useEffect((function(){oe&&oe.walletAPI&&u&&p()}),[u,p]);var v=Cn.getState().system.faitPrices,j=v?Object.entries(v).map((function(e){return{token:e[0],detail:e[1]}})):[],h=o.map((function(e){if("LP"!==e.token.split("-")[0]){var t,a,n,c,r="DAI"===e.token?1:Number(j.find((function(t){return t.token===e.token}))?null===(t=j.find((function(t){return t.token===e.token})))||void 0===t?void 0:t.detail.price:0)/Number(null===(a=j.find((function(e){return"USDT"===e.token})))||void 0===a?void 0:a.detail.price);return{name:e.token,value:Number(Tn(e.token,null===(n=e.detail)||void 0===n||null===(c=n.detail)||void 0===c?void 0:c.total))*r}}var o=e.token.split("-");o.splice(0,1,"AMM");var i=o.join("-"),s=l[i].totalLPToken||0;return{name:e.token,value:s}})),k=h.filter((function(e){return"LP"===e.name.split("-")[0]})).reduce((function(e,t){return{name:"LP-Token",value:e.value+t.value}}),{name:"LP-Token",value:0}),x=h.filter((function(e){return"LP"===e.name.split("-")[0]})).length>0?[].concat(Object(E.a)(h.filter((function(e){return"LP"!==e.name.split("-")[0]}))),[k]):h;return{chartData:a,formattedData:h,formattedDoughnutData:x,assetsRawData:o.map((function(e){var t,a,n,c,r,o,i=Number(null===(t=j.find((function(t){return t.token===e.token})))||void 0===t?void 0:t.detail.price)/Number(null===(a=j.find((function(e){return"USDT"===e.token})))||void 0===a?void 0:a.detail.price);return{token:{type:"LP"===e.token.split("-")[0]?M.mb.lp:M.mb.single,value:e.token},amount:String(Number(Tn(e.token,null===(n=e.detail)||void 0===n?void 0:n.detail.total)).toFixed(6))||d.t,available:String(null===(c=e.detail)||void 0===c?void 0:c.count)||d.t,locked:String(null===(r=e.detail)||void 0===r?void 0:r.detail.locked)||d.t,smallBalance:i*Number(Tn(e.token,null===(o=e.detail)||void 0===o?void 0:o.detail.total))<1}}))}}(),g=x.formattedDoughnutData,w=x.assetsRawData,A=x.formattedData,y=x.chartData,S=Cn.getState().walletLayer2.walletLayer2;Object(j.useEffect)((function(){var e,t=null===c||void 0===c||null===(e=c.current)||void 0===e?void 0:e.offsetHeight;t&&b(Math.floor((t-120)/44)-1)}),[c,s]);var I=function(){var e=Object(n.b)(),t=T().account.readyState,a=Object(Vc.a)("common").t,c=O.a.useCallback((function(n,c){var r=t===d.a.NO_ACCOUNT;console.log("isNoAccount: ",r,a("depositTitleAndActive"));var i={isShow:n,props:Object(o.a)({title:a(r?"depositTitleAndActive":"depositTitle"),description:"depositAndActiveDescription"},c)};e(Object(M.Kb)(i))}),[e,a,t]),r=O.a.useCallback((function(t,a){return e(Object(M.Mb)({isShow:t,props:Object(o.a)({},a)}))}),[e]),i=O.a.useCallback((function(t,a){return e(Object(M.Nb)({isShow:t,props:Object(o.a)({},a)}))}),[e]);return O.a.useCallback((function(t,a){return e(Object(M.Lb)({isShow:t,props:Object(o.a)({},a)}))}),[e]),{showDeposit:c,showTransfer:r,showWithdraw:i}}(),N=I.showDeposit,C=I.showTransfer,P=I.showWithdraw,D=Object(u.f)(),_=Object(j.useCallback)((function(e){N(!0,{tradeData:{balance:"",belong:e}})}),[N]),R=Object(j.useCallback)((function(e){C(!0,{tradeData:{balance:"",belong:e}})}),[C]),L=Object(j.useCallback)((function(e){P(!0,{tradeData:{balance:"",belong:e}})}),[P]),U=Object(j.useCallback)((function(e,t){D&&D.push("/liquidity/pools/coinPair/".concat(e,"?type=").concat(t))}),[D]),B={assetInfo:{totalAsset:A.map((function(e){return e.value})).reduce((function(e,t){return e+t}),0),priceTag:d.H.Dollar},onShowDeposit:_,onShowTransfer:R,onShowWithdraw:L};return Object(dc.jsxs)(dc.Fragment,{children:[Object(dc.jsx)(vc.a,{children:Object(dc.jsx)(M.l,Object(o.a)({},Object(o.a)(Object(o.a)({t:t},a),B)))}),Object(dc.jsxs)(dr,{display:"flex",justifyContent:"space-between",alignItems:"center",marginTop:2,children:[Object(dc.jsxs)(ir.a,{component:"div",children:[Object(dc.jsx)(rr.a,{component:"span",color:"textSecondary",variant:"body1",children:t("labelAssetsDistribution")}),Object(dc.jsx)(M.u,{data:S?g:[]})]}),Object(dc.jsxs)(ir.a,{component:"div",children:[Object(dc.jsx)(rr.a,{component:"span",color:"textSecondary",variant:"body1",children:t("labelTotalAssets")}),Object(dc.jsx)(M.Y,{type:M.p.Trend,data:y}),Object(dc.jsx)(br,{children:Object(dc.jsx)(M.kb,Object(o.a)({exclusive:!0,size:"small"},Object(o.a)(Object(o.a)({},a),{},{t:t,data:pr,value:h,setValue:k})))})]})]}),Object(dc.jsx)(yc,{style:{marginTop:"".concat(2*d.sb,"px")},children:Object(dc.jsx)("div",{className:"tableWrapper",ref:c,children:Object(dc.jsx)(M.m,Object(o.a)({},Object(o.a)({rawData:w,pagination:{pageSize:s},showFiliter:!0,onShowDeposit:_,onShowTransfer:R,onShowWithdraw:L,onLpDeposit:U,onLpWithdraw:U},a)))})})]})}));var fr=Object(lc.a)("common")((function(e){var t=O.a.useState(10),a=Object(be.a)(t,2),n=a[0],c=a[1],r=function(){var e=O.a.useState([]),t=Object(be.a)(e,2),a=t[0],n=t[1],c=O.a.useState(!0),r=Object(be.a)(c,2),o=r[0],i=r[1],s=T().account,u=s.accountId,l=s.apiKey,b=Cn.getState().tokenMap.tokenMap,p=O.a.useCallback(Object(f.a)(m.a.mark((function e(){var t;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(oe&&oe.userAPI&&u&&l&&b)){e.next=5;break}return e.next=3,oe.userAPI.getUserTrades({accountId:u},l);case 3:(t=e.sent)&&t.userTrades&&(n(t.userTrades.map((function(e){var t,a,n=e.market.split("-"),c=n[n.length-2],r=n[n.length-1],o=e.side===re.i.Buy?c:r;return{side:e.side===re.i.Buy?d.V.Buy:d.V.Sell,price:{key:c,value:Object(re.J)(e.price).toNumber()},fee:{key:o,value:o?null===(t=Tn(o,e.fee))||void 0===t?void 0:t.toFixed(6):void 0},time:Number(e.tradeTime),amount:{from:{key:c,value:c?Tn(c,e.volume):void 0},to:{key:r,value:c?null===(a=Mn(c,e.volume))||void 0===a?void 0:a.times(e.price).toNumber():void 0}}}}))),i(!1));case 5:case"end":return e.stop()}}),e)}))),[u,l,b]);return O.a.useEffect((function(){p()}),[p]),{userTrades:a,showLoading:o}}(),i=r.userTrades,s=r.showLoading,u=O.a.useRef(null),l=e.t;return O.a.useEffect((function(){var e,t=null===u||void 0===u||null===(e=u.current)||void 0===e?void 0:e.offsetHeight;t&&c(Math.floor((t-120)/44)-2)}),[u,n]),Object(dc.jsxs)(yc,{ref:u,children:[Object(dc.jsx)("div",{className:"title",children:l("labelTradePageTitle")}),Object(dc.jsx)("div",{className:"tableWrapper extraTradeClass",children:Object(dc.jsx)(M.ob,Object(o.a)({},Object(o.a)({rawData:i,showFilter:!0,showLoading:s},e)))})]})}));var vr=["t"],jr=Object(lc.a)("common")((function(e){var t=e.t,a=Object(l.a)(e,vr),n=O.a.useRef(null),c=O.a.useState(10),r=Object(be.a)(c,2),i=r[0],s=r[1],u=function(){var e=O.a.useState([]),t=Object(be.a)(e,2),a=t[0],n=t[1],c=O.a.useState(!0),r=Object(be.a)(c,2),o=r[0],i=r[1],s=Cn.getState().account,u=s.accountId,l=s.apiKey,d=Cn.getState().tokenMap.tokenMap,b=O.a.useCallback((function(e){if(d){var t=Object.keys(d),a=Object.values(d).findIndex((function(t){return t.tokenId===e}));return a>-1?t[a]:""}return""}),[d]),p=O.a.useCallback(Object(f.a)(m.a.mark((function e(){var t,a;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(oe.ammpoolAPI&&u&&l)){e.next=5;break}return e.next=3,oe.ammpoolAPI.getUserAmmPoolTxs({accountId:u},l);case 3:(t=e.sent)&&t.userAmmPoolTxs&&(a=t.userAmmPoolTxs.map((function(e){var t,a,n,c,r,o,i,s,u,l,d,p;return{side:e.txType===re.b.JOIN?M.g.Join:M.g.Exit,amount:{from:{key:b(null===(t=e.poolTokens[0])||void 0===t?void 0:t.tokenId),value:String(Tn(b(null===(a=e.poolTokens[0])||void 0===a?void 0:a.tokenId),null===(n=e.poolTokens[0])||void 0===n?void 0:n.actualAmount))},to:{key:b(null===(c=e.poolTokens[1])||void 0===c?void 0:c.tokenId),value:String(Tn(b(null===(r=e.poolTokens[1])||void 0===r?void 0:r.tokenId),null===(o=e.poolTokens[1])||void 0===o?void 0:o.actualAmount))}},lpTokenAmount:String(Tn(b(null===(i=e.lpToken)||void 0===i?void 0:i.tokenId),null===(s=e.lpToken)||void 0===s?void 0:s.actualAmount)),fee:{key:b(null===(u=e.poolTokens[1])||void 0===u?void 0:u.tokenId),value:null===(l=Tn(b(null===(d=e.poolTokens[1])||void 0===d?void 0:d.tokenId),null===(p=e.poolTokens[1])||void 0===p?void 0:p.feeAmount))||void 0===l?void 0:l.toFixed(6)},time:e.updatedAt}})),n(a),i(!1));case 5:case"end":return e.stop()}}),e)}))),[u,l,b]);return Object(j.useEffect)((function(){p()}),[p]),{ammRecordList:a,showLoading:o}}(),d=u.ammRecordList,b=u.showLoading;return O.a.useEffect((function(){var e,t=null===n||void 0===n||null===(e=n.current)||void 0===e?void 0:e.offsetHeight;t&&s(Math.floor((t-120)/44)-2)}),[n,i]),Object(dc.jsx)(dc.Fragment,{children:Object(dc.jsxs)(yc,{ref:n,children:[Object(dc.jsx)("div",{className:"title",children:t("labelAmmPageTitle")}),Object(dc.jsx)("div",{className:"tableWrapper",children:Object(dc.jsx)(M.h,Object(o.a)({},Object(o.a)({rawData:d,pagination:{pageSize:i},showFilter:!0,showLoading:b},a)))})]})})}));var Or,hr,kr,xr,gr=Object(lc.a)("common")((function(e){var t=O.a.useState(10),a=Object(be.a)(t,2),n=a[0],c=a[1],r=O.a.useState("transactions"),i=Object(be.a)(r,2),s=i[0],u=i[1],l=function(){var e=T().account,t=e.accountId,a=e.apiKey,n=Object(j.useState)([]),c=Object(be.a)(n,2),r=c[0],o=c[1],i=Object(j.useState)(!0),s=Object(be.a)(i,2),u=s[0],l=s[1],d=function(e){return""===e?M.qb.processing:"processed"===e?M.qb.processed:"processing"===e?M.qb.processing:"received"===e?M.qb.received:M.qb.failed},b=Object(j.useCallback)(Object(f.a)(m.a.mark((function e(){var n,c,r,i,s,u,b,p,f;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(oe&&oe.userAPI&&t&&a)){e.next=11;break}return e.next=3,Promise.all([oe.userAPI.getUserTranferList({accountId:t},a),oe.userAPI.getUserDepositHistory({accountId:t},a),oe.userAPI.getUserOnchainWithdrawalHistory({accountId:t},a)]);case 3:i=e.sent,s=null===(n=i[0].userTransfers)||void 0===n?void 0:n.map((function(e){return{side:M.sb.transfer,amount:{unit:e.symbol||"",value:Number(Tn(e.symbol,e.amount))},fee:{unit:e.feeTokenSymbol||"",value:Number(Mn(e.feeTokenSymbol,e.feeAmount||0))},memo:e.memo||"",time:e.timestamp,txnHash:e.hash,status:d(e.status)}})),u=null===(c=i[1].userDepositHistory)||void 0===c?void 0:c.map((function(e){return{side:M.sb.deposit,symbol:e.symbol,amount:{unit:e.symbol||"",value:Number(Tn(e.symbol,e.amount))},fee:{unit:"",value:0},memo:"",time:e.timestamp,txnHash:e.txHash,status:d(e.status)}})),b=null===(r=i[2].userOnchainWithdrawalHistory)||void 0===r?void 0:r.map((function(e){var t;return{side:M.sb.withdraw,amount:{unit:e.symbol||"",value:Number(Tn(e.symbol,e.amount))},fee:{unit:e.feeTokenSymbol||"",value:Number(null===(t=Tn(e.feeTokenSymbol,e.feeAmount||0))||void 0===t?void 0:t.toFixed(6))},memo:"",time:e.timestamp,txnHash:e.txHash,status:d(e.status)}})),p=[].concat(Object(E.a)(null!==s&&void 0!==s?s:[]),Object(E.a)(null!==u&&void 0!==u?u:[]),Object(E.a)(null!==b&&void 0!==b?b:[])),f=p.sort((function(e,t){return t.time-e.time})),o(f),l(!1);case 11:case"end":return e.stop()}}),e)}))),[t,a]);return _c((function(){b()}),[b]),{txs:r,isLoading:u}}(),b=l.txs,p=l.isLoading,v=function(){var e=O.a.useState([]),t=Object(be.a)(e,2),a=t[0],n=t[1],c=O.a.useState(!0),r=Object(be.a)(c,2),o=r[0],i=r[1],s=T().account,u=s.accountId,l=s.apiKey,b=Cn.getState().tokenMap.tokenMap,p=O.a.useCallback(Object(f.a)(m.a.mark((function e(){var t;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(oe&&oe.userAPI&&u&&l&&b)){e.next=5;break}return e.next=3,oe.userAPI.getUserTrades({accountId:u},l);case 3:(t=e.sent)&&t.userTrades&&(n(t.userTrades.map((function(e){var t,a,n=e.market.split("-"),c=n[n.length-2],r=n[n.length-1],o=e.side===re.i.Buy?c:r;return{side:e.side===re.i.Buy?d.V.Buy:d.V.Sell,price:{key:c,value:Object(re.J)(e.price).toNumber()},fee:{key:o,value:o?null===(t=Tn(o,e.fee))||void 0===t?void 0:t.toFixed(6):void 0},time:Number(e.tradeTime),amount:{from:{key:c,value:c?Tn(c,e.volume):void 0},to:{key:r,value:c?null===(a=Mn(c,e.volume))||void 0===a?void 0:a.times(e.price).toNumber():void 0}}}}))),i(!1));case 5:case"end":return e.stop()}}),e)}))),[u,l,b]);return O.a.useEffect((function(){p()}),[p]),{userTrades:a,showLoading:o}}(),h=v.userTrades,k=v.showLoading,x=function(){var e=O.a.useState([]),t=Object(be.a)(e,2),a=t[0],n=t[1],c=O.a.useState(!0),r=Object(be.a)(c,2),o=r[0],i=r[1],s=Cn.getState().account,u=s.accountId,l=s.apiKey,d=Cn.getState().tokenMap.tokenMap,b=O.a.useCallback((function(e){if(d){var t=Object.keys(d),a=Object.values(d).findIndex((function(t){return t.tokenId===e}));return a>-1?t[a]:""}return""}),[d]),p=O.a.useCallback(Object(f.a)(m.a.mark((function e(){var t,a;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(oe.ammpoolAPI&&u&&l)){e.next=5;break}return e.next=3,oe.ammpoolAPI.getUserAmmPoolTxs({accountId:u},l);case 3:(t=e.sent)&&t.userAmmPoolTxs&&(a=t.userAmmPoolTxs.map((function(e){var t,a,n,c,r,o,i,s,u,l,d,p;return{side:e.txType===re.b.JOIN?M.g.Join:M.g.Exit,amount:{from:{key:b(null===(t=e.poolTokens[0])||void 0===t?void 0:t.tokenId),value:String(Tn(b(null===(a=e.poolTokens[0])||void 0===a?void 0:a.tokenId),null===(n=e.poolTokens[0])||void 0===n?void 0:n.actualAmount))},to:{key:b(null===(c=e.poolTokens[1])||void 0===c?void 0:c.tokenId),value:String(Tn(b(null===(r=e.poolTokens[1])||void 0===r?void 0:r.tokenId),null===(o=e.poolTokens[1])||void 0===o?void 0:o.actualAmount))}},lpTokenAmount:String(Tn(b(null===(i=e.lpToken)||void 0===i?void 0:i.tokenId),null===(s=e.lpToken)||void 0===s?void 0:s.actualAmount)),fee:{key:b(null===(u=e.poolTokens[1])||void 0===u?void 0:u.tokenId),value:null===(l=Tn(b(null===(d=e.poolTokens[1])||void 0===d?void 0:d.tokenId),null===(p=e.poolTokens[1])||void 0===p?void 0:p.feeAmount))||void 0===l?void 0:l.toFixed(6)},time:e.updatedAt}})),n(a),i(!1));case 5:case"end":return e.stop()}}),e)}))),[u,l,b]);return O.a.useEffect((function(){p()}),[p]),{ammRecordList:a,showLoading:o}}(),g=x.ammRecordList,w=x.showLoading,A=e.t,y=O.a.useRef(null);return O.a.useEffect((function(){var e,t=null===y||void 0===y||null===(e=y.current)||void 0===e?void 0:e.offsetHeight;t&&c(Math.floor((t-120)/44)-2)}),[y,n]),Object(dc.jsxs)(yc,{ref:y,children:[Object(dc.jsx)(vc.a,{marginTop:2,marginLeft:2,children:Object(dc.jsxs)(jc.a,{value:s,onChange:function(e,t){return u(t)},"aria-label":"l2-history-tabs",children:[Object(dc.jsx)(Oc.a,{label:A("labelLayer2HistoryTransactions"),value:"transactions"}),Object(dc.jsx)(Oc.a,{label:A("labelLayer2HistoryTrades"),value:"trades"}),Object(dc.jsx)(Oc.a,{label:A("labelLayer2HistoryAmmRecords"),value:"ammRecords"})]})}),Object(dc.jsx)("div",{className:"tableWrapper",children:"transactions"===s?Object(dc.jsx)(M.rb,Object(o.a)({},Object(o.a)({rawData:b,pagination:{pageSize:n},showFilter:!0,showLoading:p},e))):"trades"===s?Object(dc.jsx)(M.ob,Object(o.a)({},Object(o.a)({rawData:h,showFilter:!0,showLoading:k},e))):Object(dc.jsx)(M.h,Object(o.a)({},Object(o.a)({rawData:g,pagination:{pageSize:n},showFilter:!0,showLoading:w},e)))})]})})),wr=Object(lc.a)("common")((function(e){var t=O.a.useRef(null),a=O.a.useState(10),n=Object(be.a)(a,2),c=n[0],r=n[1],i=O.a.useState([]),s=Object(be.a)(i,2),u=s[0],l=s[1],b=T().account,p=b.accountId,v=b.apiKey;return Object(j.useEffect)((function(){!function(){var e=Object(f.a)(m.a.mark((function e(){var t;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(oe&&oe.userAPI&&p&&v)){e.next=5;break}return e.next=3,oe.userAPI.getOrders({accountId:p},v);case 3:(t=e.sent)&&Array.isArray(t.orders)&&t.orders.length&&l(t.orders.map((function(e){var t=e.market.split("-"),a=t[t.length-2],n=t[t.length-1],c=e.volumes,r=c.baseAmount,o=c.quoteAmount,i=c.baseFilled,s=c.quoteFilled;return{side:"BUY"===e.side?d.V.Buy:d.V.Sell,amount:{from:{key:a,value:Number(Tn(a,r))},to:{key:n,value:Number(Tn(n,o))}},average:Number(Tn(n,s))/Number(Tn(a,i)),filledAmount:{from:{key:a,value:Number(Tn(a,i))},to:{key:n,value:Number(Tn(n,s))}},filledPrice:{key:n,value:Number(e.price)},time:1e3*e.validity.start,status:e.status,detailTable:[]}})));case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()()}),[p,v]),O.a.useEffect((function(){var e,a=null===t||void 0===t||null===(e=t.current)||void 0===e?void 0:e.offsetHeight;a&&r(Math.floor((a-120)/44)-2)}),[t,c]),Object(dc.jsx)(dc.Fragment,{children:Object(dc.jsxs)(yc,{ref:t,children:[Object(dc.jsx)("div",{className:"title",children:"Order History"}),Object(dc.jsx)("div",{className:"tableWrapper",children:Object(dc.jsx)(M.Q,Object(o.a)({},Object(o.a)({pagination:{pageSize:c},rawData:u,showFilter:!0},e)))})]})})})),Ar=function(e){e.ammActivityMap;var t=Za(),a=t.walletLayer2,n=t.status,c=en(),r=Ee().marketArray,o=Q(),i=o.ammMap,s=O.a.useState(void 0),u=Object(be.a)(s,2),l=u[0],b=u[1],p=O.a.useState([]),m=Object(be.a)(p,2),f=m[0],v=m[1],j=O.a.useState([]),h=Object(be.a)(j,2),k=h[0],x=h[1],g=O.a.useCallback((function(){var e,t=cc().walletMap;t&&(null===(e=ic())||void 0===e||e.then((function(e){var t=sc(void 0,e);x(t||[])})));return t}),[cc,ic,sc,r]),w=O.a.useCallback((function(e){return e&&i?Reflect.ownKeys(e).reduce((function(t,a){if(/LP-/i.test(a)){var n,r=a.replace("LP-","AMM-"),o=a.replace("LP-","");void 0!==(n=tc({ammDetail:i[r],walletMap:e,market:o,ammUserRewardMap:c.userRewardsMap}))&&t.push(n)}return t}),[]):[]}),[i,c.userRewardsMap]);return O.a.useEffect((function(){if(n===d.L.UNSET&&o.ammMap){var e=g(),t=w(e);v(t)}}),[n]),O.a.useEffect((function(){if("ERROR"===o.status)o.statusUnset();else if("DONE"===o.status&&(o.statusUnset(),a)){var e=g(),t=w(e);v(t)}}),[o.status]),O.a.useEffect((function(){if("ERROR"===c.status)c.statusUnset();else if("DONE"===c.status){c.statusUnset();var e=function(e){var t=e.userRewardsMap,a=Cn.getState().tokenMap,n=a.coinMap,c=a.idIndex,r=a.tokenMap,o=Cn.getState().system,i=o.faitPrices,s=o.forex;if(t&&c&&n&&r&&i&&s)return Object.keys(t).reduce((function(e,a){if(/AMM-/i.test(a)){var n=a.match(/AMM-(\w+)-(\w+)/i),r=Object(be.a)(n,3),o=r[1],u=r[2],l=t[a],d=$n({coinB:u,coinA:o,ammUserReward:l,idIndex:c,faitPrices:i,forex:s}),b=d.rewardDollar,p=d.rewardYuan,m=d.feeDollar,f=d.feeYuan;e.rewardDollar=b?Object(re.J)(b).plus(e.rewardDollar).toNumber():0,e.rewardYuan=p?Object(re.J)(p).plus(e.rewardYuan).toNumber():0,e.feeDollar=m?Object(re.J)(m).plus(e.feeDollar).toNumber():0,e.feeYuan=f?Object(re.J)(f).plus(e.feeYuan).toNumber():0}return e}),{rewardDollar:0,rewardYuan:0,feeDollar:0,feeYuan:0})}({userRewardsMap:c.userRewardsMap});if(b(e),a&&o.ammMap){var t=w(a);v(t)}}}),[c.status]),{myAmmMarketArray:k,summaryReward:l,myPoolRow:f}},yr=["t","ammActivityMap"],Sr=Object(Ac.a)(vc.a)(Or||(Or=Object(i.a)(["\n    height: 100%;\n    flex: 1;\n    background: var(--color-box);\n    border-radius: ","px;\n"])),(function(e){return e.theme.unit})),Ir=Object(Ac.a)(fc.a)(hr||(hr=Object(i.a)(["\n    position: relative;\n    width: 100%;\n    background: var(--color-box);\n    border-radius: ","px;\n"])),(function(e){return e.theme.unit})),Nr=(Object(Ac.a)(vc.a)(kr||(kr=Object(i.a)(["\n  position: absolute;\n  z-index: 99;\n  top: ","px;\n  width: 100%;\n"])),(function(e){return e.theme.unit})),Object(lc.a)("common")((function(e){var t=e.t,a=e.ammActivityMap,n=(Object(l.a)(e,yr),O.a.useState("ALL")),c=Object(be.a)(n,2),r=(c[0],c[1],O.a.useState(1)),o=Object(be.a)(r,2),i=(o[0],o[1]),s=Object(M.Rb)().currency,b=Object(u.f)(),p=O.a.useCallback((function(e,t){b&&b.push("/liquidity/pools/coinPair/".concat(e,"?type=").concat(t))}),[b]),m=(O.a.useCallback((function(e){i(e)}),[]),Ar({ammActivityMap:a})),f=(m.myAmmMarketArray,m.summaryReward),v=m.myPoolRow;return Object(dc.jsxs)(dc.Fragment,{children:[Object(dc.jsxs)(fc.a,{container:!0,spacing:2,children:[Object(dc.jsx)(fc.a,{item:!0,sm:3,children:Object(dc.jsxs)(Ir,{container:!0,paddingY:3,paddingX:4,margin:0,display:"flex",flexDirection:"column",children:[Object(dc.jsxs)(fc.a,{display:"flex",flexDirection:"column",item:!0,children:[Object(dc.jsx)(rr.a,{variant:"h5",color:"textSecondary",fontFamily:"Roboto",children:t("labelTotalPositionValue")}),Object(dc.jsx)(rr.a,{variant:"h3",marginTop:1,fontFamily:"Roboto",children:void 0===f?d.t:s===d.n.dollar?d.H.Dollar+Object(d.hb)(void 0!==f.rewardDollar?f.rewardDollar:0)+Object(d.hb)(void 0!==f.feeDollar?f.feeDollar:0):d.H.Yuan+Object(d.hb)(f.rewardYuan?f.rewardYuan:0)+Object(d.hb)(f.feeYuan?f.feeYuan:0)})]}),Object(dc.jsxs)(fc.a,{display:"flex",flexDirection:"column",marginTop:5,item:!0,children:[Object(dc.jsx)(rr.a,{variant:"h5",component:"h3",fontFamily:"Roboto",color:"textSecondary",children:t("labelFeeRewards")}),Object(dc.jsx)(rr.a,{variant:"h3",marginTop:1,fontFamily:"Roboto",children:void 0===f?d.t:s===d.n.dollar?d.H.Dollar+Object(d.hb)(f.feeDollar?f.feeDollar:0):d.H.Yuan+Object(d.hb)(f.feeYuan?f.feeYuan:0)})]}),Object(dc.jsxs)(fc.a,{display:"flex",flexDirection:"column",marginTop:5,item:!0,children:[Object(dc.jsx)(rr.a,{variant:"h5",component:"h3",fontFamily:"Roboto",color:"textSecondary",children:t("labelMiningRewards")}),Object(dc.jsx)(rr.a,{variant:"h3",marginTop:1,fontFamily:"Roboto",children:void 0===f?d.t:s===d.n.dollar?d.H.Dollar+Object(d.hb)(f.rewardDollar?f.rewardDollar:0):d.H.Yuan+Object(d.hb)(f.rewardYuan?f.rewardYuan:0)})]})]})}),Object(dc.jsx)(fc.a,{item:!0,xs:9,children:Object(dc.jsx)(Sr,{})})]}),Object(dc.jsx)(Sc,{marginY:2,paddingY:2,paddingX:3,flex:1,children:Object(dc.jsxs)(fc.a,{item:!0,xs:12,display:"flex",flexDirection:"column",children:[Object(dc.jsx)(rr.a,{variant:"h5",marginBottom:3,children:t("labelMyAmm")}),Object(dc.jsx)(M.O,{rawData:v,handleDeposit:function(e){var t="".concat(e.ammDetail.coinAInfo.name,"-").concat(e.ammDetail.coinBInfo.name);p(t,"add")},handleWithdraw:function(e){var t="".concat(e.ammDetail.coinAInfo.name,"-").concat(e.ammDetail.coinBInfo.name);p(t,"remove")},handlePageChange:function(){}})]})})]})}))),Cr=["t"],Tr=d.qb,Mr=(Object(Ac.a)(vc.a)(xr||(xr=Object(i.a)(["\n  ","\n\n"])),(function(e){var t=e.theme;return"\n    background: var(--color-box);\n    width: 100%;\n    min-width:auto;\n    ".concat(t.border.defaultFrame({c_key:"blur"}),";\n    & > div{\n      background-color:initial;\n      border:0;\n      width:auto;\n      min-width: var(--swap-box-width);\n      max-width: 520px;\n    }\n    ")})),Object(lc.a)(["common"],{withRef:!0})((function(e){var t,a=e.t,n=T().status,c=O.a.useState(void 0),r=Object(be.a)(c,2),o=r[0],i=r[1],s=Object.assign(Vn(Kn),(t={},Object(v.a)(t,d.cb.NO_ACCOUNT,[function(){return"depositTitleAndActive"}]),Object(v.a)(t,d.cb.ERROR_NETWORK,[function(){return"depositTitleAndActive"}]),t));O.a.useEffect((function(){n===d.L.UNSET&&i(Fn(s))}),[n,d.nb.language]);var u=Object.assign(Vn(Wn),{});return Object(dc.jsx)(M.o,{variant:"contained",size:"large",color:"primary",fullWidth:!0,style:{maxWidth:"280px"},onClick:function(){Fn(u,[])},children:a(o)})}))),Er=Object(lc.a)(["layout","common"],{withRef:!0})(M.ab),Pr=function(){var e,t=Object(u.h)("/layer2/:item"),a=T().account,n=Object(Vc.a)(),c=n.t,r=(Object(l.a)(n,Cr),null!==(e=null===t||void 0===t?void 0:t.params.item)&&void 0!==e?e:"assets"),o=O.a.useMemo((function(){switch(a.readyState){case d.a.UN_CONNECT:return Object(dc.jsxs)(vc.a,{flex:1,display:"flex",justifyContent:"center",flexDirection:"column",alignItems:"center",children:[Object(dc.jsx)(rr.a,{marginY:3,variant:"h1",children:c("describeTitleConnectToWallet")}),Object(dc.jsx)(Mr,{})]});case d.a.LOCKED:return Object(dc.jsxs)(vc.a,{flex:1,display:"flex",justifyContent:"center",flexDirection:"column",alignItems:"center",children:[Object(dc.jsx)(rr.a,{marginY:3,variant:"h1",children:c("describeTitleLocked")}),Object(dc.jsx)(Mr,{})]});case d.a.NO_ACCOUNT:return Object(dc.jsxs)(vc.a,{flex:1,display:"flex",justifyContent:"center",flexDirection:"column",alignItems:"center",children:[Object(dc.jsx)(rr.a,{marginY:3,variant:"h1",children:c("describeTitleNoAccount")}),Object(dc.jsx)(Mr,{})]});case d.a.DEPOSITING:return Object(dc.jsxs)(vc.a,{flex:1,display:"flex",justifyContent:"center",flexDirection:"column",alignItems:"center",children:[Object(dc.jsx)(d.C,{color:"primary",style:{width:60,height:60}}),Object(dc.jsx)(rr.a,{marginY:3,variant:"h1",children:c("describeTitleOpenAccounting")})]});case d.a.ERROR_NETWORK:return Object(dc.jsx)(vc.a,{flex:1,display:"flex",justifyContent:"center",flexDirection:"column",alignItems:"center",children:Object(dc.jsx)(rr.a,{marginY:3,variant:"h1",children:c("describeTitleOnErrorNetwork",{connectName:a.connectName})})});case d.a.ACTIVATED:return Object(dc.jsxs)(dc.Fragment,{children:[Object(dc.jsx)(vc.a,{width:"200px",display:"flex",justifyContent:"stretch",marginRight:3,marginBottom:2,children:Object(dc.jsx)(M.Z,{children:Object(dc.jsx)(Er,{selected:r,subMenu:Tr})})}),Object(dc.jsxs)(vc.a,{minHeight:420,display:"flex",alignItems:"stretch",flexDirection:"column",marginTop:0,flex:1,children:["assets"===r&&Object(dc.jsx)(mr,{}),"my-liquidity"===r&&Object(dc.jsx)(Nr,{}),"history"===r&&Object(dc.jsx)(gr,{}),"transactions"===r&&Object(dc.jsx)(or,{}),"trades"===r&&Object(dc.jsx)(fr,{}),"ammRecords"===r&&Object(dc.jsx)(jr,{}),"order"===r&&Object(dc.jsx)(wr,{})]})]})}}),[c,a.readyState,r]);return Object(dc.jsx)(dc.Fragment,{children:o})},Dr=a(1720),_r=a(1607);var Rr,Lr,Ur,Br,Fr,Kr,Wr=["t","ammActivityMap"],Hr=Object(Ac.a)(vc.a)(Rr||(Rr=Object(i.a)(["\n    flex: 1;\n    display: flex;\n    flex-direction: column;\n"]))),Vr=Object(Ac.a)(vc.a)(Lr||(Lr=Object(i.a)(["\n    width: 100%;\n    height: 100%;\n    flex: 1;\n    background: var(--color-box);\n    border-radius: ","px;\n\n    .rdg {\n        flex: 1;\n    }\n\n"])),(function(e){return e.theme.unit})),Jr=Object(lc.a)("common")((function(e){var t=e.t,a=(e.ammActivityMap,Object(l.a)(e,Wr),O.a.useRef(null)),n=O.a.useState(10),c=Object(be.a)(n,2),r=c[0],i=c[1],s=O.a.useState(""),u=Object(be.a)(s,2),b=u[0],p=u[1],m=function(e){var t=e.pageSize,a=O.a.useState([]),n=Object(be.a)(a,2),c=n[0],r=n[1],i=O.a.useState(1),s=Object(be.a)(i,2),u=s[0],l=s[1],b=Ee().coinMap,p=O.a.useRef(-1),m=Q(),f=m.ammMap,v=m.status,j=Ba(),h=j.tickerMap,k=j.status,x=j.updateTickers,g=$a(),w=(g.status,g.statusUnset,O.a.useCallback((function(e){try{var t=Vn(f);for(var a in e)t["AMM-"+a]&&(t["AMM-"+a].tradeFloat=Object(o.a)(Object(o.a)({},t["AMM-"+a].tradeFloat),e[a]));r(Object.keys(t).map((function(e){return b&&(t[e].coinAInfo=b[t[e].coinA],t[e].coinBInfo=b[t[e].coinB]),t[e]})))}catch(n){throw new d.o(Object(o.a)(Object(o.a)({},d.u.NO_TOKEN_MAP),{},{options:n}))}}),[f])),A=O.a.useCallback((function(e){x(e),-1!==p.current&&clearTimeout(p.current),p.current=setTimeout((function(){A(e)}),1e3)}),[x]);O.a.useEffect((function(){return function(){clearTimeout(p.current)}}),[p.current]);var y=O.a.useCallback((function(e){if(l(e),f&&Object.keys(f).length>0){for(var a=[],n=(u-1)*t;n<Object.keys(f).length&&n<(u-1)*t+t;n++)a.push(Object.keys(f)[n]);A(a)}}),[f,t]);return O.a.useEffect((function(){f&&0!==Object.keys(f).length&&y(u)}),[]),O.a.useEffect((function(){k===d.L.UNSET&&w(h)}),[k]),O.a.useEffect((function(){v===d.L.UNSET&&y(1)}),[v,y]),{page:u,rawData:c,updateTickersUI:y}}({pageSize:r}),f=m.updateTickersUI,v=m.rawData,h=m.page;O.a.useEffect((function(){var e,t=null===a||void 0===a||null===(e=a.current)||void 0===e?void 0:e.offsetHeight;t&&i(Math.floor((t-120)/44)-1)}),[a,r]);var k=O.a.useCallback((function(){return b?v.filter((function(e){var t=e.coinAInfo.name.toLowerCase(),a=e.coinBInfo.name.toLowerCase(),n=b.toLowerCase();return t.includes(n)||a.includes(n)})):v}),[b,v]),x=O.a.useCallback((function(e){f(e)}),[f]);return Object(dc.jsx)(dc.Fragment,{children:Object(dc.jsxs)(Hr,{children:[Object(dc.jsx)(vc.a,{marginBottom:3,children:Object(j.createElement)(Dr.a,{placeholder:t("labelFilter"),value:b,onChange:function(e){var t;p(null===(t=e.currentTarget)||void 0===t?void 0:t.value)},key:"search",className:"search","aria-label":"search",startAdornment:Object(dc.jsx)(_r.a,{position:"start",children:Object(dc.jsx)(d.M,{})})})}),Object(dc.jsx)(Vr,{display:"flex",flexDirection:"column",ref:a,children:Object(dc.jsx)(M.R,{rawData:k(),handlePageChange:x,page:h,pagination:{pageSize:r},showFilter:!1,showLoading:!v.length})})]})})})),Gr=a(1712),Yr=a(1730),zr=a(1718),qr=["pair","walletMap","ammType","snapShotData"],Qr=function(e){var t=e.pair,a=(e.walletMap,e.ammType),n=e.snapShotData,c=Object(l.a)(e,qr),r=function(e){var t,a=e.pair,n=e.ammType,c=e.snapShotData,r=Object(j.useState)(!1),i=Object(be.a)(r,2),s=i[0],u=i[1],l=Object(j.useState)(),b=Object(be.a)(l,2),p=b[0],h=b[1],k=Za().delayAndUpdateWalletLayer2,x=Object(Vc.a)("common").t,g=Ee(),w=g.coinMap,A=g.tokenMap,y=Q().ammMap,S=T(),I=S.account,N=S.status,C=O.a.useState(),M=Object(be.a)(C,2),E=M[0],P=M[1],D=O.a.useRef(-1),_=O.a.useState({coinA:{belong:void 0},coinB:{belong:void 0},slippage:.5}),R=Object(be.a)(_,2),L=R[0],U=R[1],B=O.a.useState({coinA:{belong:void 0},coinB:{belong:void 0},slippage:.5}),F=Object(be.a)(B,2),K=F[0],W=F[1],H=O.a.useState(void 0),V=Object(be.a)(H,2),J=V[0],G=V[1],Y=O.a.useState(void 0),z=Object(be.a)(Y,2),q=z[0],X=z[1],Z=O.a.useCallback(function(){var e=Object(f.a)(m.a.mark((function e(t,a){var r;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:Ga("initAmmData:",I.accAddress,a,t),r=En({pair:t,ammType:n,_ammCalcData:{},tokenMap:A,coinMap:w,walletMap:a,ammMap:y,tickerData:null===c||void 0===c?void 0:c.tickerData,ammPoolsBalance:null===c||void 0===c?void 0:c.ammPoolsBalance}),P(Object(o.a)(Object(o.a)({},E),r)),r.myCoinA&&(U({coinA:Object(o.a)(Object(o.a)({},r.myCoinA),{},{tradeValue:void 0}),coinB:Object(o.a)(Object(o.a)({},r.myCoinB),{},{tradeValue:void 0}),slippage:.5}),W({coinA:Object(o.a)(Object(o.a)({},r.lpCoinA),{},{tradeValue:void 0}),coinB:Object(o.a)(Object(o.a)({},r.lpCoinB),{},{tradeValue:void 0}),slippage:.5}));case 4:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),[c,w,A,E,y,n,P,U,W]),$=Object(j.useState)(),ee=Object(be.a)($,2),te=ee[0],ae=ee[1],ne=O.a.useCallback(Object(f.a)(m.a.mark((function e(){var t,n,c,r,o,i,s,u,l,d,b,p,f;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((null===(t=a.coinAInfo)||void 0===t?void 0:t.simpleName)&&(null===(n=a.coinBInfo)||void 0===n?void 0:n.simpleName)&&oe.ammpoolAPI){e.next=3;break}return h(x("labelAmmJoinFailed")),e.abrupt("return");case 3:if(c=Cn.getState().tokenMap,r=c.marketArray,o=c.marketMap,i=Cn.getState().amm.ammMap.ammMap,s=Object(re.z)(r,a.coinAInfo.simpleName,a.coinBInfo.simpleName),u=s.market,l=s.amm,u&&l&&o){e.next=8;break}return e.abrupt("return");case 8:return d=i[l],b={poolAddress:d.address},e.next=12,oe.ammpoolAPI.getAmmPoolSnapshot(b);case 12:if(p=e.sent){e.next=16;break}return Ga("err res:",p),e.abrupt("return");case 16:f=p.ammPoolSnapshot,ae(f);case 18:case"end":return e.stop()}}),e)}))),[a,y]);O.a.useEffect((function(){return-1!==D.current&&clearInterval(D.current),D.current=setInterval((function(){ne()}),1e4),ne(),function(){clearInterval(D.current)}}),[D.current]);var ce=Object(j.useState)(),ie=Object(be.a)(ce,2),se=ie[0],ue=ie[1],le=Object(j.useState)(),de=Object(be.a)(le,2),pe=de[0],me=de[1],fe=T().account,ve=fe.accountId,je=fe.apiKey;_c(Object(f.a)(m.a.mark((function e(){var t,n,c,r,i,s,u,l,b,p,f,v;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(N!==d.L.UNSET){e.next=23;break}if(c=Fn(Kn),G(c),X(c),oe.userAPI&&(null===(t=a.coinBInfo)||void 0===t?void 0:t.simpleName)&&I.readyState===d.a.ACTIVATED&&E&&A){e.next=6;break}return e.abrupt("return");case 6:return r=A[a.coinBInfo.simpleName],i={accountId:ve,requestType:re.g.AMM_JOIN,tokenSymbol:a.coinBInfo.simpleName},e.next=10,oe.userAPI.getOffchainFeeAmt(i,je);case 10:return s=e.sent,u=s.fees,ue(u),l=re.J(null===(n=u[a.coinBInfo.simpleName])||void 0===n?void 0:n.fee).div("1e"+r.decimals).toString()+" "+a.coinBInfo.simpleName,b={accountId:I.accountId,requestType:re.g.AMM_EXIT,tokenSymbol:a.coinBInfo.simpleName},e.next=17,oe.userAPI.getOffchainFeeAmt(b,je);case 17:p=e.sent,f=p.fees,me(f),v=re.J(f[a.coinBInfo.simpleName].fee).div("1e"+r.decimals).toString()+" "+a.coinBInfo.simpleName,Ga("-> feeJoin:",l," feeExit:",v),P(Object(o.a)(Object(o.a)({},E),{},{feeJoin:l,feeExit:v}));case 23:case"end":return e.stop()}}),e)}))),[ue,me,P,G,X,N,I.readyState,ve,je,null===(t=a.coinBInfo)||void 0===t?void 0:t.simpleName,A,E]);var Oe=Object(j.useState)(),he=Object(be.a)(Oe,2),ke=he[0],xe=he[1],ge=O.a.useCallback(Object(za.debounce)(function(){var e=Object(f.a)(m.a.mark((function e(t,a,n,c){var r,o,i,s,u,l,d,b,p,f,v,j,O,h,k,x,g,w,y,S,N,C,T,M;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t&&A&&t.coinA.belong&&t.coinB.belong&&c&&n&&(null===I||void 0===I?void 0:I.accAddress)){e.next=2;break}return e.abrupt("return");case 2:if(Ga("handlerJoinInDebounce",t,a),r=t.slippage,o=re.J(r).div(100).toString(),i="coinA"===a,s=Cn.getState().tokenMap,u=s.idIndex,l=s.marketArray,d=s.marketMap,b=Cn.getState().amm.ammMap.ammMap,p=Object(re.z)(l,t.coinA.belong,t.coinB.belong),f=p.market,v=p.amm,f&&v&&d){e.next=11;break}return e.abrupt("return");case 11:j=d[f],O=b[v],h=A[t.coinA.belong],k=A[t.coinB.belong],x=c.pooled[0],g=c.pooled[1],w=t.coinA.tradeValue?re.J(t.coinA.tradeValue).times(h.decimals).toFixed(0,0):"0",(y=re.p(w,i,x,g)).output,y.ratio,S=t.coinA.tradeValue?t.coinA.tradeValue.toString():0,N=t.coinB.tradeValue?t.coinB.tradeValue.toString():0,C=i?S:N,T=Object(re.H)(C,i,o,I.accAddress,n,b[v],c,A,u,0,0),M=T.request,i?t.coinB.tradeValue=parseFloat(Object(re.J)(M.joinTokens.pooled[1].volume).div("1e"+k.decimals).toFixed(j.precisionForPrice)):t.coinA.tradeValue=parseFloat(Object(re.J)(M.joinTokens.pooled[0].volume).div("1e"+h.decimals).toFixed(j.precisionForPrice)),U({coinA:t.coinA,coinB:t.coinB,slippage:r}),xe({ammInfo:O,request:M});case 26:case"end":return e.stop()}}),e)})));return function(t,a,n,c){return e.apply(this,arguments)}}(),d.jb.wait),[null===I||void 0===I?void 0:I.accAddress,A]),we=O.a.useCallback(function(){var e=Object(f.a)(m.a.mark((function e(t,a){return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ge(t,a,se,te);case 2:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),[se,ge,te]),Ae=O.a.useCallback(function(){var e=Object(f.a)(m.a.mark((function e(t){var a,n,c,r,i,s,l,d,b,p;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(Le(!0),oe.ammpoolAPI&&oe.userAPI&&ke&&(null===I||void 0===I||null===(a=I.eddsaKey)||void 0===a?void 0:a.sk)){e.next=7;break}return Ga(" onAmmJoin ammpoolAPI:",oe.ammpoolAPI,"joinRequest:",ke),h(x("labelJoinAmmFailed")),u(!0),Le(!1),e.abrupt("return");case 7:return n=ke.ammInfo,c=ke.request,r={chainId:Cn.getState().system.chainId,ammName:n.__rawConfig__.name,poolAddress:n.address,eddsaKey:I.eddsaKey.sk},e.prev=9,s={accountId:I.accountId,sellTokenId:c.joinTokens.pooled[0].tokenId},e.next=13,oe.userAPI.getNextStorageId(s,I.apiKey);case 13:return l=e.sent,d={accountId:I.accountId,sellTokenId:c.joinTokens.pooled[1].tokenId},e.next=17,oe.userAPI.getNextStorageId(d,I.apiKey);case 17:return b=e.sent,c.storageIds=[l.offchainId,b.offchainId],U(Object(o.a)(Object(o.a)({},L),{coinA:Object(o.a)(Object(o.a)({},L.coinA),{},{tradeValue:0}),coinB:Object(o.a)(Object(o.a)({},L.coinB),{},{tradeValue:0})})),e.next=22,oe.ammpoolAPI.joinAmmPool(c,r,I.apiKey);case 22:if(p=e.sent,Ga("join ammpool response:",p),!(null===(i=p.joinAmmPoolResult)||void 0===i?void 0:i.resultInfo)){e.next=28;break}h(x("labelJoinAmmFailed")),e.next=31;break;case 28:return h(x("labelJoinAmmSuccess")),e.next=31,k();case 31:e.next=37;break;case 33:e.prev=33,e.t0=e.catch(9),Object(re.s)(e.t0),h(x("labelJoinAmmFailed"));case 37:return e.prev=37,u(!0),Le(!1),e.finish(37);case 41:t.__cache__&&Hn(t.__cache__);case 42:case"end":return e.stop()}}),e,null,[[9,33,37,41]])})));return function(t){return e.apply(this,arguments)}}(),[ke,L,I,k,x]),ye=Object.assign(Vn(Wn),Object(v.a)({},d.cb.ACTIVATED,[Ae])),Se=O.a.useCallback((function(e){Fn(ye,[e])}),[ye]),Ie=Object(j.useState)(),Ne=Object(be.a)(Ie,2),Ce=Ne[0],Te=Ne[1],Me=O.a.useCallback(Object(za.debounce)(function(){var e=Object(f.a)(m.a.mark((function e(t,a,n,c){var r,o,i,s,u,l,d,b,p,f,v,j,O,h,k,x,g,w,y,S,N,C,T;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r="coinA"===a,A&&t.coinA.belong&&t.coinB.belong&&c&&n&&(null===I||void 0===I?void 0:I.accAddress)&&(!r||void 0!==t.coinA.tradeValue)&&(r||void 0!==t.coinB.tradeValue)){e.next=3;break}return e.abrupt("return");case 3:if(Ga("handleExitInDebounce",t,a),o=t.slippage,i=re.J(o).div(100).toString(),s=Cn.getState().tokenMap,u=s.idIndex,l=s.marketArray,d=s.marketMap,b=Cn.getState().amm.ammMap.ammMap,p=Object(re.z)(l,t.coinA.belong,t.coinB.belong),f=p.market,v=p.amm,f&&v&&d){e.next=11;break}return e.abrupt("return");case 11:j=d[f],O=b[v],h=A[t.coinA.belong],k=A[t.coinB.belong],x=c.pooled[0],g=c.pooled[1],w=r?t.coinA.tradeValue:t.coinB.tradeValue,y=r?h.decimals:k.decimals,S=re.J(w).times("1e"+y).toFixed(0,0),(N=re.p(S,r,x,g)).output,N.ratio,C=Object(re.G)(w.toString(),r,i,I.accAddress,n,b[v],c,A,u,0),T=C.request,r?t.coinB.tradeValue=parseFloat(Object(re.J)(T.exitTokens.unPooled[1].volume).div("1e"+k.decimals).toFixed(j.precisionForPrice)):t.coinA.tradeValue=parseFloat(Object(re.J)(T.exitTokens.unPooled[0].volume).div("1e"+h.decimals).toFixed(j.precisionForPrice)),W({coinA:t.coinA,coinB:t.coinB,slippage:o}),Te({rawVal:w,ammInfo:O,request:T});case 25:case"end":return e.stop()}}),e)})));return function(t,a,n,c){return e.apply(this,arguments)}}(),d.jb.wait),[null===I||void 0===I?void 0:I.accAddress,A]),Pe=O.a.useCallback(function(){var e=Object(f.a)(m.a.mark((function e(t,a){return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Me(t,a,pe,te);case 2:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),[pe,te,Me]),De=Object(j.useState)(!1),_e=Object(be.a)(De,2),Re=_e[0],Le=_e[1],Ue=Object(j.useState)(!1),Be=Object(be.a)(Ue,2),Fe=Be[0],Ke=Be[1],We=O.a.useCallback(function(){var e=Object(f.a)(m.a.mark((function e(t){var a,n,c,r,i,s,l,d;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(Ke(!0),Ga("removeAmmCalculator props:",t),oe.ammpoolAPI&&oe.userAPI&&Ce&&(null===I||void 0===I||null===(a=I.eddsaKey)||void 0===a?void 0:a.sk)){e.next=8;break}return Ga(" onExit ammpoolAPI:",oe.ammpoolAPI,"exitRequest:",Ce),h(x("labelExitAmmFailed")),u(!0),Ke(!1),e.abrupt("return");case 8:return n=Ce.ammInfo,c=Ce.request,r={chainId:Cn.getState().system.chainId,ammName:n.__rawConfig__.name,poolAddress:n.address,eddsaKey:I.eddsaKey.sk},i={accountId:I.accountId,sellTokenId:c.exitTokens.burned.tokenId},e.next=13,oe.userAPI.getNextStorageId(i,I.apiKey);case 13:return s=e.sent,c.storageId=s.offchainId,e.prev=15,Ga("exit req:",c),W(Object(o.a)(Object(o.a)({},K),{coinA:Object(o.a)(Object(o.a)({},K.coinA),{},{tradeValue:0}),coinB:Object(o.a)(Object(o.a)({},K.coinB),{},{tradeValue:0})})),e.next=20,oe.ammpoolAPI.exitAmmPool(c,r,I.apiKey);case 20:if(d=e.sent,Ga("exit ammpool response:",d),!(null===(l=d.exitAmmPoolResult)||void 0===l?void 0:l.resultInfo)){e.next=26;break}h(x("labelExitAmmFailed")),e.next=29;break;case 26:return h(x("labelExitAmmSuccess")),e.next=29,k();case 29:e.next=35;break;case 31:e.prev=31,e.t0=e.catch(15),Object(re.s)(e.t0),h(x("labelExitAmmFailed"));case 35:return e.prev=35,u(!0),Ke(!1),e.finish(35);case 39:case"end":return e.stop()}}),e,null,[[15,31,35,39]])})));return function(t){return e.apply(this,arguments)}}(),[Ce,K,k,I,x]),He=Object.assign(Vn(Wn),Object(v.a)({},d.cb.ACTIVATED,[We])),Ve=O.a.useCallback((function(e){Ga("onAmmRemoveClick, exitRequest:",Ce," ammExitData:",K),Fn(He,[e])}),[Ce,K,He]),Je=Za().status;return _c((function(){if(Je===d.L.UNSET&&a&&c){var e=cc().walletMap;Z(a,e)}}),[Je,a,c,null===I||void 0===I?void 0:I.accAddress]),{ammAlertText:p,ammToastOpen:s,setAmmToastOpen:u,ammCalcData:E,ammJoinData:L,ammExitData:K,isJoinLoading:Re,isExitLoading:Fe,handleJoinAmmPoolEvent:we,handleExitAmmPoolEvent:Pe,onAmmRemoveClick:Ve,onAmmAddClick:Se,ammDepositBtnI18nKey:J,ammWithdrawBtnI18nKey:q}}({pair:t,snapShotData:n,ammType:a||M.e.Deposit}),i=r.ammAlertText,s=r.ammToastOpen,u=r.setAmmToastOpen,b=r.ammCalcData,p=r.ammJoinData,h=r.ammExitData,k=r.handleJoinAmmPoolEvent,x=r.handleExitAmmPoolEvent,g=r.onAmmRemoveClick,w=r.onAmmAddClick,A=r.isJoinLoading,y=r.isExitLoading,S=r.ammDepositBtnI18nKey,I=r.ammWithdrawBtnI18nKey,N=O.a.useCallback((function(){return!(n&&n.tickerData&&n.ammPoolsBalance||void 0!==S||void 0!==I)||(!(!A&&!y)||void 0)}),[n,I,I,A,y]);return Object(dc.jsxs)(dc.Fragment,{children:[Object(dc.jsx)(M.jb,{alertText:i,open:s,autoHideDuration:Xa,setOpen:u}),t?Object(dc.jsx)(M.d,Object(o.a)(Object(o.a)({},Object(o.a)({},c)),{},{ammDepositData:p,ammWithdrawData:h,ammCalcData:b,handleAmmAddChangeEvent:k,handleAmmRemoveChangeEvent:x,onAmmRemoveClick:g,onAmmAddClick:w,tabSelected:a||M.e.Deposit,ammDepositBtnI18nKey:S,ammWithdrawBtnI18nKey:I,ammDepositBtnStatus:N()?M.nb.LOADING:M.nb.AVAILABLE,ammWithdrawBtnStatus:N()?M.nb.LOADING:M.nb.AVAILABLE})):Object(dc.jsx)(vc.a,{width:"var(--swap-box-width)"})]})},Xr=function(e){var t=e.ammMap,a=e.coinMap,n=e.ammActivityMap,c=e.ammKey;if(t&&a){var r=Vn(t[c]),o=n[c];return r&&r.coinA&&(r.myCoinA=a[r.coinA],r.myCoinB=a[r.coinB],r.activity=o||{}),r}},Zr=["t","ammActivityMap"],$r=Object(Ac.a)(vc.a)(Ur||(Ur=Object(i.a)(["\n  flex: 1;\n  background: var(--color-box);\n  border-radius: ","px;\n  padding: ","px;\n  height: 120px;\n  // min-width: 160px;\n  max-width: 210px;\n  // & .MuiAvatar-root {\n    //     height: ",";\n    //     width: ",";\n  // }\n"])),(function(e){return e.theme.unit}),(function(e){return 2*e.theme.unit}),(function(e){return e.theme.fontDefault.h4}),(function(e){return e.theme.fontDefault.h4})),eo=Object(Ac.a)(vc.a)(Br||(Br=Object(i.a)(["\n  background: var(--color-box);\n  border-radius: ","px;\n  padding: ","px;\n  width: var(--swap-box-width);\n  box-sizing: border-box;\n  //height: 120px;\n  //min-width: 160px;\n  // & .MuiAvatar-root {\n    //   height: ",";\n    //   width: ",";\n  // }\n"])),(function(e){return e.theme.unit}),(function(e){return 2*e.theme.unit}),(function(e){return e.theme.fontDefault.h4}),(function(e){return e.theme.fontDefault.h4})),to=Object(lc.a)("common")((function(e){var t,a,n,c,r,i,s,b,p,v,j,h,k,x,g,w,A,y,S=e.t,I=e.ammActivityMap,N=Object(l.a)(e,Zr),C=Object(M.Rb)().currency,T=function(e){var t=Object(u.h)("/liquidity/pools/coinPair/:symbol"),a=Ee(),n=a.coinMap,c=a.tokenMap,r=a.marketArray,i=(Fa().faitPrices,Q()),s=i.ammMap,l=i.getAmmMap,b=i.status,p=en(),v=p.userRewardsMap,j=p.status,h=Za(),k=h.walletLayer2,x=h.status,g=O.a.useState(void 0),w=Object(be.a)(g,2),A=w[0],y=w[1],S=O.a.useState([]),I=Object(be.a)(S,2),N=I[0],C=(I[1],O.a.useState([])),T=Object(be.a)(C,2),M=T[0],E=T[1],P=O.a.useState(void 0),D=Object(be.a)(P,2),_=D[0],R=D[1],L=O.a.useState(void 0),U=Object(be.a)(L,2),B=U[0],F=U[1],K=O.a.useState({feeA:0,feeB:0,feeDollar:0,feeYuan:0,reward:0,rewardToken:void 0,balanceA:0,balanceB:0,balanceYuan:0,balanceDollar:0}),W=Object(be.a)(K,2),H=W[0],V=W[1],J=O.a.useState({myCoinA:void 0,myCoinB:void 0,activity:void 0,totalRewards:void 0,amountDollar:void 0,amountYuan:void 0,totalLPToken:void 0,totalA:void 0,totalB:void 0,rewardToken:void 0,rewardValue:void 0,feeA:void 0,feeB:void 0,isNew:void 0,isActivity:void 0,APY:void 0}),G=Object(be.a)(J,2),Y=G[0],z=G[1],q=O.a.useState(void 0),X=Object(be.a)(q,2),Z=X[0],$=X[1],ee=O.a.useState({coinAInfo:void 0,coinBInfo:void 0}),te=Object(be.a)(ee,2),ae=te[0],ne=te[1],ce=O.a.useState([]),ie=Object(be.a)(ce,2),se=ie[0],ue=ie[1],le=O.a.useCallback((function(e){var t,a=cc().walletMap;return y(a),a&&(null===(t=ic())||void 0===t||t.then((function(t){var a=sc(e,t);E(a||[])}))),a}),[cc,ic,sc,r,ae]),de=O.a.useCallback(Object(f.a)(m.a.mark((function e(){var t,a,n,c,r;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(oe.exchangeAPI&&Y.coinA&&Y.coinB)){e.next=8;break}return t=Y.myCoinA,a=Y.myCoinB,n="".concat(null===t||void 0===t?void 0:t.name,"-").concat(null===a||void 0===a?void 0:a.name),e.next=5,oe.exchangeAPI.getMixCandlestick({market:n,interval:re.j.d1,limit:30});case 5:c=e.sent,r=c.candlesticks.map((function(e){return Object(o.a)(Object(o.a)({},e),{},{timeStamp:e.timestamp,date:Pc()(e.timestamp).format("MMM DD")})})).sort((function(e,t){return e.timeStamp-t.timeStamp})),ue(r);case 8:case"end":return e.stop()}}),e)}))),[Y]);return O.a.useEffect((function(){de()}),[de]),O.a.useEffect((function(){var a,i=null!==(a=null===t||void 0===t?void 0:t.params.symbol)&&void 0!==a?a:void 0,u={},d=i.match(/(\w+)-(\w+)/i),b=Object(be.a)(d,3),p=b[1],m=b[2],f=Object(re.z)(r,p,m),v=f.amm,j=f.market,O=Xr({ammMap:s,coinMap:n,ammActivityMap:e,ammKey:v});if(z(O||{}),n&&ne({coinAInfo:n[p],coinBInfo:n[m]}),k&&le(j),v&&j&&s){l();var h=[uc({coinKey:j,ammKey:v,ammMap:s})];Promise.all([].concat(h)).then((function(e){var t=Object(be.a)(e,1)[0],a=t.ammPoolsBalance,n=t.tickMap;if(c){var r={tickerData:n[j],ammPoolsBalance:a};u=ac(n[j]?n[j]:{}),$(u),z(Object(o.a)({},O)),F(r)}})).catch((function(e){throw console.log(e),Error}))}}),[]),O.a.useEffect((function(){var e,t,a=Object(re.z)(r,null===(e=ae.coinAInfo)||void 0===e?void 0:e.simpleName,null===(t=ae.coinBInfo)||void 0===t?void 0:t.simpleName).market;if(a&&B&&B.ammPoolsBalance&&x===d.L.UNSET){var n=le(a),c=ec(a,n,_,B);V(c)}}),[x]),O.a.useEffect((function(){var e,t,a=Object(re.z)(r,null===(e=ae.coinAInfo)||void 0===e?void 0:e.simpleName,null===(t=ae.coinBInfo)||void 0===t?void 0:t.simpleName).market;if(j===d.L.UNSET&&a){R(v);var n=ec(a,A,_,B);V(n)}}),[j]),O.a.useEffect((function(){var t,a;if(b===d.L.UNSET&&s&&(null===(t=ae.coinAInfo)||void 0===t?void 0:t.simpleName)&&(null===(a=ae.coinBInfo)||void 0===a?void 0:a.simpleName)){var c=Xr({ammMap:s,coinMap:n,ammActivityMap:e,ammKey:"AMM-"+ae.coinAInfo.simpleName+ae.coinBInfo.simpleName});z(Object(o.a)(Object(o.a)(Object(o.a)({},Y),c),{},{tradeFloat:Y.tradeFloat}))}}),[b]),{walletMap:A,myAmm:H,coinPairInfo:Y,snapShotData:B,pair:ae,tradeFloat:Z,ammMarketArray:N,myAmmMarketArray:M,pairHistory:se}}({ammActivityMap:I}),E=T.tradeFloat,P=T.snapShotData,D=T.pair,_=T.coinPairInfo,R=T.walletMap,L=T.ammMarketArray,U=T.myAmmMarketArray,B=T.myAmm,F=T.pairHistory,K=O.a.useState(0),W=Object(be.a)(K,2),H=W[0],V=(W[1],O.a.useState((null===N||void 0===N?void 0:N.page)?N.page:1)),J=Object(be.a)(V,2),G=J[0],Y=J[1],z=O.a.useCallback((function(e){Y(e)}),[]),q=Object(M.Rb)().coinJson,X=q[null===(t=_.myCoinA)||void 0===t?void 0:t.simpleName],Z=q[null===(a=_.myCoinB)||void 0===a?void 0:a.simpleName];return Object(dc.jsxs)(dc.Fragment,{children:[Object(dc.jsxs)(fc.a,{container:!0,children:[Object(dc.jsxs)(fc.a,{item:!0,xs:7,children:[Object(dc.jsxs)(Gr.a,{"aria-label":"breadcrumb",children:[Object(dc.jsx)(Yr.a,{color:"textSecondary",href:"/#/liquidity/pools",children:S("labelAmmList")}),Object(dc.jsxs)(rr.a,{color:"textSecondary",display:"flex",alignItems:"center",justifyContent:"center",children:[null===(n=D.coinAInfo)||void 0===n?void 0:n.simpleName,"-",null===(c=D.coinBInfo)||void 0===c?void 0:c.simpleName]})]}),Object(dc.jsx)(fc.a,{item:!0,xs:12,marginTop:2,children:Object(dc.jsx)(M.pb,Object(o.a)({},Object(o.a)(Object(o.a)(Object(o.a)({},N),{},{t:S},D),{},{tradeFloat:E,isNew:!1})))})]}),Object(dc.jsx)(fc.a,{item:!0,xs:4,alignItems:"center",justifyContent:"flex-end",display:"flex",children:"undefined"===typeof _.isActivity?"":Object(dc.jsxs)(eo,{paddingY:3,paddingX:2.5,display:"flex",flexDirection:"column",children:[Object(dc.jsxs)(vc.a,{display:"flex",flexDirection:"row",justifyContent:"space-between",children:[Object(dc.jsxs)(rr.a,{display:"flex",flexDirection:"column",component:"div",children:[Object(dc.jsx)(rr.a,{variant:"body2",component:"h5",color:"textSecondary",children:S("labelReward")}),Object(dc.jsx)(rr.a,{variant:"body1",component:"span",color:"textPrimary",children:"undefined"===typeof _.isActivity?d.t:Object(dc.jsxs)(dc.Fragment,{children:[Object(dc.jsxs)(rr.a,{component:"span",children:[_.activity?Object(d.hb)(_.activity.totalRewards):d.t," "]}),Object(dc.jsx)(rr.a,{component:"span",children:null===(r=_.activity)||void 0===r||null===(i=r.rewardToken)||void 0===i?void 0:i.simpleName})]})})]}),Object(dc.jsxs)(rr.a,{display:"flex",flexDirection:"column",alignItems:"flex-end",component:"div",children:[Object(dc.jsx)(rr.a,{variant:"body2",component:"h5",color:"textSecondary",children:S("labelMyReward")}),Object(dc.jsx)(rr.a,{variant:"body1",component:"span",color:"textPrimary",children:"undefined"===typeof B.reward?d.t:Object(dc.jsxs)(dc.Fragment,{children:[Object(dc.jsxs)(rr.a,{component:"span",children:[" ",Object(d.hb)(B.reward)," "]}),Object(dc.jsxs)(rr.a,{component:"span",children:[" ",null===(s=_.activity)||void 0===s||null===(b=s.rewardToken)||void 0===b?void 0:b.simpleName]})]})})]})]}),Object(dc.jsx)(rr.a,{alignSelf:"flex-start",variant:"body2",color:"textSecondary",component:"span",marginTop:1,children:"undefined"===typeof _.isActivity?S("labelNoActiveEvent"):Object(dc.jsxs)(dc.Fragment,{children:[S("labelDate")," :",Object(dc.jsxs)(dc.Fragment,{children:[" "," "+Pc()(null===(p=_.activity)||void 0===p?void 0:p.duration.from).format("L")+" - "+Pc()(null===(v=_.activity)||void 0===v?void 0:v.duration.to).format("L")]})]})})]})})]}),Object(dc.jsxs)(vc.a,{flex:1,display:"flex",alignItems:"stretch",flexDirection:"row",marginTop:3,children:[Object(dc.jsxs)(vc.a,{flex:1,display:"flex",flexDirection:"column",marginRight:3,justifyContent:"space-between",children:[Object(dc.jsx)(vc.a,{flex:1,width:"101%",children:Object(dc.jsx)(M.Y,{type:M.p.Trend,data:F,extraInfo:null===(j=D.coinBInfo)||void 0===j?void 0:j.simpleName,showXAxis:!0})}),Object(dc.jsxs)(vc.a,{display:"flex",flexDirection:"row",justifyContent:"space-between",children:[Object(dc.jsxs)($r,{paddingX:2,display:"flex",flexDirection:"column",children:[Object(dc.jsx)(rr.a,{component:"p",color:"textSecondary",display:"flex",marginBottom:1.5,children:S("labelAmmTotalToken")}),Object(dc.jsxs)(rr.a,{component:"span",display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"center",style:{textTransform:"capitalize"},color:"textPrimary",children:[Object(dc.jsx)(vc.a,{component:"span",className:"logo-icon",height:"var(--list-menu-coin-size)",width:"var(--list-menu-coin-size)",alignItems:"center",justifyContent:"center",children:X?Object(dc.jsx)(d.d,{imgx:X.x,imgy:X.y,imgheight:X.height,imgwidth:X.width,size:24,variant:"circular",alt:null===_||void 0===_||null===(h=_.myCoinA)||void 0===h?void 0:h.simpleName,src:'data:image/svg+xml;utf8,<svg width="36" height="36" viewBox="0 0 36 36" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M0 0H36V36H0V0Z"/></svg>'}):Object(dc.jsx)(zr.a,{variant:"circular",alt:null===_||void 0===_||null===(k=_.myCoinA)||void 0===k?void 0:k.simpleName,style:{height:"var(--list-menu-coin-size))",width:"var(--list-menu-coin-size)"},src:"static/images/icon-default.png"})}),Object(dc.jsxs)(rr.a,{justifyContent:"center",display:"flex",children:[Object(dc.jsx)(rr.a,{component:"span",alignSelf:"right",height:24,lineHeight:"24px",children:Object(d.hb)(_.totalA,6)}),Object(dc.jsx)(rr.a,{component:"span",marginLeft:1,alignSelf:"right",height:24,lineHeight:"24px",children:null===(x=_.myCoinA)||void 0===x?void 0:x.simpleName})]})]}),Object(dc.jsxs)(rr.a,{component:"span",display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"center",marginTop:1,style:{textTransform:"capitalize"},children:[Object(dc.jsx)(vc.a,{component:"span",className:"logo-icon",height:"var(--list-menu-coin-size)",width:"var(--list-menu-coin-size)",alignItems:"center",justifyContent:"center",children:Z?Object(dc.jsx)(d.d,{imgx:Z.x,imgy:Z.y,imgheight:Z.height,imgwidth:Z.width,size:24,variant:"circular",alt:null===_||void 0===_||null===(g=_.myCoinB)||void 0===g?void 0:g.simpleName,src:'data:image/svg+xml;utf8,<svg width="36" height="36" viewBox="0 0 36 36" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M0 0H36V36H0V0Z"/></svg>'}):Object(dc.jsx)(zr.a,{variant:"circular",alt:null===_||void 0===_||null===(w=_.myCoinB)||void 0===w?void 0:w.simpleName,style:{height:"var(--list-menu-coin-size)",width:"var(--list-menu-coin-size)"},src:"static/images/icon-default.png"})}),Object(dc.jsxs)(rr.a,{justifyContent:"center",display:"flex",children:[Object(dc.jsx)(rr.a,{component:"span",alignSelf:"right",height:24,lineHeight:"24px",children:Object(d.hb)(_.totalB,6)}),Object(dc.jsx)(rr.a,{component:"span",marginLeft:1,alignSelf:"right",height:24,lineHeight:"24px",children:null===(A=_.myCoinB)||void 0===A?void 0:A.simpleName})]})]})]}),Object(dc.jsxs)($r,{paddingX:2,display:"flex",flexDirection:"column",children:[Object(dc.jsx)(rr.a,{component:"p",color:"textSecondary",display:"flex",children:S("label24Volume")}),Object(dc.jsx)(rr.a,{variant:"h5",marginTop:4,component:"span",children:C===d.n.dollar?d.H.Dollar+Object(d.hb)(E&&E.priceDollar?E.priceDollar:0,2):d.H.Yuan+Object(d.hb)(E&&E.priceYuan?E.priceYuan:0,2)})]}),Object(dc.jsxs)($r,{paddingX:2,display:"flex",flexDirection:"column",children:[Object(dc.jsx)(rr.a,{component:"p",color:"textSecondary",display:"flex",children:S("labelTVL")}),Object(dc.jsxs)(rr.a,{variant:"h5",marginTop:4,component:"span",children:[" ","undefined"===typeof _.amountDollar?d.t:C===d.n.dollar?d.H.Dollar+Object(d.hb)(_.amountDollar,2):d.H.Yuan+Object(d.hb)(_.amountYuan?_.amountYuan:0,2)]})]}),Object(dc.jsxs)($r,{paddingX:2,display:"flex",flexDirection:"column",children:[Object(dc.jsx)(rr.a,{component:"p",color:"textSecondary",display:"flex",children:S("labelAPY")}),Object(dc.jsxs)(rr.a,{variant:"h5",marginTop:4,component:"span",children:[" ",_.APY?_.APY:d.t,"%"]})]})]})]}),Object(dc.jsx)(vc.a,{display:"flex",children:Object(dc.jsx)(Qr,{pair:D,walletMap:R,snapShotData:P})})]}),Object(dc.jsx)(fc.a,{container:!0,marginY:3,children:Object(dc.jsxs)(fc.a,{item:!0,xs:12,children:[Object(dc.jsx)(jc.a,{value:H,"aria-label":"tabs switch",children:Object(dc.jsx)(Oc.a,Object(o.a)({label:S("labelMe")},(y=1,{id:"simple-tab-".concat(y),"aria-controls":"tabpanel-".concat(y)})))}),Object(dc.jsx)(yc,{style:{marginTop:"".concat(2*d.sb,"px")},children:0===H?Object(dc.jsx)(M.f,{rawData:L,handlePageChange:z,page:G}):Object(dc.jsx)(M.f,{rawData:U,handlePageChange:z,page:G})})]})})]})})),ao=function(){var e=ae(),t=e.ammActivityMap,a=e.status,n=T(),c=(n.account,n.status,Q()),r=c.ammMap,o=c.getAmmMap,i=O.a.useState(t),s=Object(be.a)(i,2),u=s[0],l=s[1];return O.a.useEffect((function(){r&&0!==Object.keys(r).length||o()}),[]),O.a.useEffect((function(){a===d.L.UNSET&&l(t)}),[a]),{ammActivityMap:u}},no=Object(Ac.a)(vc.a)(Fr||(Fr=Object(i.a)(["\n    display: flex;\n    flex-direction: column;\n    justify-content: stretch;\n    align-items: stretch;\n    flex: 1;\n"]))),co=(d.rb,Object(lc.a)(["layout","common"],{withRef:!0})(M.ab),Object(lc.a)("common",{withRef:!0})((function(e){var t,a,n=e.t,c=ao().ammActivityMap,r=Object(u.h)(["/liquidity/:item",":next/"]),o=null!==(t=null===r||void 0===r?void 0:r.params.item)&&void 0!==t?t:"pools",i=Object(u.h)(["/liquidity/:item/:next/:symbol"]),s=void 0;return i&&(null===i||void 0===i||null===(a=i.params)||void 0===a?void 0:a.next)&&"pools"===i.params.item&&(s=i.params.symbol?i.params.symbol:"LRC-ETH"),Object(dc.jsxs)(dc.Fragment,{children:[s&&Object(dc.jsx)(vc.a,{display:"flex",flexDirection:"column",flex:1,alignSelf:"flex-start",children:Object(dc.jsx)(to,{ammActivityMap:c})}),!s&&Object(dc.jsxs)(no,{children:[Object(dc.jsx)(rr.a,{variant:"h2",component:"div",fontFamily:"Roboto",marginTop:2,marginBottom:3,children:n("labelLiquidityPageTitle")}),Object(dc.jsx)(vc.a,{minHeight:420,display:"flex",alignItems:"stretch",justifyContent:"stretch",marginTop:0,flex:1,marginBottom:3,children:"pools"===o&&!s&&Object(dc.jsx)(Jr,{ammActivityMap:c})})]})]})}))),ro=a(1658),oo=["ammProps","t"],io=Object(Ac.a)(vc.a)(Kr||(Kr=Object(i.a)(["\n    display: flex;\n    flex-direction: column;\n    flex: 1;\n"]))),so=O.a.memo(O.a.forwardRef((function(e,t){var a="".concat(e.coinAInfo.name,"-").concat(e.coinBInfo.name);return e?Object(dc.jsx)(M.c,Object(o.a)(Object(o.a)({ref:t},e),{},{handleClick:function(){return e.handleClick(a)}})):Object(dc.jsx)(dc.Fragment,{})}))),uo=function(e){var t=e.ammActivityViewMap,a=Object(u.f)(),n=O.a.useCallback((function(e){a&&a.push("/liquidity/pools/coinPair/".concat(e))}),[a]);return Object(dc.jsxs)(dc.Fragment,{children:[t.length?t.map((function(e,t){return Object(dc.jsx)(fc.a,{item:!0,xs:12,sm:6,lg:4,children:Object(dc.jsx)(so,Object(o.a)({handleClick:n},e))},t)})):Object(dc.jsxs)(vc.a,{flex:1,display:"flex",alignItems:"center",justifyContent:"center",flexDirection:"column",children:[Object(dc.jsx)(M.v,{height:"calc(100% - 35px)",marginTop:10,display:"flex",flexWrap:"nowrap",alignItems:"center",justifyContent:"center",flexDirection:"column",message:function(){return Object(dc.jsx)(ro.a,{i18nKey:"labelEmptyDefault",children:"Content is Empty"})}})," "]}),"   "]})},lo=Object(lc.a)("common")((function(e){e.ammProps;var t=e.t,a=(Object(l.a)(e,oo),function(e){var t=e.ammActivityMap,a=en(),n=O.a.useState([]),c=Object(be.a)(n,2),r=c[0],o=c[1],i=O.a.useState([]),s=Object(be.a)(i,2),u=s[0],l=s[1];return O.a.useEffect((function(){t&&Object.keys(t).length>0&&(o(Xn({ammActivityMap:t,type:"AMM_MINING",ammPoolActivityStatus:[re.a.NotStarted,re.a.InProgress]},a.userRewardsMap)),l(Xn({ammActivityMap:t,type:"AMM_MINING",ammPoolActivityStatus:[re.a.EndOfGame]},a.userRewardsMap)))}),[t]),O.a.useEffect((function(){"ERROR"===a.status?a.statusUnset():"DONE"===a.status&&(a.statusUnset(),o(Xn({ammActivityMap:t,type:"AMM_MINING",ammPoolActivityStatus:[re.a.NotStarted,re.a.InProgress]},a.userRewardsMap)),l(Xn({ammActivityMap:t,type:"AMM_MINING",ammPoolActivityStatus:[re.a.EndOfGame]},a.userRewardsMap)))}),[a.status]),{ammActivityViewMap:r,ammActivityPastViewMap:u}}({ammActivityMap:ao().ammActivityMap})),n=a.ammActivityViewMap,c=a.ammActivityPastViewMap,r=O.a.useState(0),o=Object(be.a)(r,2),i=(o[0],o[1],[].concat(Object(E.a)(n),Object(E.a)(c)));return Object(dc.jsxs)(io,{children:[Object(dc.jsx)(rr.a,{variant:"h2",component:"div",fontFamily:"Roboto",marginTop:2,marginBottom:3,children:t("labelMiningPageTitle")}),Object(dc.jsx)(fc.a,{container:!0,spacing:5,children:Object(dc.jsx)(uo,{ammActivityViewMap:i})})]})})),bo=["onClose","open","t"],po=Object(lc.a)("common")((function(e){var t=e.onClose,a=(e.open,e.t),n=Object(l.a)(e,bo),c=T(),r=c.account,i=c.updateAccount,s=c.setShouldShow,u=c.resetAccount,b=(c.statusUnset,c.status),p=Fa(),h=p.updateSystem,k=p.chainId,x=(p.exchangeInfo,Object(M.Qb)()),g=x.modals.isShowConnect,w=x.setShowConnect,A=x.setShowAccount,y=O.a.useState(""),S=Object(be.a)(y,2),I=S[0],N=S[1],C=O.a.useState(!1),E=Object(be.a)(C,2),P=E[0],D=E[1],_=O.a.useCallback(Object(f.a)(m.a.mark((function e(){var t,a;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Sa.a.MetaMask();case 2:if(i({connectName:d.l.MetaMask}),!Sa.a.usedProvide){e.next=11;break}return e.t0=Number,e.next=7,null===(t=Sa.a.usedWeb3)||void 0===t?void 0:t.eth.getChainId();case 7:return e.t1=e.sent,(a=(0,e.t0)(e.t1))!==k&&h({chainId:a&&a===re.e.GOERLI?a:re.e.MAINNET}),e.abrupt("return");case 11:case"end":return e.stop()}}),e)}))),[]),R=O.a.useCallback(Object(f.a)(m.a.mark((function e(){var t,a;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Sa.a.WalletConnect();case 2:if(i({connectName:d.l.WalletConnect}),!Sa.a.usedProvide){e.next=11;break}return e.t0=Number,e.next=7,null===(t=Sa.a.usedWeb3)||void 0===t?void 0:t.eth.getChainId();case 7:return e.t1=e.sent,(a=(0,e.t0)(e.t1))!==k&&h({chainId:a&&a===re.e.GOERLI?a:re.e.MAINNET}),e.abrupt("return");case 11:case"end":return e.stop()}}),e)}))),[]),L=O.a.useState(void 0),U=Object(be.a)(L,2),B=U[0],F=U[1];Object(j.useEffect)((function(){!0===P&&-1!==[d.L.UNSET].findIndex((function(e){return e===b}))&&(Ga("clear cache connect done"),D(!1),void 0!==B&&B.callback())}),[b,P]);var K=[Object(o.a)(Object(o.a)({},d.db[0]),{},{handleSelect:O.a.useCallback(Object(f.a)(m.a.mark((function e(){return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r.connectName===d.db[0].key?w({isShow:!1}):(Sa.c.sendDisconnect("","should new provider"),w({isShow:!0,step:M.zb.MetaMaskProcessing}),F({callback:_}),D(!0));case 1:case"end":return e.stop()}}),e)}))),[r])}),Object(o.a)(Object(o.a)({},d.db[1]),{},{handleSelect:O.a.useCallback(Object(f.a)(m.a.mark((function e(){return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:Sa.c.sendDisconnect("","should new provider"),w({isShow:!0,step:M.zb.WalletConnectProcessing}),F({callback:R}),D(!0);case 4:case"end":return e.stop()}}),e)}))),[r])})],W=O.a.useCallback((function(e){e.type;var t=e.opts.qrCodeUrl;t&&(N(t),w({isShow:!0,step:M.zb.WalletConnectQRCode}))}),[]),H=Object(j.useState)(!1),V=Object(be.a)(H,2),J=V[0],G=V[1];Object(Sa.b)({handleProcessing:W});var Y=O.a.useMemo((function(){return["UN_CONNECT","ERROR_NETWORK"].includes(r.readyState)?void 0:function(){switch(w({isShow:!1}),r.readyState){case"ACTIVATED":case"LOCKED":A({isShow:!0,step:M.a.HadAccount});break;case"DEPOSITING":A({isShow:!0,step:M.a.Depositing});break;case"NO_ACCOUNT":A({isShow:!0,step:M.a.NoAccount})}}}),[r,A]),z=O.a.useMemo((function(){var e;return Object.values((e={},Object(v.a)(e,M.zb.Provider,{view:Object(dc.jsx)(M.T,Object(o.a)({gatewayList:K,providerName:r.connectName},Object(o.a)({t:a},n))),onBack:Y}),Object(v.a)(e,M.zb.MetaMaskProcessing,{view:Object(dc.jsx)(M.H,Object(o.a)({},Object(o.a)({t:a},n)))}),Object(v.a)(e,M.zb.WalletConnectProcessing,{view:Object(dc.jsx)(M.xb,Object(o.a)({},Object(o.a)({t:a},n)))}),Object(v.a)(e,M.zb.WalletConnectQRCode,{view:Object(dc.jsx)(M.yb,Object(o.a)({onCopy:function(){Jn(I),G(!0)},url:I},Object(o.a)({t:a},n))),onBack:function(){w({isShow:!0,step:M.zb.Provider})}}),Object(v.a)(e,M.zb.SuccessConnect,{view:Object(dc.jsx)(M.bb,Object(o.a)({onClose:function(e){s(!1),t(e)},providerName:r.connectName},Object(o.a)({t:a},n)))}),Object(v.a)(e,M.zb.FailedConnect,{view:Object(dc.jsx)(M.w,Object(o.a)(Object(o.a)({},Object(o.a)({t:a},n)),{},{onRetry:u})),onBack:function(){w({isShow:!0,step:M.zb.Provider})}}),e))}),[I,r,a,n,t]);return Object(dc.jsxs)(dc.Fragment,{children:[Object(dc.jsx)(M.N,{open:g.isShow,onClose:function(e){s(!1),t(e)},panelList:z,onBack:z[g.step].onBack,step:g.step}),Object(dc.jsx)(M.jb,{alertText:a("Address Copied to Clipboard!"),open:J,autoHideDuration:Xa,setOpen:G,severity:"success"})]})}));function mo(){return fo.apply(this,arguments)}function fo(){return(fo=Object(f.a)(m.a.mark((function e(){var t,a,n,c,r,o,i,s,u,l;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=Cn.getState().system,a=Cn.getState().account,Ga("before check!",a),n={code:Ja.NoError},e.prev=4,!(oe.userAPI&&oe.exchangeAPI&&t.exchangeInfo&&Sa.a.usedWeb3&&a&&"unknown"!==t.chainId&&"unknown"!==a.connectName)){e.next=38;break}return c={ETH:"529000000000000",LRC:"34000000000000000000",USDT:"7850000",DAI:"98100000000000000000"},e.next=9,oe.exchangeAPI.getAccount({owner:a.accAddress});case 9:if(r=e.sent,!(null===(o=r.accInfo)||void 0===o?void 0:o.owner)||!(null===o||void 0===o?void 0:o.accountId)){e.next=38;break}return i=a.connectName,e.prev=13,e.next=16,re.u(Sa.a.usedWeb3,o.owner,t.exchangeInfo.exchangeAddress,o.keyNonce,i);case 16:return s=e.sent,e.prev=17,u={exchange:t.exchangeInfo.exchangeAddress,owner:o.owner,accountId:o.accountId,publicKey:{x:s.formatedPx,y:s.formatedPy},maxFee:{tokenId:0,volume:c.ETH},validUntil:re.l,nonce:o.nonce},Ga("req:",u),e.next=22,oe.userAPI.updateAccount(u,Sa.a.usedWeb3,t.chainId,i);case 22:return l=e.sent,e.next=25,re.I(Qa);case 25:n.data=l,e.next=32;break;case 28:e.prev=28,e.t0=e.catch(17),n.code=Ja.UpdateAccoutError,n.data=e.t0;case 32:e.next=38;break;case 34:e.prev=34,e.t1=e.catch(13),n.code=Ja.GenEddsaKeyError,n.data=e.t1;case 38:e.next=44;break;case 40:e.prev=40,e.t2=e.catch(4),n.code=Ja.GetAccError,n.data=e.t2;case 44:return e.abrupt("return",n);case 45:case"end":return e.stop()}}),e,null,[[4,40],[13,34],[17,28]])})))).apply(this,arguments)}function vo(){Bn.sendAccountLock()}var jo=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=Ee(),a=t.tokenMap,n=t.coinMap,c=T(),r=c.account,o=Fa(),i=o.exchangeInfo,s=o.chainId,u=o.gasPrice,l=O.a.useState({belong:void 0,tradeValue:0,balance:0}),b=Object(be.a)(l,2),p=b[0],v=b[1],h=vt(),k=h.walletLayer1,x=Object(M.Qb)(),g=x.setShowDeposit,w=x.setShowAccount,A=Object(Vc.a)("common"),y=A.t,S=O.a.useCallback(function(){var e=Object(f.a)(m.a.mark((function e(t){var n,c,o,l,b,p,f,v,j,O,h,k,x,g,A,y;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r.accountId,r.accAddress,n=r.readyState,r.apiKey,c=r.connectName,r.eddsaKey,console.log(oe.exchangeAPI,Sa.a.usedWeb3),o={code:Ja.NoError},!(n!==d.a.UN_CONNECT&&t.tradeValue&&a&&(null===i||void 0===i?void 0:i.exchangeAddress)&&Sa.a.usedWeb3&&oe.exchangeAPI)){e.next=58;break}return e.prev=4,l=a[t.belong],b=parseInt(l.gasAmounts.deposit),e.next=9,re.A(Sa.a.usedWeb3,r.accAddress);case 9:if(p=e.sent,f=0,v=c===d.l.MetaMask,j=null!==u&&void 0!==u?u:30,"ETH"===l.symbol.toUpperCase()){e.next=39;break}return O={owner:r.accAddress,token:l.symbol},e.next=17,oe.exchangeAPI.getAllowances(O,a);case 17:if(h=e.sent,k=h.tokenAllowances,x=re.J(k[l.symbol]),!(g=re.J(t.tradeValue).times("1e"+l.decimals)).gt(x)){e.next=38;break}return Ga(g,x," need approveMax!"),w({isShow:!0,step:M.a.TokenApproveInProcess}),e.prev=24,e.next=27,re.q(Sa.a.usedWeb3,r.accAddress,l.address,null===i||void 0===i?void 0:i.depositAddress,j,b,"unknown"===s?void 0:s,p,v);case 27:p+=1,e.next=36;break;case 30:return e.prev=30,e.t0=e.catch(24),o.code=Ja.ApproveFailed,o.data=e.t0,w({isShow:!0,step:M.a.TokenApproveFailed}),e.abrupt("return");case 36:e.next=39;break;case 38:Ga("allowance is enough! don't need approveMax!");case 39:return w({isShow:!0,step:M.a.DepositInProcess}),Ga("before deposit:",s,c,v),A="unknown"===s?1:s,e.next=44,re.r(Sa.a.usedWeb3,r.accAddress,i.exchangeAddress,l,t.tradeValue,f,j,b,A,p,v);case 44:y=e.sent,Ga("response:",y),o.data=y,void 0===(null===y||void 0===y?void 0:y.hash)&&(null===y||void 0===y?void 0:y.errInfo)?w({isShow:!0,step:M.a.DepositFailed}):w({isShow:!0,step:M.a.Depositing}),e.next=56;break;case 50:e.prev=50,e.t1=e.catch(4),Object(re.s)(e.t1),o.code=Ja.DepositFailed,o.data=e.t1,w({isShow:!0,step:M.a.DepositFailed});case 56:e.next=59;break;case 58:o.code=Ja.DataNotReady;case 59:return e.abrupt("return",o);case 60:case"end":return e.stop()}}),e,null,[[4,50],[24,30]])})));return function(t){return e.apply(this,arguments)}}(),[r,a,s,i,u,oe.exchangeAPI,w]),I=Object(j.useCallback)(function(){var e=Object(f.a)(m.a.mark((function e(t){return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(Ga("onDepositClick depositValue:",t),g({isShow:!1}),!t||!t.belong){e.next=5;break}return e.next=5,S(t);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[p,S,g,w,e]),N=(Object(j.useCallback)(function(){var e=Object(f.a)(m.a.mark((function e(t,a){return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e){e()})));case 1:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),[p,v]),y(e?"labelCreateLayer2Title":"depositTitleAndActive")),C={isNewAccount:e,title:N,tradeData:{belong:void 0},coinMap:n,walletMap:k,depositBtnStatus:M.nb.AVAILABLE,onDepositClick:I};return{depositProps:C}},Oo=["onClose","etherscanUrl","open","t"],ho=Object(lc.a)("common")((function(e){var t=e.onClose,a=e.etherscanUrl,n=(e.open,e.t),c=Object(l.a)(e,Oo),r=T(),i=r.account,s=r.shouldShow,u=r.updateAccount,b=r.setShouldShow,p=r.resetAccount,h=jo(!0).depositProps,k=Object(M.Qb)(),x=k.modals.isShowAccount,g=k.setShowConnect,w=k.setShowAccount,A=Object(j.useState)(!1),y=Object(be.a)(A,2),S=y[0],I=y[1],N=Object(d.fb)(i.accAddress),C=Ee().coinMap,E=Object(j.useState)(!1),P=Object(be.a)(E,2),D=P[0],_=P[1],R=O.a.useCallback((function(){w({isShow:!1}),b(!0),g({isShow:null!==s&&void 0!==s&&s})}),[g,w,s]),L=O.a.useCallback((function(){Jn(i.accAddress),_(!0)}),[i]),U=O.a.useCallback((function(){I(!0)}),[]),B=O.a.useCallback(Object(f.a)(m.a.mark((function e(){return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:Sa.c.sendDisconnect("","customer click disconnect"),w({isShow:!1});case 2:case"end":return e.stop()}}),e)}))),[p,w]),F=O.a.useCallback((function(){w({isShow:!0,step:M.a.Deposit})}),[w]),K=O.a.useCallback(Object(f.a)(m.a.mark((function e(){var t;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i.accAddress){e.next=3;break}return Ga("account.accAddress is nil"),e.abrupt("return");case 3:return Ga("goUpdateAccount...."),w({isShow:!0,step:M.a.UpdateAccountInProcess}),e.next=7,mo();case 7:t=e.sent,e.t0=t.code,e.next=e.t0===Ja.NoError?11:e.t0===Ja.GetAccError||e.t0===Ja.GenEddsaKeyError||e.t0===Ja.UpdateAccoutError?16:19;break;case 11:return w({isShow:!0,step:M.a.SuccessUnlock}),e.next=14,Object(re.I)(Qa);case 14:return w({isShow:!1}),e.abrupt("break",20);case 16:return Ga("try to sendCheckAccount..."),Bn.sendCheckAccount(i.accAddress),e.abrupt("break",20);case 19:return e.abrupt("break",20);case 20:case"end":return e.stop()}}),e)}))),[i,w]),W=O.a.useCallback((function(){w({isShow:!0,step:M.a.QRCode})}),[]),H=O.a.useMemo((function(){return Object(dc.jsxs)(M.o,{variant:"contained",fullWidth:!0,size:"medium",onClick:function(){b(!0),Pn()},children:[n("labelUnLockLayer2")," "]})}),[u,n]),V=O.a.useMemo((function(){return Object(dc.jsxs)(M.o,{variant:"contained",fullWidth:!0,size:"medium",onClick:function(){vo()},children:[n("labelLockLayer2")," "]})}),[vo,n]),J=O.a.useCallback((function(){switch(i.readyState){case"NO_ACCOUNT":case"DEPOSITING":w({isShow:!0,step:M.a.NoAccount});break;case"LOCKED":case"ACTIVATED":w({isShow:!0,step:M.a.HadAccount});break;default:w({isShow:!1})}}),[i]),G=n("labelCreateLayer2Title"),Y=O.a.useMemo((function(){var e;return Object.values((e={},Object(v.a)(e,M.a.NoAccount,{view:Object(dc.jsx)(M.P,Object(o.a)({},Object(o.a)(Object(o.a)({goDeposit:F},i),{},{etherscanUrl:a,onSwitch:R,onCopy:L,onViewQRCode:U,onDisconnect:B,addressShort:N}))),onQRClick:W}),Object(v.a)(e,M.a.QRCode,{view:Object(dc.jsx)(M.U,Object(o.a)({},Object(o.a)(Object(o.a)(Object(o.a)({},c),i),{},{etherscanUrl:a,t:n}))),onBack:J,noClose:!0}),Object(v.a)(e,M.a.Deposit,{view:Object(dc.jsx)(M.r,Object(o.a)({title:G},Object(o.a)(Object(o.a)(Object(o.a)({},c),{},{_height:"var(--modal-height)",_width:"var(--modal-width)"},h),{},{t:n})))}),Object(v.a)(e,M.a.Depositing,{view:Object(dc.jsx)(M.s,Object(o.a)({label:G,onClose:t,etherscanLink:a+i.accAddress},Object(o.a)(Object(o.a)({},c),{},{t:n})))}),Object(v.a)(e,M.a.DepositFailed,{view:Object(dc.jsx)(M.x,Object(o.a)({label:G,etherscanLink:a+i.accAddress,onRetry:function(){return F()}},Object(o.a)(Object(o.a)({},c),{},{t:n}))),onBack:function(){w({isShow:!0,step:M.a.Deposit})}}),Object(v.a)(e,M.a.UpdateAccount,{view:Object(dc.jsx)(M.k,Object(o.a)(Object(o.a)({},Object(o.a)(Object(o.a)({},i),{},{etherscanUrl:a,onSwitch:R,onCopy:L,onViewQRCode:U,onDisconnect:B,addressShort:N})),{},{goUpdateAccount:function(){K()}},Object(o.a)(Object(o.a)({},c),{},{t:n}))),onQRClick:W}),Object(v.a)(e,M.a.ProcessUnlock,{view:Object(dc.jsx)(M.S,Object(o.a)({providerName:i.connectName},Object(o.a)(Object(o.a)({},c),{},{t:n})))}),Object(v.a)(e,M.a.SuccessUnlock,{view:Object(dc.jsx)(M.cb,Object(o.a)({providerName:i.connectName},Object(o.a)(Object(o.a)({},c),{},{t:n})))}),Object(v.a)(e,M.a.FailedUnlock,{view:Object(dc.jsx)(M.z,Object(o.a)({onRetry:function(){Pn()}},Object(o.a)(Object(o.a)({},c),{},{t:n})))}),Object(v.a)(e,M.a.HadAccount,{view:Object(dc.jsx)(M.A,Object(o.a)({},Object(o.a)(Object(o.a)({},i),{},{onSwitch:R,onCopy:L,etherscanUrl:a,onViewQRCode:U,onDisconnect:B,addressShort:N,etherscanLink:a+i.accAddress,mainBtn:"ACTIVATED"===i.readyState?V:H}))),onQRClick:W}),Object(v.a)(e,M.a.TokenApproveInProcess,{view:Object(dc.jsx)(M.lb,Object(o.a)({label:G,providerName:i.connectName},Object(o.a)(Object(o.a)({},c),{},{t:n}))),onBack:function(){w({isShow:!0,step:M.a.Deposit})}}),Object(v.a)(e,M.a.DepositApproveProcess,{view:Object(dc.jsx)(M.q,Object(o.a)({label:G,etherscanLink:a+i.accAddress,providerName:i.connectName},Object(o.a)(Object(o.a)({},c),{},{t:n})))}),Object(v.a)(e,M.a.DepositInProcess,{view:Object(dc.jsx)(M.t,Object(o.a)({label:G,etherscanLink:a+i.accAddress,providerName:i.connectName},Object(o.a)(Object(o.a)({},c),{},{t:n})))}),Object(v.a)(e,M.a.UpdateAccountInProcess,{view:Object(dc.jsx)(M.b,Object(o.a)({providerName:i.connectName},Object(o.a)(Object(o.a)({},c),{},{t:n})))}),Object(v.a)(e,M.a.UpdateAccountFailed,{view:Object(dc.jsx)(M.z,Object(o.a)({label:G,onRetry:function(){K()}},Object(o.a)(Object(o.a)({},c),{},{t:n}))),onBack:function(){w({isShow:!0,step:M.a.UpdateAccount})}}),Object(v.a)(e,M.a.TokenApproveFailed,{view:Object(dc.jsx)(M.y,Object(o.a)({label:G,onRetry:function(){F()}},Object(o.a)(Object(o.a)({t:n},c),{},{coinInfo:C?C.USTD:void 0})))}),e))}),[N,i,h,a,L,R,B,U,n,c]);return Object(dc.jsxs)(dc.Fragment,{children:[Object(dc.jsx)(M.jb,{alertText:n("Address Copied to Clipboard!"),open:D,autoHideDuration:Xa,setOpen:_,severity:"success"}),Object(dc.jsx)(M.M,{open:S,onClose:function(){return I(!1)},title:"ETH Address",description:null===i||void 0===i?void 0:i.accAddress,url:null===i||void 0===i?void 0:i.accAddress}),Object(dc.jsx)(M.I,{open:x.isShow,onClose:function(e){b(!1),t(e)},panelList:Y,onBack:Y[x.step].onBack,onQRClick:Y[x.step].onQRClick,step:x.step})]})}));function ko(e,t,a,n){var c=T().account,r=Object(j.useState)([]),o=Object(be.a)(r,2),i=o[0],s=o[1];return _c(Object(f.a)(m.a.mark((function r(){var o,i,u,l,d;return m.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(-1!==c.accountId&&e&&a&&oe.userAPI){r.next=2;break}return r.abrupt("return");case 2:return o=[],r.prev=3,u=a[e],l={accountId:c.accountId,tokenSymbol:e,requestType:t,amount:n?Object(re.J)(n).times("1e"+u.decimals).toFixed(0,0):void 0},r.next=8,oe.userAPI.getOffchainFeeAmt(l,c.apiKey);case 8:(null===(d=r.sent)||void 0===d||null===(i=d.raw_data)||void 0===i?void 0:i.fees)instanceof Array&&(d.raw_data.fees.forEach((function(e){var t=e.fee,n=a[e.token],c=re.J(e.fee).div("1e"+n.decimals).toNumber();o.push({belong:e.token,fee:c,__raw__:t})})),s(o)),Ga("response:",d),r.next=16;break;case 13:r.prev=13,r.t0=r.catch(3),Object(re.s)(r.t0);case 16:s(o);case 17:case"end":return r.stop()}}),r,null,[[3,13]])}))),[c.accountId,c.apiKey,oe.userAPI,t,e,a]),{chargeFeeList:i}}function xo(){var e=T(),t=e.shouldShow,a=e.setShouldShow,n=e.statusUnset,c=Object(M.Qb)().setShowAccount,r=O.a.useCallback((function(){n()}),[t]),o=O.a.useCallback((function(){n(),c({isShow:null!==t&&void 0!==t&&t,step:M.a.HadAccount})}),[t]),i=O.a.useCallback((function(e){n(),c({isShow:null!==t&&void 0!==t&&t,step:M.a.NoAccount})}),[t]),s=O.a.useCallback(Object(f.a)(m.a.mark((function e(){return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c({isShow:null!==t&&void 0!==t&&t,step:M.a.Depositing}),e.next=3,Object(re.I)(5e3);case 3:a(!1),c({isShow:!1}),n();case 6:case"end":return e.stop()}}),e)}))),[t]),u=O.a.useCallback((function(){c({isShow:null!==t&&void 0!==t&&t,step:M.a.Depositing})}),[t]),l=O.a.useCallback((function(){c({isShow:null!==t&&void 0!==t&&t,step:M.a.DepositFailed})}),[t]),d=O.a.useCallback((function(){c({isShow:null!==t&&void 0!==t&&t,step:M.a.DepositApproveProcess})}),[t]),b=O.a.useCallback((function(){n(),c({isShow:null!==t&&void 0!==t&&t,step:M.a.UpdateAccount})}),[t]),p=O.a.useCallback((function(){c({isShow:null!==t&&void 0!==t&&t,step:M.a.FailedUnlock})}),[t]);!function(e){var t=e.handleLockAccount,a=e.handleNoAccount,n=e.handleErrorAccount,c=e.handleDepositingAccount,r=e.handleErrorApproveToken,o=e.handleErrorDepositSign,i=e.handleProcessDeposit,s=e.handleSignAccount,u=e.handleProcessSign,l=e.handleSignError,d=e.handleProcessAccountCheck,b=e.handleAccountActive,p=O.a.useMemo((function(){return Bn.onSocket()}),[]);O.a.useEffect((function(){var e=p.subscribe((function(e){var d=e.data;switch(e.status){case"ErrorNetwork":n(d);break;case"LockAccount":t(d);break;case"NoAccount":a(d);break;case"DepositingAccount":c(d);break;case"ErrorApproveToken":r(d);break;case"ErrorDepositSign":o(d);break;case"ProcessDeposit":i(d);break;case"SignAccount":s(d);break;case"ProcessSign":u(d);break;case"ErrorSign":l(d);break;case"AccountUnlocked":b(d)}}));return function(){return e.unsubscribe()}}),[p,t,n,a,c,r,o,i,s,u,d])}({handleErrorAccount:r,handleLockAccount:o,handleNoAccount:i,handleDepositingAccount:s,handleErrorApproveToken:u,handleErrorDepositSign:l,handleProcessDeposit:d,handleSignAccount:b,handleProcessSign:O.a.useCallback((function(){c({isShow:null!==t&&void 0!==t&&t,step:M.a.ProcessUnlock})}),[t]),handleSignError:p,handleAccountActive:O.a.useCallback(Object(f.a)(m.a.mark((function e(){return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c({isShow:null!==t&&void 0!==t&&t,step:M.a.SuccessUnlock}),e.next=3,Object(re.I)(1e3);case 3:a(!1),c({isShow:!1}),n();case 6:case"end":return e.stop()}}),e)}))),[t])})}var go=Object(lc.a)("common",{withRef:!0})((function(e){var t=Object.assign({},e),a=function(){var e,t=Ee(),a=t.tokenMap,n=t.coinMap,c=T().account,r=Fa(),o=r.exchangeInfo,i=r.chainId,s=Za(),u=(s.walletLayer2,s.status),l=O.a.useState(null!==(e=cc().walletMap)&&void 0!==e?e:{}),b=Object(be.a)(l,2),p=b[0],v=b[1],h=O.a.useState({belong:void 0,tradeValue:0,balance:0}),k=Object(be.a)(h,2),x=k[0],g=k[1],w=ko(x.belong,re.g.TRANSFER,a).chargeFeeList,A=O.a.useState(),y=Object(be.a)(A,2),S=y[0],I=y[1],N=O.a.useState(""),C=Object(be.a)(N,2),E=C[0],P=C[1];O.a.useEffect((function(){if(u===d.L.UNSET){var e,t=null!==(e=cc().walletMap)&&void 0!==e?e:{};v(t)}}),[u]),_c((function(){w.length>0&&I(w[0])}),[w,I]);var D=Object(j.useCallback)(function(){var e=Object(f.a)(m.a.mark((function e(t){var n,r,s,u,l,b,p,f,v,j,O,h,k,x;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=c.accountId,r=c.accAddress,s=c.readyState,u=c.apiKey,l=c.connectName,b=c.eddsaKey,console.log("useCallback tranferFeeInfo:",S),!(s===d.a.ACTIVATED&&a&&o&&Sa.a.usedWeb3&&(null===t||void 0===t?void 0:t.belong)&&(null===S||void 0===S?void 0:S.belong)&&(null===b||void 0===b?void 0:b.sk))){e.next=23;break}return e.prev=3,v=a[t.belong],j=a[S.belong],O=Object(re.J)(t.tradeValue).times("1e"+v.decimals).toFixed(0,0),e.next=9,null===(p=oe.userAPI)||void 0===p?void 0:p.getNextStorageId({accountId:n,sellTokenId:v.tokenId},u);case 9:return h=e.sent,k={exchange:o.exchangeAddress,payerAddr:r,payerId:n,payeeAddr:E,payeeId:0,storageId:null===h||void 0===h?void 0:h.offchainId,token:{tokenId:v.tokenId,volume:O},maxFee:{tokenId:j.tokenId,volume:S.__raw__},validUntil:re.l},e.next=13,null===(f=oe.userAPI)||void 0===f?void 0:f.submitInternalTransfer(k,Sa.a.usedWeb3,"unknown"===i?5:i,l,b.sk,u);case 13:x=e.sent,Ga(x),void 0===(null===x||void 0===x?void 0:x.hash)&&(null===x||void 0===x||x.errInfo),e.next=21;break;case 18:e.prev=18,e.t0=e.catch(3),Object(re.s)(e.t0);case 21:e.next=24;break;case 23:return e.abrupt("return",!1);case 24:case"end":return e.stop()}}),e,null,[[3,18]])})));return function(t){return e.apply(this,arguments)}}(),[c,a,null===S||void 0===S?void 0:S.belong,x,E]),_=Object(j.useCallback)(function(){var e=Object(f.a)(m.a.mark((function e(t,a){return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e){var a;(null===t||void 0===t||null===(a=t.tradeData)||void 0===a?void 0:a.belong)?x!==t.tradeData&&g(t.tradeData):g({belong:void 0,tradeValue:0,balance:0}),e()})));case 1:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),[g]),R=Object(j.useCallback)((function(e){Ga("handleFeeChange:",e),I(e)}),[I]);return{transferProps:{tradeData:{belong:void 0},coinMap:n,walletMap:p,transferBtnStatus:M.nb.AVAILABLE,onTransferClick:D,handleFeeChange:R,handlePanelEvent:_,chargeFeeToken:"ETH",chargeFeeTokenList:w,handleOnAddressChange:function(e){Ga("transfer handleOnAddressChange:",e),P(e)},handleAddressError:function(e){return{error:!1,message:""}}}}}().transferProps,n=jo().depositProps,c=function(){var e,t=Object(Vc.a)("common").t,a=Object(j.useState)(!1),n=Object(be.a)(a,2),c=n[0],r=n[1],o=Object(j.useState)(),i=Object(be.a)(o,2),s=i[0],u=i[1],l=Ee(),b=l.tokenMap,p=l.coinMap,v=T().account,h=Fa(),k=h.exchangeInfo,x=h.chainId,g=O.a.useState({belong:void 0,tradeValue:0,balance:0}),w=Object(be.a)(g,2),A=w[0],y=w[1],S=Za().status,I=O.a.useState(null!==(e=cc().walletMap)&&void 0!==e?e:{}),N=Object(be.a)(I,2),C=N[0],E=N[1],P=ko(A.belong,re.g.OFFCHAIN_WITHDRAWAL,b).chargeFeeList,D=Object(j.useState)(),_=Object(be.a)(D,2),R=_[0],L=_[1],U=Object(j.useState)(void 0),B=Object(be.a)(U,2),F=B[0],K=B[1],W=Object(j.useState)(re.g.OFFCHAIN_WITHDRAWAL),H=Object(be.a)(W,2),V=H[0],J=H[1],G=Object(M.Qb)().setShowWithdraw;O.a.useEffect((function(){if(S===d.L.UNSET){var e,t=null!==(e=cc().walletMap)&&void 0!==e?e:{};E(t)}}),[S]),_c((function(){P.length>0&&K(P[0])}),[P,K]);var Y=O.a.useCallback(function(){var e=Object(f.a)(m.a.mark((function e(a){var n,c,o,i,s,l,p,f,j,O,h,g,w;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=v.accountId,c=v.accAddress,o=v.readyState,i=v.apiKey,s=v.connectName,l=v.eddsaKey,!(o===d.a.ACTIVATED&&b&&k&&Sa.a.usedWeb3&&R&&(null===F||void 0===F?void 0:F.belong)&&(null===l||void 0===l?void 0:l.sk))){e.next=24;break}return e.prev=2,j=b[a.belong],O=b[F.belong],h=Object(re.J)(a.tradeValue).times("1e"+j.decimals).toFixed(0,0),e.next=8,null===(p=oe.userAPI)||void 0===p?void 0:p.getNextStorageId({accountId:n,sellTokenId:j.tokenId},i);case 8:return g=e.sent,e.next=11,null===(f=oe.userAPI)||void 0===f?void 0:f.submitOffchainWithdraw({exchange:k.exchangeAddress,owner:c,to:R,accountId:v.accountId,storageId:null===g||void 0===g?void 0:g.offchainId,token:{tokenId:j.tokenId,volume:h},maxFee:{tokenId:O.tokenId,volume:F.__raw__},extraData:"",minGas:0,validUntil:re.l},Sa.a.usedWeb3,"unknown"===x?1:x,s,l.sk,i);case 11:w=e.sent,Ga("got response:",w),void 0===(null===w||void 0===w?void 0:w.hash)&&(null===w||void 0===w?void 0:w.errInfo)?u(t("labelWithdrawFailed")):u(t("labelWithdrawSucess")),e.next=20;break;case 16:e.prev=16,e.t0=e.catch(2),Object(re.s)(e.t0),u(t("labelWithdrawFailed"));case 20:return r(!0),e.abrupt("return",!0);case 24:return e.abrupt("return",!1);case 25:case"end":return e.stop()}}),e,null,[[2,16]])})));return function(t){return e.apply(this,arguments)}}(),[v,b,F]),z=V===re.g.FAST_OFFCHAIN_WITHDRAWAL?"Fast":"Standard",q={tradeData:{belong:void 0},coinMap:p,walletMap:C,withdrawBtnStatus:M.nb.AVAILABLE,withdrawType:z,withdrawTypes:d.ab,onWithdrawClick:function(){A&&A.belong&&Y(A),G({isShow:!1})},handleFeeChange:function(e){K(e)},handleWithdrawTypeChange:function(e){Ga("handleWithdrawTypeChange",e);var t=e===d.Z.Fast?re.g.FAST_OFFCHAIN_WITHDRAWAL:re.g.OFFCHAIN_WITHDRAWAL;J(t)},handlePanelEvent:function(){var e=Object(f.a)(m.a.mark((function e(t,a){return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e){var a;(null===t||void 0===t||null===(a=t.tradeData)||void 0===a?void 0:a.belong)?A!==t.tradeData&&y(t.tradeData):y({belong:void 0,tradeValue:0,balance:0}),e()})));case 1:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),chargeFeeToken:"ETH",chargeFeeTokenList:P,handleOnAddressChange:function(e){L(e)},handleAddressError:function(e){return{error:!1,message:""}}};return{withdrawAlertText:s,withdrawToastOpen:c,setWithdrawToastOpen:r,withdrawProps:q}}(),r=c.withdrawAlertText,i=c.withdrawToastOpen,s=c.setWithdrawToastOpen,u=c.withdrawProps,l=Fa().etherscanUrl;xo();var b=Object(M.Qb)(),p=b.modals,v=p.isShowAccount,h=p.isShowConnect,k=b.setShowConnect,x=b.setShowAccount;return Object(dc.jsxs)(dc.Fragment,{children:[Object(dc.jsx)(M.jb,{alertText:r,open:i,autoHideDuration:Xa,setOpen:s}),Object(dc.jsx)(M.L,{transferProps:a,withDrawProps:u,depositProps:n,resetProps:{},ammProps:{},swapProps:{},_height:"var(--modal-height)",_width:"var(--modal-width)"}),Object(dc.jsx)(po,Object(o.a)({},Object(o.a)(Object(o.a)({},t),{},{open:h.isShow,onClose:function(){return k({isShow:!1})}}))),Object(dc.jsx)(ho,Object(o.a)({},Object(o.a)(Object(o.a)({},t),{},{etherscanUrl:l,open:v.isShow,onClose:function(){return x({isShow:!1})}})))]})})),wo=function(){return Object(dc.jsxs)(s.a,{children:[Object(dc.jsx)(pc,{}),Object(dc.jsx)(Zc.a,{maxWidth:"lg",style:{minHeight:"calc(100% - 64px - 32px)",display:"flex",flexDirection:"column"},children:Object(dc.jsx)(vc.a,{display:"flex",flex:1,alignItems:"stretch",flexDirection:"row",marginTop:3,children:Object(dc.jsxs)(u.c,{children:[Object(dc.jsx)(u.a,{exact:!0,component:Xc,path:"/"}),Object(dc.jsx)(u.a,{exact:!0,component:Mc,path:"/markets"}),Object(dc.jsx)(u.a,{component:Xc,path:"/trading/lite"}),Object(dc.jsx)(u.a,{component:Xc,path:"/trading/lite(/:symbol)"}),Object(dc.jsx)(u.a,{exact:!0,component:lo,path:"/mining"}),Object(dc.jsx)(u.a,{exact:!0,component:Pr,path:"/layer2"}),Object(dc.jsx)(u.a,{exact:!0,component:Pr,path:"/layer2/assets"}),Object(dc.jsx)(u.a,{exact:!0,component:Pr,path:"/layer2/my-liquidity"}),Object(dc.jsx)(u.a,{exact:!0,component:Pr,path:"/layer2/history"}),Object(dc.jsx)(u.a,{exact:!0,component:Pr,path:"/layer2/order"}),Object(dc.jsx)(u.a,{exact:!0,component:Pr,path:"/layer2/rewards"}),Object(dc.jsx)(u.a,{exact:!0,component:Pr,path:"/layer2/setting"}),Object(dc.jsx)(u.a,{exact:!0,component:co,path:"/liquidity"}),Object(dc.jsx)(u.a,{exact:!0,component:co,path:"/liquidity/pools/*"}),Object(dc.jsx)(u.a,{exact:!0,component:co,path:"/liquidity/pools"}),Object(dc.jsx)(u.a,{exact:!0,component:co,path:"/liquidity/amm-mining"}),Object(dc.jsx)(u.a,{exact:!0,component:co,path:"/liquidity/my-liquidity"}),Object(dc.jsx)($c,{children:Object(dc.jsx)(u.a,{exact:!0,path:"/debug"})})]})})}),Object(dc.jsx)(go,{})]})},Ao=a(1727),yo=a(125),So=a(65),Io=function(e){var t=e.chainId,a=Cn.getState().system.chainId;return"unknown"===t?(Cn.dispatch(A({wrongChain:!0,_chainId:t})),Bn.sendUpdateAccStatusAndReset(d.a.ERROR_NETWORK),!1):t!==a&&"unknown"!==a&&"unknown"!==t?(Cn.dispatch(A({_chainId:t})),Cn.dispatch(ot({chainId:t})),Bn.sendUpdateAccStatusAndReset(d.a.UN_CONNECT),!0):(Cn.dispatch(A({wrongChain:!1,_chainId:t})),!0)},No=function(e){var t=Cn.getState().account;""===t.accAddress||t.accAddress!==e?(Ga("After connect >>,account part: diff account, clean layer2"),Cn.dispatch(S(void 0)),Bn.sendCheckAccount(e)):e&&""!==e&&(Ga("After connect >>,checkAccount: step1 address",e),t&&-1===t.accountId?(Ga("After connect >>,checkAccount: step1 no account Id"),Bn.sendCheckAccount(e)):t.accountId&&t.apiKey&&t.eddsaKey?(Ga("After connect >>,checkAccount: step1 have activate account from store, account:",t),Bn.sendAccountSigned()):(Ga("After connect >>,checkAccount: step1 account locked"),Bn.sendAccountLock()))};function Co(e){var t=e.state,a=en().getUserRewards;!function(e){e.state;var t=T(),a=t.account,n=t.shouldShow,c=t.resetAccount,r=t.statusUnset,o=t.setShouldShow,i=t.status,s=Fa(),u=s.updateSystem,l=(s.chainId,Object(M.Qb)().setShowConnect),b=O.a.useState(d.L.DONE),p=Object(be.a)(b,2),v=p[0],j=p[1];O.a.useEffect((function(){v===d.L.PENDING&&i===d.L.DONE&&(j(d.L.DONE),r())}),[v,i]);var h=O.a.useCallback(function(){var e=Object(f.a)(m.a.mark((function e(t){var a,c,r,i;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.accounts,c=t.chainId,r=a[0],Ga("After connect >>,network part start: step1 networkUpdate"),i=Io({chainId:c}),Ga("After connect >>,network part done: step2 check account"),i&&No(r),o(!1),l({isShow:null!==n&&void 0!==n&&n,step:M.zb.SuccessConnect}),e.next=10,Object(re.I)(1e3);case 10:l({isShow:!1,step:M.zb.SuccessConnect});case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[n,l,o]),k=O.a.useCallback(Object(f.a)(m.a.mark((function e(){return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,c({shouldUpdateProvider:!0});case 2:j(d.L.PENDING);case 3:case"end":return e.stop()}}),e)}))),[c]),x=O.a.useCallback(function(){var e=Object(f.a)(m.a.mark((function e(t){return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.type,t.errorObj,u({chainId:a._chainId?a._chainId:1}),c(),r(),Ga("Error");case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[c,r,u,a._chainId]);Object(Sa.b)({handleAccountDisconnect:k,handleError:x,handleConnect:h})}({state:t});var n=vt(),c=n.updateWalletLayer1,r=n.resetLayer1,o=n.status,i=n.statusUnset,s=Za(),u=s.updateWalletLayer2,l=s.resetLayer2,b=s.status,p=s.statusUnset,v=T(),j=v.account,h=v.status;v.statusUnset;O.a.useEffect((function(){if(h===d.L.UNSET&&t===d.L.DONE){switch(j.readyState){case"UN_CONNECT":case"ERROR_NETWORK":r();break;case"NO_ACCOUNT":case"DEPOSITING":case"LOCKED":l(),o!==d.L.PENDING&&c();break;case"ACTIVATED":o!==d.L.PENDING&&c(),b!==d.L.PENDING&&u()}a()}}),[h,t,j.readyState]),O.a.useEffect((function(){switch(o){case"ERROR":case"DONE":i()}}),[o]),O.a.useEffect((function(){switch(b){case"ERROR":case"DONE":p()}}),[b])}var To;a(278);var Mo,Eo,Po=Object(Ac.a)(vc.a)(To||(To=Object(i.a)(["\n  background-image: url('./static/images/error_bg.png');\n  background-repeat: no-repeat;\n  background-size: contain;\n  background-position: bottom;\n  white-space: pre-wrap;\n  //h2{\n  //  position: relative;\n  //}\n"]))),Do=function(e){var t=e.messageKey,a=Object(Vc.a)("error").t;return Object(dc.jsx)(dc.Fragment,{children:Object(dc.jsx)(Zc.a,{children:Object(dc.jsx)(Po,{flex:1,display:"flex",alignItems:"flex-start",justifyContent:"center",flexDirection:"column",marginTop:4,height:680,maxWidth:1200,children:Object(dc.jsxs)(vc.a,{textAlign:"center",position:"relative",left:128,top:-64,children:[Object(dc.jsx)(rr.a,{component:"h2",variant:"h3",children:a(t)}),Object(dc.jsx)(rr.a,{marginY:2,component:"p",variant:"body1",color:"textSecondary",children:Object(dc.jsxs)(ro.a,{i18nKey:"labelConnectUs",children:["If you believe this is indeed a bug, please ",Object(dc.jsx)(Yr.a,{component:"a",onClick:function(e){window.location.href=function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"report to loopring website",a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Body Content",n=null!==(e=Object({NODE_ENV:"production",PUBLIC_URL:".",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_RPC_URL_1:"https://mainnet.eth.loopring.network",REACT_APP_MAGIC_API_KEY:"pk_test_398B82F5F0E88874",REACT_APP_API_URL:"api.loopring.network",REACT_APP_RPC_URL_5:"https://goerli.infura.io/v3/84842078b09946638c03157f83405213",REACT_APP_API_URL_UAT:"uat2.loopring.io",REACT_APP_PORTIS_DAPP_ID:"e9be171c-2b7f-4ff0-8db9-327707511ee2",REACT_APP_WALLET_CONNECT_BRIDGE:"https://bridge.walletconnect.org",REACT_APP_FORTMATIC_API_KEY:"pk_test_A6260FCBAA2EBDFB"}).CONTACT_US_EMAIL)&&void 0!==e?e:"contact@loopring.io";return"mailto:".concat(n,"?subject=").concat(t,"&body=").concat(a)}(),e.preventDefault()},children:"contact us"})," ",Object(dc.jsx)("br",{})," We would appreciate your feedback"]})})]})})})})},_o=Object(Ac.a)(vc.a)(Mo||(Mo=Object(i.a)(["\n  //background: var(--color-mask);\n  ","\n\n  position: absolute;\n  top: 0;\n  bottom: 0;\n  left: 0;\n  right: 0;\n  width: 0;\n  z-index: 500;\n  height: 100%;\n  width: 100%;\n  svg path,\n  svg rect{\n    fill: var(--color-primary)\n  }\n"])),(function(e){var t=e.theme;return Object(M.Cb)({theme:t})})),Ro=function(){Object(Vc.a)("layout").t;return Object(dc.jsx)(dc.Fragment,{children:Object(dc.jsx)(_o,{flex:1,display:"flex",alignItems:"center",justifyContent:"center",flexDirection:"column",height:"100%",width:"100%",children:Object(dc.jsx)("div",{className:"loader loader--style3",title:"2",children:Object(dc.jsx)("svg",{version:"1.1",id:"loader-1",xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",x:"0px",y:"0px",width:"40px",height:"40px",viewBox:"0 0 50 50",enableBackground:"new 0 0 50 50",xmlSpace:"preserve",children:Object(dc.jsx)("path",{fill:"#000",d:"M43.935,25.145c0-10.318-8.364-18.683-18.683-18.683c-10.318,0-18.683,8.365-18.683,18.683h4.068c0-8.071,6.543-14.615,14.615-14.615c8.072,0,14.615,6.543,14.615,14.615H43.935z",children:Object(dc.jsx)("animateTransform",{attributeType:"xml",attributeName:"transform",type:"rotate",from:"0 25 25",to:"360 25 25",dur:"0.6s",repeatCount:"indefinite"})})})})})})},Lo=function(){var e=Object(yo.f)(),t=function(){var e=O.a.useState("PENDING"),t=Object(be.a)(e,2),a=t[0],n=t[1],c=T(),r=c.account,o=c.updateAccount,i=c.resetAccount,s=(c.status,c.statusUnset,Ee()),u=s.status,l=s.statusUnset,b=Q(),p=b.status,v=b.statusUnset,j=Fa(),h=j.updateSystem,k=j.status,x=j.statusUnset,g=ae(),w=g.status,A=g.statusUnset,y=Ba(),S=y.status,I=y.statusUnset;return _c(Object(f.a)(m.a.mark((function e(){var t,a,n,c,s,u;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(""===r.accAddress||!r.connectName||"unknown"===r.connectName){e.next=28;break}return e.prev=1,e.next=4,Sa.a[r.connectName](r.accAddress);case 4:if(o({}),!Sa.a.usedProvide||!Sa.a.usedWeb3){e.next=19;break}if(null===(t=Number(null===(a=Sa.a.usedProvide)||void 0===a||null===(n=a.connector)||void 0===n?void 0:n.chainId))||void 0===t){e.next=10;break}e.t0=t,e.next=15;break;case 10:return e.t1=Number,e.next=13,Sa.a.usedWeb3.eth.getChainId();case 13:e.t2=e.sent,e.t0=(0,e.t1)(e.t2);case 15:return c=e.t0,void 0===re.e[c]&&(c=r._chainId&&"unknown"!==r._chainId?r._chainId:re.e.MAINNET),h({chainId:c}),e.abrupt("return");case 19:e.next=26;break;case 21:e.prev=21,e.t3=e.catch(1),Sa.c.sendDisconnect("","error at init loading  ".concat(e.t3,", disconnect")),s=r._chainId&&"unknown"!==r._chainId?r._chainId:re.e.MAINNET,h({chainId:s});case 26:e.next=31;break;case 28:""!==r.accAddress&&"unknown"!==r.connectName||i(),u=r._chainId&&"unknown"!==r._chainId?r._chainId:re.e.MAINNET,h({chainId:u});case 31:case"end":return e.stop()}}),e,null,[[1,21]])}))),[]),O.a.useEffect((function(){switch(k){case"PENDING":a!==d.L.PENDING&&n(d.L.PENDING);break;case"ERROR":x(),n("ERROR");break;case"DONE":x()}}),[k]),O.a.useEffect((function(){switch(u){case"ERROR":l(),n("ERROR");break;case"DONE":l()}switch(p){case"ERROR":v(),n("ERROR");break;case"DONE":v()}u===d.L.UNSET&&p===d.L.UNSET&&n("DONE")}),[u,p]),O.a.useEffect((function(){switch(w){case"ERROR":case"DONE":A()}}),[w]),O.a.useEffect((function(){switch(S){case"ERROR":console.log("ERROR","get ticker error,ui"),I();break;case"PENDING":break;case"DONE":I()}}),[S]),Co({state:a}),{state:a}}().state;return Object(dc.jsxs)(dc.Fragment,{children:[Object(dc.jsx)(Ao.a,{styles:Object(So.b)(Eo||(Eo=Object(i.a)([" \n      ",";\n      body{\n          ","\n      }\n      body:before {\n        ","\n      }\n      //#root{\n      //  display: flex;\n      //  flex-direction: column;\n      //}\n}"])),Object(d.ib)({theme:e}),"dark"===e.mode?"\n            color: ".concat(e.colorBase.textPrimary,";\n          "):"","dark"===e.mode?"\n            background: var(--color-global-bg);\n       ":"")}),Object(dc.jsx)(cr,{children:"PENDING"===t?Object(dc.jsx)(Ro,{}):"ERROR"===t?Object(dc.jsx)(Do,Object(o.a)({},d.u.NO_NETWORK_ERROR)):Object(dc.jsx)(dc.Fragment,{children:Object(dc.jsx)(wo,{})})})]})},Uo=a(1746),Bo=a(187),Fo=a(1697),Ko=a(1698),Wo=a(876),Ho=[Object(d.ob)(Bo.b,{dateAdapter:Fo.a}),Object(d.ob)(Ko.a,{i18n:d.nb}),Object(d.ob)(Uo.a,{theme:Object(d.gb)("dark")}),Object(d.ob)(yo.c,{theme:Object(d.gb)("dark")}),Object(d.ob)(n.a,{store:Cn}),Object(d.ob)(Wo.a,{persistor:Nn,loading:null})];r.a.render(Object(dc.jsx)(d.I,{providers:Ho,children:Object(dc.jsx)(Lo,{})}),document.getElementById("root"))}},[[1582,8,4,2,3,1,6,7,5]]]);
//# sourceMappingURL=main~06837ae4.e29d3a4c.chunk.js.map